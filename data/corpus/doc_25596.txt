В parted 2.2 и util-linux-ng 2.17.1 улучшена поддержка дисков с размером сектора 4 Кб

В релизе комплекта стандартных утилит util-linux-ng 2.17.1 проведена дополнительная работа по обеспечению совместимости с жесткими дисками с увеличенным до 4 Кб размером сектора. Для решения проблем, возникающих из-за некорректного выравнивания дисковых разделов по границе физических секторов, во входящей в комплект утилите fdisk добавлена опция "-c", которая отключает режим совместимости с DOS, при котором утилита оперирует только 512-байтовым логическими секторами. Режим совместимости объявлен устаревшим и в будущих версиях будет отключен по умолчанию в версии util-linux-ng 2.18. Также объявлено устаревшим использование номеров цилиндров при отображении и расчете параметров дисков, рекомендуется использовать опцию "-u" или команду "u" для использования секторов в качестве основных расчетных единиц. Дополнительно, отныне в fdisk дисковые разделы создаются по смещению в 1 Мб, за исключением дисков небольшого размера. Также внесено несколько дополнительных проверок, нацеленных на исключение возникновения некорректного смещения при создании дисковых разделов. Переход на мегабайтное смещение первого раздела и ряд связанных с поддержкой нового типа дисков улучшений отмечено также в вышедшем вчера релизе редактора дисковых разделов GNU parted 2.2. Напомню, что проблема связана с тем, что ранее по умолчанию первый дисковый раздел создавался по смещению в 63 512-байтных сектора, т.е. начало раздела попадало в середину физического сектора, имеющего размер 4 Кб. При работе с таким разделом, при чтении 4 килобайтового блока данных, с диска читался не один физический сектор, а два, что приводило к падению производительности в разы.