Уязвимость в WPS, протоколе упрощенной авторизации WiFi

В протоколе WPS (Wi-Fi Protected Setup), предназначенном для упрощения настройки WiFi-соединений, обнаружена серьезная уязвимость, позволяющая сократить требуемое число попыток подбора пин-кода точки доступа с 100 миллионов попыток до как максимум 11 тысяч попыток, что делает эту атаку практически осуществимой за разумное время. С использованием предложенного метода для подбора пин-кода требуется около 4-10 часов, после чего атакующий получает возможность запроса пароля для подключения к беспроводной сети, изменения конфигурации точки доступа или совершения блокирования работы сервиса. Из подверженных атаке устройств, отмечены: D-Link Systems Linksys Netgear ZyXEL Belkin Buffalo Technicolor TP-Link О каком либо практически реализуемом методе исправления уязвимости протокола WPS ничего не известно. Единственным решением является отключение авторизации по WPS в настройках оборудования и переход к другим способам авторизации, например WPA-PSK. Команда CERT также рекомендует следующие настройки для повышения безопасности беспроводных компьютерных сетей: Использовать шифрование WPA2 с несловарным паролем; Отключить UPnP; Включить фильтрацию по MAC адресу. В настоящее время уже открыт код инструментария Reaver, предназначенного для реализации предложенного метода атаки на практике. Для подбора пин-кода достаточно запустить утилиту reaver, указав беспроводной интерфейс в режиме мониторинга и BSSID целевой точки доступа (например, "reaver -i mon0 -b 00:01:02:03:04:05"). Уязвимость позволяет успешно выделить PSK (Pre-Shared Key) ключ, используемый в защищённых сетях на базе протоколов WPA и WPA2. При правильном выборе PSK-ключа, WPA2 обеспечивает достаточный уровень защиты. В случае упрощённой схемы настройки параметров авторизации, применяемой при активации WPS, пользователю для соединения предлагается ввести 8-символьный PIN без дополнительной парольной фразы. Если PIN корректный, то точка доступа передаёт пользователю PSK-ключ для WPA/WPA2, которого достаточно для подключения к сети (в WPS применяется так называемый метод внешнего регистратора). Таким образом, вычислив верный PIN не представляет сложности определить PSK-ключ. Как оказалось, в спецификации WPS есть слабое место, которое даёт возможность существенно упростить подбор PIN, так как атакующий может попытаться целиком предсказать первую половину цифр, используемых в PIN - в зависимости от того, верна или нет первая половина предложенного PIN, точка доступа возвращает в ответ разные сообщения EAP-NACK. В спецификации WPS также определено, что последняя цифра PIN представляет собой контрольную сумму, т.е. последнее значение можно считать изначально известным, поэтому после определения первых 4 цифр PIN остаётся определить методом перебора значение всего 3-х недостающих цифр, что в сумме для проведения всей атаки требует совершения около 11 тысяч операций перебора (10^4 на первые 4 цифры плюс 10^3 на оставшиеся три).