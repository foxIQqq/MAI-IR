Воссоздание криптографических ключей на основе анализа видео с LED-индикатором питания

Группа исследователей из университета имени Давида Бен-Гуриона (Израиль) разработала новый метод атак по сторонним каналам, позволяющий удалённо восстановить значения ключей шифрования на базе алгоритмов ECDSA и SIKE через анализ видео с камеры, снимающей светодиодный индикатор ридера смарт-карт или устройства, подключённого к одному USB-хабу со смартфоном, производящим операции с ключом. Метод основан на том, что в процессе вычислений в зависимости от выполняемых на CPU операций меняется потребление энергии, что приводит к небольшим флуктуациям в яркости свечения светодиодных индикаторов питания. Изменение свечения, которое напрямую коррелирует с производимыми вычислениями, можно уловить на современные цифровые камеры видеонаблюдения или камеры смартфонов, а анализ данных с камеры позволяет косвенно восстановить информацию, используемую при вычислениях. Для обхода ограничения точности выборки, связанного с записью лишь 60 или 120 кадров в секунду, используется эффект временного параллакса (rolling shutter), суть которого сводится к отображению в одном кадре разных участков быстро меняющегося изображения в разные моменты времени. Учёт данной особенности позволяет анализировать до 60 тысяч измерений свечения в секунду при съёмке на камеру iPhone 13 Pro Max c исходной частотой в 120 FPS, если изображение светодиодного индикатора занимает весь кадр (для приближения перед объективом выставлялась линза). При анализе рассматривалось изменение отдельных компонентов цвета (RGB) индикатора в зависимости от изменения энергопотребления процессором. Для восстановления ключей использовались известные методы атак Hertzbleed на механизм инкапсуляции ключей SIKE и Minerva на алгоритм создания цифровой подписи ECDSA, адаптированные для применения с иным источником утечки по сторонним каналам. Атака эффективна только при использовании уязвимых реализаций ECDSA и SIKE в библиотеках Libgcrypt и PQCrypto-SIDH. Например, подверженные атаке уязвимые библиотеки используются в смартфоне Samsung Galaxy S8 и шести купленных на Amazon смарткартах от пяти разных производителей. Исследователями проведено два успешных эксперимента. В первом удалось восстановить 256-разрядный ключ ECDSA из смарткарты через анализ видео LED-индикатора ридера смарткарт, снимаемого на подключённую к глобальной сети камеру видеонаблюдения, размещённую в 16 метрах от устройства. Атака заняла около часа и потребовала создания 10 тысяч цифровых подписей. Во втором эксперименте удалось восстановить 378-разрядный ключ SIKE, используемый на смартфоне Samsung Galaxy S8, на основе анализа видеозаписи индикатора питания USB-колонок Logitech Z120, подключённых к одному USB-хабу, через который заряжался смартфон. Видео было снято на камеру смартфона iPhone 13 Pro Max. Во время анализа на смартфоне выполнялась атака на основе подобранного шифротекста (постепенный подбор на основе манипуляций с зашифрованным текстом и получения его расшифровки), в ходе которой было выполнено 121 тысяча операций c ключом SIKE. ​