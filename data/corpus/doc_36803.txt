Хостинг-оператор Anchor протестировал Btrfs на готовность к промышленной эксплуатации

Хостинг-оператор Anchor опубликовал отчёт о тестовом внедрении файловой системы Btrfs на нескольких серверах, обеспечивающих работу системы резервного копирования. В итоге сделан вывод о том, что несмотря на обилие интересных возможностей и прогресс в развитии Btrfs, данная ФС ещё не готова для промышленного использования из-за наличия некоторых подводных камней и нерешённых проблем. Тем не менее для ознакомительного использования не на критически важных системах, таких как рабочие станции или персональные серверы, Btrfs уже можно использовать. Компания Anchor вернула на Ext4 системы, на которых был произведён переход на Btrfs, но указала на то, что будет отслеживать состояние разработки ZFS и Btrfs для перехода на одну из данных ФС в будущем. В процессе эксперимента отсутствовали инциденты с потерей данных, успешно создавались тысячи снапшотов, средствами Btrfs было выявлено повреждение одного бита информации в RAID-массиве. Из проблем отмечалось блокирование ввода/вывода в пики создания разом большого числа резервных копий данных разных клиентов. Проблема, которая, по мению инженеров Anchor, скорее всего вызвана ошибкой в коде реализации системы квот qgroups, приводит к мягким зависаниям CPU, что требует перезагрузки системы для продолжения работы. Перезагрузка приводит к необходимости перестроения некоторых служебных структур из-за повреждения кэша свободных блоков. Перестроение достаточно длительный процесс, для 16TB раздела длящийся более часа. Ещё одна серьёзная проблема связана с непредсказуемостью переполнения Btrfs-раздела и связанным с исчерпанием свободного места замедлением работы. Неаккуратный запуск rsync настолько замедил работу с ФС, что с ней невозможно было работать.