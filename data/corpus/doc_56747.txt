Разработчики ядра Linux обсуждают возможность удаления ReiserFS

Мэтью Уилкокс (Matthew Wilcox) из компании Oracle, известный созданием драйвера nvme (NVM Express) и механизма прямого доступа к ФС DAX, предложил удалить файловую систему ReiserFS из состава ядра Linux по аналогии с когда-то удалёнными устаревшими ФС ext и xiafs или сократить код ReiserFS, оставив только поддержку работы в режиме только для чтения. Мотивом для удаления стали дополнительные трудности с модернизацией инфраструктуры ядра, вызванные тем, что специально для ReiserFS разработчики вынуждены оставить в ядре устаревший обработчик флага AOP_FLAG_CONT_EXPAND, так как ReiserFS остаётся единственной ФС, использующей данный флаг в функции write_begin. При этом последнее исправление в коде ReiserFS датировано 2019 годом и непонятно, насколько вообще данная ФС востребована и продолжают ли ей пользоваться. Ян Кара (Jan Kára) из компании SUSE согласился, что ReiserFS находится на пути к устареванию, но непонятно, достаточно ли она устарела для удаления из ядра. По данным Яна, ReiserFS продолжает поставляться в openSUSE и SLES, но пользовательская база данной ФС незначительна и постоянно сокращается. Для корпоративных пользователей поддержка ReiserFS в SUSE была прекращена 3-4 года назад, и модуль с ReiserFS не входит по умолчанию в пакет с ядром. Как вариант Ян предложил начать выводить предупреждение об устаревании при монтировании разделов ReiserFS и считать данную ФС готовой к удалению, если в течение года или двух никто не даст знать о желании продолжить использование данной ФС. К дискуссии подключился Эдуард Шишкин, сопровождающий файловую систему ReiserFS, и предоставил патч, убирающий использование флага AOP_FLAG_CONT_EXPAND из кода ReiserFS. Мэтью Уилкокс принял патч в свою ветку. Таким образом, повод для удаления устранён и вопрос исключения ReiserFS из ядра можно считать отложенным на достаточно длительное время. Полностью отбросить вопрос устаревания ReiserFS не получится из-за работы по исключению из ядра файловых систем с нерешённой проблемой 2038 года. Например, по данной причине уже подготовлен график удаления из ядра четвёртой версии формата файловой системы XFS (новый формат XFS был предложен в ядре 5.10 и сдвинул переполнение счётчика времени до 2468 года). Сборка XFS v4 будет отключена по умолчанию в 2025 году, а код удалён в 2030 году). Подобный график предлагается выработать и для ReiserFS, предоставив как минимум пять лет на миграцию на другие ФС или изменённый формат метаданных.