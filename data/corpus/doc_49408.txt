Новые уязвимости в маршрутизаторах MikroTik и TP-Link

В операционной системе RouterOS, применяемой в маршрутизаторах MikroTik, выявлено несколько уязвимостей. Самая опасная из проблем потенциально позволяет получить полный доступ к системе, при наличии аутентифицированного доступа. Проблемы устранены в обновлениях прошивки RouterOS 6.40.9, 6.42.7 и 6.43. Выявленные уязвимости: CVE-2018-1156 - возможность выполнения произвольного кода на устройстве при наличии аутентифицированного доступа. Воспользовавшись заданными по умолчанию и не изменёнными пользователем параметрами входа атакующий может получить root-доступ в окружении операционной системы и организовать выполнение таких операций, как проброс трафика. Уязвимость также может использоваться в сочетании с проблемой в компоненте Winbox (CVE-2018-14847), выявленной в апреле и устранённой в августовском обновлении. CVE-2018-14847 позволяет узнать параметры аутентификации, после чего при помощи CVE-2018-1156 можно выполнить на устройстве код с правами root. Данная техника уже применяется во вредоносном ПО VPNFilter; CVE-2018-1157 - DoS-атака через исчерпание всей доступной памяти при загрузке файла; CVE-2018-1159 - выход за допустимые границы буфера в реализации http-сервера; CVE-2018-1158 - переполнение стека при рекурсивном разборе запросов; Также сообщается о выявлении двух уязвимостей в маршрутизаторах TP-Link TL-WR841N (v13) и TL-WR840N (v5), которые позволяют неаутентифицированному атакующему получить полный контроль за устройством. CVE-2018-11714 - возможность обращения к CGI-скриптам без прохождения аутентификации при установке в заголовке HTTP Referrer значения, свидетельствующего о переходе с хостов "tplinkwifi.net", "tplinklogin.net" или с IP-адреса текущего маршрутизатора; CVE-2018-15702 - CSRF-уязвимость в функции проверки внутренних переходов по значению заголовка HTTP Referrer. Из-за ограничения размера проверяемого строкового значения, атакующий может обойти защиту от атак CSRF, разместив iframe на своём хосте с поддоменом "tplinkwifi.net" или "tplinklogin.net" (например, tplinkwifi.net.attacker.com). В сочетании с первой уязвимостью, данную проблему можно использовать для организации атаки на пользователей TP-Link TL-WR841N для получения удалённого доступа в управляющий интерфейс.