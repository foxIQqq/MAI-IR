Критические уязвимости в системе управления контентом Joomla

Разработчики свободной системы управления web-контентом Joomla опубликовали экстренное обновление 3.6.4, в котором устранены две уязвимости, которым присвоен наивысший уровень опасности. Первая уязвимость (CVE-2016-8870) позволяет зарегистрировать на сайте новую учётную запись, даже если регистрация новых пользователей запрещена в настройках. Вторая уязвимость (CVE-2016-8869) позволяет любому внешнему посетителю создать нового пользователя и добавить его в любую группу доступа, в том числе передать ему права администратора. Проблемы проявляются в Joomla, начиная с выпуска 3.4.4, и вызваны оставлением в коде доступного для внешних обращений и не требующего аутентификации обработчика для регистрации новых пользователей. В частности в классе UsersModelRegistration был оставлен метод register, который дублирует аналогичный метод в классе UsersControllerRegistration, но в отличие от него не проверяет разрешение регистрации в настройках и использует собственный метод validate, содержащий недоработку, позволяющую передать произвольные дополнительные параметры без проверки и переопределить присваиваемый по умолчанию список групп и идентификатор пользователя.