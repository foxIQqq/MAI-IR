Критическая уязвимость в IMAP-сервере Dovecot

В корректирующих выпусках POP3/IMAP4-сервера Dovecot 2.3.7.2 и 2.2.36.4, а также в дополнении Pigeonhole 0.5.7.2 и 0.4.24.2 , устранена критическая уязвимость (CVE-2019-11500), которая позволяет добиться записи данных за пределы выделенного буфера через отправку специально оформленного запроса по протоколам IMAP или ManageSieve. Проблема может быть эксплуатирована на стадии до прохождения аутентификации. Рабочий эксплоит пока не подготовлен, но разработчики Dovecot не исключают возможность использования уязвимости для организации атак по удалённому выполнению кода в системе или организации утечки конфиденциальных данных. Всем пользователям рекомендуется срочно установить обновления (Debian, Fedora, Arch Linux, Ubuntu, SUSE, RHEL, FreeBSD). Уязвимость присутствует в парсерах протоколов IMAP и ManageSieve и вызвана некорректной обработкой символов с нулевым кодом в процессе разбора данных внутри заключённых в кавычки строк. Проблема позволяет добиться записи произвольных данных в объекты, хранимые за границей выделенного буфера (на этапе до аутентификации можно перезаписать до 8 Кб, а после аутентификации до 64 Кб). По мнению инженеров из компании Red Hat использование проблемы для реальных атак затруднено тем, что атакующий не может контролировать позицию произвольной перезаписи данных в куче. В ответ высказывается мнение, что данная особенность лишь существенно усложняет атаку, но не исключает её проведение - атакующий может многократно повторять попытку эксплуатации до тех пор пока не попадёт в рабочую область в куче.