Facebook предложил новый метод восстановления забытых паролей

Инженеры из компании Facebook разработали новый протокол DelegatedRecovery, предназначенный для восстановления забытых паролей. Протокол предоставляет сайтам возможность делегирования функций восстановления учётной записи через рабочую учётную запись, контролируемую тем же пользователем, но размещённую в другом сервисе. В качестве эксперимента в ограниченном виде данный протокол опробован в GitHub для организации восстановления доступа при наличии рабочей учётной записи в Facebook, и может пригодиться в случае утери телефона или носимого токена, применяемых в двухфакторной аутентификации на GitHub. Протокол нацелен на устранение дополнительных угроз, возникающих при использовании традиционных схем восстановления паролей, манипулирующих известными для конкретного пользователя фактами из разряда "девичья фамилия матери" или использующими отправку кода восстановления через email/SMS (например, при захвате злоумышленником контроля над email или смартфоном, они могут быть использованы для получения контроля над учётными записями во всех привязанных к ним сервисах). DelegatedRecovery позволяет обойтись без привязки к email или номеру телефона, применяя в качестве фактора для восстановления контроля над учётными данными наличие доступа к другому доверительному сервису. Например, для восстановления входа в GitHub может использоваться учетная запись в Facebook. Суть метода в предварительной генерации и сохранении на стороне другой системы специального токена, содержащего криптослепок параметров аутентификации (в рассмотренном примере GitHub по запросу пользователя может создать слепок учётных данных, после чего этот слепок необходимо сохранить в аккаунте этого же пользователя в Facebook). Все данные в токене зашифрованы и сторонний сервис (в примере Facebook) не может получить доступ к информации. На стороне сгенерировавшей токен системы (в примере GitHub) в привязке к пользователю сохраняется идентификатор токена и его состояние. В случае если пользователь потеряет контроль над учётной записью в GitHub он может воспользоваться ранее сгенерированным токеном для подтверждения своих прав на учётную запись. При необходимости восстановления утерянного доступа, пользователь может войти в Facebook и отправить в GitHub проверочный токен, который имеет фиксированное небольшое время жизни и ограничен по числу возможных попыток восстановления. Кроме содержимого ранее сохранённого токента, ключ восстановления также снабжается цифровой подписью сервиса, подтверждающей, что данные отправлены тем же пользователем, который когда-то сохранил токен. Интенсивность применения операции восстановления ограничена - если в случае с получением контроля над email или смартфоном атакующий может сразу атаковать все другие учётные записи пользователя, то получив контроль за аккаунтом в Facebook, он сможет формировать запросы на восстановление, например, не чаще одного раза в день. В настоящее время для изучения и обсуждения доступен черновой вариант спецификации протокола, который поставляется под лицензией Creative Commons Attribution 4.0. В ближайшее время планируется опубликовать код эталонной реализации протокола для различных языков программирования, которая позволит внедрить новый метод восстановления доступа на собственном сайте.