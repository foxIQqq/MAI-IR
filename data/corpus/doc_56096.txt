Выпуск nginx 1.21.4

Сформирован выпуск основной ветки nginx 1.21.4, в рамках которой продолжается развитие новых возможностей (в параллельно поддерживаемой стабильной ветке 1.20 вносятся только изменения, связанные с устранением серьёзных ошибок и уязвимостей). Основные изменения: Прекращена поддержка установки HTTP/2-соединений с использованием расширения NPN (Next Protocol Negotiation) вместо ALPN; Обеспечено закрытие SSL-соединений при использовании клиентом расширения ALPN, если в процессе согласования соединений не выбран поддерживаемый протокол; В директиве "sendfile_max_chunk" значение по умолчанию изменено на 2 мегабайта; В модуле stream добавлена директива proxy_half_close, при помощи которой можно настроить поведение при закрытии проксируемого соединения TCP на одной из сторон ("TCP half-close"); В модуле stream добавлена директива ssl_alpn для определения списка поддерживаемых протоколов ALPN (h2, http/1.1) и переменная $ssl_alpn_protocol, отражающая согласованный с клиентом протокол ALPN; Добавлена поддержка вызова SSL_sendfile() при использовании OpenSSL 3.0; Добавлена новая директива mp4_start_key_frame в модуле ngx_http_mp4_module для вещания видеопотока, начиная с ключевого кадра. Исправлена установка переменной $content_length при использовании chunked transfer encoding; Исправлена ошибка кэширования соединения при получении ответа некорректной длины от проксируемого бэкенда; Исправлено логирование с уровнем "error" вместо "info" при некорректных заголовках от бэкендов; Исправлены ошибки зависания запросов при использовании HTTP/2 и директивы aio_write.