Компания Cisco выпустила свободный антивирусный пакет ClamAV 0.101

Компания Cisco представила новый значительный выпуск свободного антивирусного пакета ClamAV 0.101.0. Напомним, что проект перешёл в руки Cisco в 2013 году после покупки компании Sourcefire, развивающей ClamAV и Snort. Код проекта распространяется под лицензией GPLv2. Ключевые улучшения: Добавлена поддержка извлечения данных из архивов, созданных в пятой версии утилиты RAR. Вместо ранее используемого распаковщика unrar задействована распространяемая компанией RarLabs библиотека UnRAR 5.6.5. Лицензия на связующую библиотеку libclamunrar_iface изменена с LGPL на BSD; Проведена реструктуризация опций и директив в утилите clamscan и файле конфигурации clamd.conf. Опции, связанные с выводом предупреждений на основе эвристического анализа теперь снабжены префиксами "Alert*" и "--alert-*". Настройка AlgorithmicDetection переименована в HeuristicAlerts. Поддержка старых опций пока сохранена, но может исчезнуть в одном из будущих выпусков; В clamd.conf и интерфейсе командной строки временно отключена опция OnAccessExtraScanning из-за наличия пока не решённых проблем со стабильностью и утечкой ресурсов; Добавлены новые опции AlertEncryptedArchive и AlertEncryptedDoc для вывода предупреждении о выявлении зашифрованных архивов или документов; В логических сигнатурах реализована поддержка операций сравнения последовательностей байт, позволяющих по аналогии с похожей возможностью в Snort извлечь и сравнить определённое число байт на основании указанного размера и смещения; Библиотека libmspack обновлена до версии 0.7.1alpha (ранее использовался выпуск 0.5alpha) и расширена средствами для парсинга повреждённых или нестандартных CAB-файлов; Улучшена поддержка разбора файлов PDF и Aspack PE; В сборках для Windows предложен новый установщик, построенный с использованием InnoSetup 5; В сигнатуры Authenticode добавлена поддержка свойств, специфичных для системных файлов Windows, и обеспечено их использование при разборе исполняемых файлов в формате PE; Реализован корректный разбор сигнатур на системах с порядком следования байт "big endian"; Упрощён код для управления зеркалами в утилите freshclam, уменьшено время игнорирования зеркал после ошибок, учтены задержки в появлении новых сигнатур при загрузке через сети доставки контента; В код разбора MIME блоков в письмах добавлена обработка несбалансированных кавычек и улучшено выявление вложений в некорректно оформленных письмах; В libfreshclam удалена ранее объявленная устаревшей опция AllowSupplementaryGroups, которая уже исключена из freshclam; Внесены изменения в API библиотеки libclamav: В функции cl_scandesc, cl_scandesc_callback и cl_scanmap_callback добавлен аргумент для передачи имени файла (используется для вывода более информативных ошибок и предупреждений, а также для более осмысленного создания временных файлов); Опции сканирования из набора битовых полей выделены в структуру с отдельными флагами, что позволит упростить добавление новых опций при возникновении необходимости; Объявлена устаревшей функция cl_cleanup_crypto(), которая потеряла смысл после повышения требований к версии OpenSSL (выше 1.0.1), так как процедура очистки вызывается автоматически; Опция CL_SCAN_HEURISTIC_ENCRYPTED разделена на две отдельных опции CL_SCAN_HEURISTIC_ENCRYPTED_ARCHIVE и CL_SCAN_HEURISTIC_ENCRYPTED_DOC; Руководство пользователя сконвертировано из Latex в Markdown и теперь ведётся в данном формате.