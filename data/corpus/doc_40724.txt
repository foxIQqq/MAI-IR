Критическая уязвимость в гипервизоре Xen

В гипервизоре Xen обнаружена опасная уязвимость (CVE-2014-7188), позволяющая инициировать крах хост-окружения или прочитать данные на уровне гипервизора или других гостевых систем. Эксплуатация возможна при выполнении специально оформленных гостевых систем, работающих в режиме полной виртуализации (HVM). Например, данный режим поддерживается во многих облачных службах, включая Amazon Elastic Compute Cloud, RackSpace и многих других решениях виртуализации на базе Xen. Уязвимость может быть использована для компрометации серверной инфраструктуры данных служб. Проблеме не подвержены конфигурации, в которых гостевые системы выполняются только в режиме паравиртулизации (PV). Исправление пока доступно в виде патча. Проблема проявляется в Xen 4.1 и более новых выпусках на системах с процессорами x86. Уязвимость выявлена сотрудником компании SUSE. Уязвимость вызвана ошибкой в коде эмуляции контроллера прерываний x2APIC, которая позволяла обратиться к MSR за пределами дозволенного диапазона. Если операции записи вне лимита блокировались, то чтение могло привести к обращению к страницам памяти за пределами эмулятора. Последовательно перебирая таким способом память, атакующий может добраться до памяти других виртуальных окружений или основной системы. Дополнение 1: Amazon и RackSpace устранили уязвимость в своих инфраструктурах ещё до публичного обнародования сведений об уязвимости, они были заранее уведомлены разработчиками Xen. Устранение проблемы потребовало перезагрузки некоторых серверов. Сообщество Xen раскрыло данные об уязвимости в два этапа: вначале были отправлены уведомления избранным организациям, входящим в список закрытой рассылки Xen Security Team, а через несколько дней информация была раскрыта публично. Дополнение 2: Утверждается, что уязвимость позволяет прочитать не более чем 3 КБ из случайной области памяти.