Релиз Firefox 58

Состоялся релиз web-браузера Firefox 58, а также мобильной версии Firefox 58 для платформы Android. В ближайшие часы ожидается обновление ветки с длительным сроком поддержки 52.6.0. В ближайшее время на стадию бета-тестирования перейдёт ветка Firefox 59, релиз которой намечен на 13 марта. Основные новшества: Добавлен новый двухуровневый компилятор, который обеспечивает компиляцию промежуточного кода WebAssembly в 10-15 раз быстрее за счёт компиляции по мере загрузки и распараллеливания работы на уровне компиляции отдельных функций; Для ускорения обработки JavaScript обеспечено кэширование байткода, полученного после разбора кода, что ускоряет загрузку Facebook на 12%, Twitter на 5.4%, сайтов Google на 4.9%. Кэширование машинных инструкций после JIT-компиляции байткода ожидается в одном из следующих выпусков; В настройки добавлен вывод предупреждений в случае наличия установленных дополнений, которые вносят изменения в работу страницы с новой вкладкой, домашней страницы или поисковых движков. Таким образом пользователь теперь сразу информируется об изменении поведения данных разделов из-за установки дополнений и рядом выводится кнопка для быстрого отключения дополнения; Реализован новый метод урезания активности фоновых вкладок, не просматриваемых в текущий момент. Каждой фоновой вкладке теперь выделяется определённый бюджет времени в миллисекундах, который расходуется на запуск таймеров (setTimeout/setInterval). При каждом запуске таймера из бюджета вычитается процессорное время, потраченное на выполнение обработчика. При этом бюджет также непрерывно пополняется на 1 миллисекунду. Как только бюджет примет отрицательное значение, вызов обработчиков по таймеру прекращается. Система ограничений активируется спустя 30 секунд после нахождения вкладки в фоне. Ограничения не применяются ко вкладкам, в которых воспроизводится звук, установлены соединения WebSockets и WebRTC, или выполняется обработка данных в IndexedDB. По предварительной оценке реализованный метод на 25% снижает нагрузку от фоновых вкладок, интенсивно нагружающих процессор; Представлен метод противодействия скрытому отслеживанию пользователей при помощи API Canvas, который сводится к выводу диалога с запросом подтверждения операции при использовании на сайте кода для обработки изображений, получающего содержимое областей при помощи API getImageData; Добавлена поддержка автозаполнения полей с параметрами кредитных карт. Для отключения данной возможности в настройках в секции управления приватностью (about:preferences#privacy) представлена специальная опция. Дополнение: функция не вошла в финальный релиз и перенесена в следующий выпуск. Нарушена обратная совместимость на уровне конфигурационных профилей. Профили, созданные в Firefox 58+, не смогут быть использованы в прошлых выпусках (например, при установке Firefox 58 без восстановлении старого профиля из резервной копии невозможно будет откатиться на Firefox 52 ESR); Изменена логика выбора сайта при наборе имени в адресной строке без уточнения протокола. Например, если набрать "opennet.ru", то откроется "https://www.opennet.ru", а не легковесная версия "http://opennet.ru" (для открытия без www теперь нужно явно указывать полный адрес с https:// или http://); Обеспечен вывод предупреждения при открытии сайтов, на которых используются сертификаты удостоверяющего центра Symantec, доверие к которому скоро будет прекращено (в Firefox 60 будет прекращена работа с сертификатами, выданными до 2016-06-01, а в Firefox 63 со всеми остальными); Расширены возможности WebExtensions: добавлены дополнительные опции для создателей тем оформления, представлен API для управления режимом читателя (Reader Mode), добавлен API для смены поисковой системы по умолчанию (при обращении к данному API выводится диалог для подтверждения у пользователя смены поисковика), добавлен API для взаимодействия с устройствами PKCS #11; В интегрированном дополнении для создания скриншотов добавлена поддержка копирования и вставки изображений через буфер обмена. Скриншоты теперь можно создавать и при открытии страницы в режиме приватного просмотра (Private Browsing); Реализован API PerformanceNavigationTiming, предоставляющий методы и свойста для сохранения и извлечения метрик о событиях навигации по документу. Например, при помощи нового API можно определить какое время тратится на загрузку документа; Добавлено свойство PerformanceResourceTiming.workerStart, позволяющее измерить время запуска service worker; На всех поддерживаемых платформах добавлено CSS-свойство font-display, которое даёт возможность определить как и когда отображать текстовое содержимое, если шрифт ещё не загрузился. Например, до окончания загрузки шрифта текст можно отобразить используя шрифт по умолчанию (ранее при использовании внешних шрифтов отрисовка текста не производилась до окончания загрузки шрифта); Добавлен метод Intl.Numberformat.prototype.formatToParts(), позволяющий использовать форматирования с использованием правил текущей локали для строк, выдаваемых функциями форматирования NumberTimeFormat; Добавлен метод Promise.prototype.finally(); В сборках для macOS активирована поддержка API WebVR, который ранее был доступен только пользователям Windows. WebVR предоставляет возможности для создания приложений виртуальной реальности и навигации в Web через 3D-шлемы, такие как HTC VIVE и Oculus Rift; В сборке для Windows операция отрисовки страницы вынесена в отдельный процесс, не блокирующий работу основного потока. В протестированных online-играх по сравнению с Firefox 57 наблюдается увеличение скорости отрисовки до 30% (с 31 до 40 кадров в секунду). Для ещё большего ускорения отрисовки в будущих выпусках ожидается интеграция наработок проекта Quantum Render, основанном на системе композитинга Servo WebRender и привлекающем GPU для обработки графики; В Linux решена проблема с выводом пустых символов вместо текста, если связанный с текстом шрифт установлен в нестандартном каталоге; Добавлена возможность установки таймаута для этапа согласования TLS-соединения. По умолчанию таймаут установлен в 30 секунд, но может быть изменён через опцию network.http.tls-handshake-timeout в about:config; Добавлена новая CSP (Content Security Policy) директива worker-src, позволяющая ограничить URL только загрузкой Worker, SharedWorker или ServiceWorker; Удалена большая порция свойств со специфичным для Mozilla префиксом "-moz-", которые уже давно стандартизированы и доступны без префикса. Также удалены устаревшие или нестандартные JavaScript-методы Function.prototype.isGenerator() Date.prototype.toLocaleFormat() и Object.prototype.watch(); В инструменты для разработчиков добавлен редактор контуров (Shape Path Editor), позволяющие наглядно просматривать и редактировать элементы, сгенерированные при помощи CSS-свойства clip-path. В панели CSS в блоках clip-path теперь показывается специальный значок, кликнув на который включается наглядное выделение контура текущего элемента; В интерфейс мониторинга сетевой активности добавлена кнопка для записи сетевого трафика, а также убран отдельный фильтр для запросов Flash-контента (Flash теперь попадает в фильтр "другое"); Удалён код старого интерфейса Responsive Design Mode, для просмотра страницы в разных экранных разрешениях следует использовать новую реализацию; Улучшения версии Firefox 58 для Android: Добавлена поддержка приложений, работающих в режиме Progressive Web Apps (PWA), позволяющем организовать работу с web-приложением, как с обычной программой для Android (установка на домашний экран, отображение в списке запущенных программ, выполнение деинсталляции, средства для получения запросов от других приложений, свой блок настроек в системном конфиругаторе, управление уведомлениями, работа при отсутствии сетевого соединения и т.п.); В настройки добавлена опция, позволяющая выполнять операции синхронизации только при наличии стационарного сетевого соединения (WiFi); Добавлена поддержка полноэкранного интерфейса управления закладками с поддержкой разбивки закладок на подразделы; Добавлена поддержка аудиокодека FLAC (Free Lossless Audio Codec); В темах оформления появилась возможность смены цвета строки статуса и цвета разделителей в панели инструментов; Из домашнего экрана удалён виджет Firefox Search; Реализация протокола Safe Browsing обновлена до версии 4; Кроме новшеств и исправления ошибок в Firefox 58 устранены 32 уязвимости, из которых 3 (CVE-2018-5089, CVE-2018-5090 и CVE-2018-5091) помечены как критические, т.е. могут привести к выполнению кода злоумышленника при открытии специально оформленных страниц.