Злоумышленники добавили вредоносный код в скрипт установки хостинг-панели VestaCP

В установочном скрипте панели управления хостингом VestaCP выявлен код, выполняющий отправку параметров аутентификации для доступа к системе пользователя. В частности, в штатную систему отправки телеметрии, которая в ответ на внешний запрос осуществляет вывод названия дистрибутива, добавлены дополнительные параметры, выдающие пароль администратора и IP текущего хоста. Сведения отправлялись на сервер сбора данных телеметрии, который в результате взлома оказался подконтролен атакующим. Для проверки были ли переданы на сервер сатистики конфиденциальные данные можно использовать ссылку "http://vestacp.com/test/?ip=x.x.x.x", где x.x.x.x IP проверяемого сервера. Если вредоносная активность наблюдается, то вероятно уже недостаточно просто сменить пароль администратора. После получения параметров доступа, атакующие устанавливали бэкдор, который мог выглядеть как системный файл /usr/bin/dhcprenew, реализующий командный сервер для участия в совершении DoS-атак и предоставляющий скрытый shell. После запуска указанный бэкдор маскируется под видом процесса "[kworker/1:1]". В ходе начального разбора инцидента выяснилось, что код удалось изменить в результате взлома некоторых серверов инфраструктуры проекта. Взлом произведён при помощи новой уязвимости, вызванной ошибкой в API, появившейся в апрельском выпуске 0.9.8-20. Проблемы устранены в выпуске 0.9.8-23. Дополнительные подробности пока не сообщаются.