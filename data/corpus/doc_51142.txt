Уязвимость, позволяющая дополнениям Chrome выполнять внешний код, несмотря на права доступа

Опубликован метод, позволяющий в любом дополнении к Chrome добиться выполнения внешнего JavaScript-кода без предоставления дополнению расширенных полномочий (без unsafe-eval и unsafe-inline в manifest.json). Права доступа предполагают, что без unsafe-eval дополнение имеет возможность выполнить только код, входящий в локальную поставку, но предложенный метод даёт возможность обойти данное ограничение и выполнить в контексте дополнения любой JavaScript, загруженный с внешнего сайта. В настоящее время компания Google закрыла публичный доступ к отчёту о проблеме, но в архиве сохранился пример кода для эксплуатации проблемы. Способ аналогичен методу обхода ограничения script-src 'self' в CSP и сводится к подстановке тега script через document.createElement('script') и включения в него внешнего содержимого через функцию fetch, после чего код будет выполнен в контексте самого дополнения.