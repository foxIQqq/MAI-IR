Уязвимость в Android-прошивках Samsung, эксплуатируемая через отправку MMS

В поставляемом в Android-прошивках Samsung обработчике изображений Qmage, встроенном в систему рендеринга графики Skia, выявлена уязвимость (CVE-2020-8899), позволяющая организовать выполнение кода при обработке в любом приложении изображений в форматах QM и QG (".qmg"). Для совершения атаки не требуется выполнение пользователем каких-либо действий, в простейшем случае достаточно отправить жертве MMS, email или сообщение в чате, содержащее специально оформленное изображение. Предполагается, что проблема проявляется с 2014 года, начиная с прошивок, основанных на Android 4.4.4, в которые были добавлены изменения для работы с дополнительными форматами изображений QM, QG, ASTC и PIO (вариант PNG). Уязвимость устранена в обновлениях прошивок Samsung, выпущенных 6 мая. Основная платформа Android и прошивки от других производителей проблеме не подвержены. Проблема была выявлена в ходе fuzzing-тестирования инженером из компании Google, который также доказал, что уязвимость не ограничивается крахом и подготовили рабочий прототип эксплоита, обходящего защиту ASLR и запускающего калькулятор через отправку серии MMS-сообщений на смартфон Samsung Galaxy Note 10+ под управлением платформы Android 10. В показанном примере успешная эксплуатация потребовала примерно 100 минут для атаки и отправки более 120 сообщений. Эксплоит состоит из двух частей - на первой стадии для обхода ASLR выполняется определение базового адреса в библиотеках libskia.so и libhwui.so, а на второй предоставляется удалённый доступ к устойству через запуск "reverse shell". В зависимости от раскладки памяти определение базового адреса требует отправки от 75 до 450 сообщений. Дополнительно можно отметить публикацию майского набора исправлений проблем с безопасностью для Android, в котором устранено 39 уязвимостей. Трём проблемам присвоен критический уровень опасности (детали пока не раскрываются): CVE-2020-0096 - локальная уязвимость, позволяющая выполнить код при обработке специально оформленного файла); CVE-2020-0103 - удалённая уязвимость в системе, позволяющая выполнить код при обработке специально оформленных внешних данных); CVE-2020-3641 - уязвимость в проприетарных компонентах Qualcomm). Дополнение: Опубликован детальный разбор уязвимости и техники создания эксплоита.