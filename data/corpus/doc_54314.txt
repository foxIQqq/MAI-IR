Компания Sony опубликовала Linux-драйвер для игрового контроллера PlayStation 5 DualSense

Компания Sony опубликовала набор патчей для ядра Linux с реализацией драйвера для игрового контроллера PlayStation 5 DualSense. Драйвер поддерживает подключение к контроллеру как по USB, так и через Bluetooth. Реализовано большинство доступных в DualSense функций, включая светодиодные индикаторы, тачпад, микрофон, контроль за зарядом аккумулятора, датчики движения (акселерометр, гироскоп) и обратную связь при помощи вибрации. Для работы с DualSense предложен новый драйвер hid-playstation, который в дальнейшем планируется использовать и для других периферийных устройств Sony PlayStation. Старый драйвер hid-sony будет использован для остальных устройств ввода, выпускаемых Sony, не связанных с игровыми контроллерами. Со временем имеющийся в hid-sony код для поддержки прошлых моделей игровых контроллеров Sony DualShock будет перенесён в драйвер hid-playstation. Новый драйвер представляет функциональность игрового контроллера DualSense в форме составного устройства (compositive device), охватывающего несколько фреймворков. Для поддержки геймпада, тачпада и датчиков движения используются три узла evdev, а для реализации обратной связи через вибрацию - фреймворк FF (Force feedback), предоставляемый системой ввода. Поддержка светодиодных индикаторов реализована через интерфейс leds-class, а для управления световой полосой рядом с тачпадом - leds-class-multicolor. Пока недоступны некоторые новые возможности, впервые появившиеся в DualSense, такие как адаптивные триггеры и генератор тактильных ощущений на основе VCM (voice coil motor). Реализация данных возможностей требует обработки большого объёма данных и применения достаточно сложных структур, а также расширения интерфейсов Evdev и FF.