Уязвимость во FreeType, эксплуатируемая через TTF-шрифт и затрагивающая браузеры

Вернер Лемберг (Werner Lemberg), ключевой разработчик библиотеки рендеринга шрифтов FreeType, предупредил пользователей о выявлении уязвимости (CVE-2020-15999), которая позволяет выполнить свой код при обработке специально оформленных TTF-файлов с PNG sbit глифами. Имеются сведения, что уязвимость уже активно эксплуатируется злоумышленниками (0-day). Проблема вызвана переполнением буфера в функции Load_SBit_Png, возникающим при обработке глифов с битовыми картами большого размера (указание в заголовке ширины или высоты больше 65535). Пример шрифта (940 байт), который вызывает переполнение буфера. Исправление пока доступно только в виде патча, который будет включён в корректирующий релиз FreeType 2.10.4, запланированный на завтра. Дистрибутивы обновления пакетов с FreeType пока не выпустили (Debian, RHEL, SUSE, Ubuntu). Дополнение 1: Рассматриваемая проблема несколько часов назад исправлена в кодовой базе Chromium, в которой используются функуции из FreeType. Firefox также использует FreeType, а последнее изменение файла, в котором присутствует уязвимость, было произведено в мае. Судя по всему, уязвимость может быть эксплуатирована в Chrome/Chromium и Firefox при обработке внешних шрифтов при открытии сайтов злоумышленников. Дополнение 2: Проблема также затрагивает платформу Android. Дополнение 3: Опубликовано обновление FreeType 2.10.4 с устранением уязвимости. Дополнение 4: Доступно обновление Chrome 86.0.4240.111, в котором устранена связанная с FreeType уязвимость. Лидер группы Project Zero из компании Google также подтвердил, что проблема относилась к категории 0-day и применялась в эксплоитах против Chrome до исправления уязвимости.