Локальная root-уязвимость в подсистеме inotify ядра Linux

Группа исследователей из Китайского университета Гонконга выявила уязвимость (CVE-2017-7533) в ядре Linux, которая может использоваться для повышения своих привилегий в системе. Проблема проявляется начиная с ядра v3.14-rc1 и актуальна вплоть до ядра 4.12. В сети уже распространяется эксплоит для 32-разрядных систем. Для 64-разрядных систем эксплоит пока отсутствует, но теоретически нет преград для его создания. Уязвимость вызвана состоянием гонки между обработкой события inotify и вызовом vfs_rename() в VFS, возникающим при выполнении операции переименования над тем же файлом. Атакующий может добиться ситуации, при которой после обработки события inotify указатель указывает на новое имя файла, а буфер выделен для старого имени. Соответственно хвост нового имени файла сохраняется за пределами буфера и переписывает данные за границей текущего slab, например, сможет переопределить следующий slab или указатель на список свободных блоков. Уязвимость устранена в Ubuntu, SUSE, openSUSE и Fedora. Проблема пока не решена в Debian и RHEL/CentOS (проблема проявляется начиная с Red Hat Enterprise Linux 7.2). В ядре Linux проблема была устранена 7 июля без информирования о влиянии исправления на безопасность.