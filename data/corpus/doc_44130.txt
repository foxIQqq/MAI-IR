Релиз FreeBSD 10.3

После семи месяцев разработки официально представлен релиз FreeBSD 10.3, который доступен для архитектур amd64, i386, ia64, powerpc, powerpc64, sparc64 и armv6. Дополнительно подготовлены образы для систем виртуализации (QCOW2, VHD, VMDK, raw) и облачных окружений Amazon EC2, Google Compute Engine и Hashicorp/Atlas Vagrant. Среди ключевых новшеств: существенное улучшение работы на системах UEFI, в том числе возможность загрузки на корневых разделах с ZFS, функция смены корневой ФС (reroot) во время загрузки, поддержка выполнения 64-разрядных приложений в режиме эмуляции Linux, добавление средств кластеризации в CAM Target Layer (CTL). Основные новшества: Серия изменений, связанных с загрузкой на системах с UEFI. В UEFI-загрузчик добавлена поддержка корневых разделов с ZFS и возможность использования нескольких загрузочных окружений ZFS, таких как предоставляются в sysutils/beadm. Улучшена совместимость с различными реализациями UEFI. В UEFI-загрузчик добавлена возможность установки переменных EFI из командной строки загрузчика, а также поддержка файлов конфигурации /boot/config и /boot.config. В применяемый в загрузчике UEFI драйвер фреймбуфера efifb добавлены новые команды gop (Graphics Output Protocol) и uga (Universal Graphics Adapter) для диагностики проблем или установки графического режима на системах с поддержкой протоколов GOP и UGA (iMac7,1, MacBook3,1). В loader.efi добавлена начальная поддержка эмуляции терминала. Решены проблемы с мультизагрузкой и с загрузкой, приводящие к выводу ошибки "ExitBootServices() returned 0x8000000000000002"; В инсталлятор bsdinstall добавлена возможность установки на корневой раздел ZFS на системах с UEFI; Обновлена реализация ZFS. По умолчанию включена поддержка сжатия LZ4, на 50% сокращено потребление памяти при использовании L2ARC, улучшено агрегирование ввода/вывода, переработан код упреждающей загрузки данных; Добавлена возможность смены корневой ФС на лету. Ранее для перемонтирования корневого раздела требовалась перезагрузка. Смена корневой ФС необходима для работы на ранней стадии загрузки временных образов ram-дисков, осуществляющих инициализацию сеанса iSCSI, с последующим подключением корневой ФС поверх iSCSI; Существенно расширены возможности инфраструктуры эмуляции окружения Linux, в которой появилась возможность выполнения 64-разрядных приложений на системах с архитектурой amd64 (x86_64), добавлена поддержки потоков 1:1, VDSO и части API мультиплексированного ввода-вывода epoll(7). В jail добавлена поддержка монтирования файловых систем linprocfs и linsysfs; В подсистему CAM Target Layer (CTL), обеспечивающую эмуляцию дисковых и процессорных устройств, через которую реализован сервер iSCSI, добавлена поддержка средств для обеспечения высокой доступности. Поддерживается создание двухузловых кластеров с асинхронными режимами доступ к юнитам LUN (ALUA, Asynchronous LUN Unit Access): Active/Unavailable, Active/Standby, синхронным Active/Active и прокси Active/Active; Системные изменения Внесены корректировки в код инициализации генератора псевдослучайных чисел, исключающие недостаток энтропии при загрузке на некоторых типах систем; В системный вызов kqueue добавлена возможность обработки событий записи для файлов, размер которых превышает 2 Гб; Переработана реализация кэша vnode, проведена оптимизация кода для распределения и чистки vnode; В библиотеку резолвинга имён добавлена поддержка перезагрузки файла /etc/resolv.conf, если изменилось время его модификации; В скрипт rc.d/netwait добавлено ожидания сетевых интерфейсов, добавленных на последней стадии загрузки, например, сетевых адаптеров с интерфейсом USB; В режиме межсетевого экрана firewall_type="SIMPLE" для блокирования адресов задействованы таблицы ipfw; Добавлена sysctl-переменная kern.features.invariants, показывающая собрано или нет ядро с поддержкой инвариантов (INVARIANTS); Инструментарий В утилиту mkimg добавлена поддержка файловой системы NTFS; Новая утилита sesutil для управления устройствами SES (SCSI Environmental Services); Новая утилита timeout, позволяющая запустить команду с ограничением времени её выполнения; В утилиту cp добавлен флаг "-s", позволяющий создавать символические ссылки; При запуске утилиты jail если явно не указана выполняемая команда по умолчанию теперь запускается shell. Добавлена опция "-l" , которая гарантирует очистку переменных окружения по аналогии с директивой exec.clean, т.е. в jail передаются только переменные HOME, SHELL, TERM и USER, которые устанавливаются в фактические значения; В утилите ifconfig при использовании флага "-v" обеспечен вывод информации об оптических модулях SFP/SFP+, при использовании поддерживающих вывод данной информации драйверов (cxgbe, ixgbe, mlx5en и sfxge); В утилиту last возвращена случайно удалённая во FreeBSD 9.0 поддержка виртуального пользователя reboot, при указании которого показываются все записи, связанные перезагрузкой; Обновлены версии сторонних программ, в том числе file 5.25, xz 5.2.2, ntpd 4.2.8p5, unbound 1.5.7, less v481, OpenSSL 1.0.1s, OpenSSH 7.2p2; В портах обновлено десктоп-окружение GNOME 3.16.2 (был 3.14.2). X.org Server обновлён до выпуска 1.17.4 (был 1.14.7); Поддержка оборудования Добавлен драйвер ismt с поддержкой контроллеров Intel SMBus 2.0; Добавлен драйвер mlx5 с поддержкой Ethernet и Infiniband сетевых карт Mellanox ConnectX-4, поддерживающих передачу данных на скоростях до 100GBit/s. Связанный с драйвером модуль ядра mlx5en включён по умолчанию в конфигурации GENERIC; В драйвер ctl добавлена поддержка CD-ROM и извлекаемых устройств; В драйвер xen добавлена поддержка непрямого сегментированного ввода/вывода blkif; Драйвер ixgbe(4) обновлён до версии 3.1.13-k, в которой появилась поддержка адаптеров X552 и X550T, добавлена поддержка настроек загрузчика hw.ix.flow_control и hw.ix.advertise_speed, исправлена большая порция проблем; Обновлён драйвер isp(4), в котором появилась поддержка 16-гигабитных адаптеров Fibre Channel и завершена реализация функциональности Multi-ID (NPIV); До версий 7.6.1 и 2.5.3 обновлены драйверы em(4) и igb(4), в которые добавлена поддержка чипов i219, i219(2) и i219(3), используемых в чипсетах для процессоров на базе Skylake и более новых микроархитектур; Удалены устаревшие драйверы ata, такие как ataahci, ataadaptec и mv_sata, вместо которых следует использовать ahci, siis и mvs; Из ядра GENERIC удалён драйвер pms из-за конфликта с драйверами ahd и mvs.