В антивирусе McAfee для Linux выявлена удалённая root-уязвимость

В проприетарном антивирусном пакете McAfee VirusScan Enterprise для платформы Linux выявлено 10 уязвимостей, сочетание которых даёт возможность организовать удалённую атаку, которая позволяет неаутентифицированному стороннему злоумышленнику выполнить свой код на сервере с правами пользователя root. Производителю было сообщено о проблеме ещё в июне, но обновление с устранением уязвимости было выпущено только вчера. Так как исправление уже доступно, обнаружившие уязвимости исследователи безопасности опубликовали рабочий прототип эксплоита. По отдельности каждая из 10 уязвимостей не является критичной, но их сочетание позволяет выстроить цепочку для совершения атаки по получению полного контроля за системой. Исследователи также обратили внимание на непростительное для профессионального ПО, связанного с обеспечением безопасности, отношение к собственной защите - процесс выполняется с правами root без сброса привилегий. Второй процесс, обеспечивающий работу web-интерфейса запускается под отдельным пользователем, но все запросы всё равно передаются для обработки процессу, работающему под root Найденные уязвимости: CVE-2016-8016: Возможность удалённой проверки наличия файла, не требующая аутентификации; CVE-2016-8017: Возможность удалённого чтения определённого класса файлов без аутентификации; CVE-2016-8018: Отсутствие токенов для защиты от CSRF-атак; CVE-2016-8019: Возможность осуществления межсайтового скриптинга; CVE-2016-8020: Удалённое выполнение кода и повышение привилегий при наличии аутентифицированного доступа к web-интерфейсу; CVE-2016-8021: Возможность записи файлов в известные пути через манипуляции с web-интерфейсом; CVE-2016-8022: Повторное использование токенов аутентификации; CVE-2016-8023: Возможность подбора токенов аутентификации; CVE-2016-8024: Разбиение HTTP-запросов; CVE-2016-8025: Подстановка SQL-кода при наличии аутентифицированного входа. Метод работы эксплоита сводится к следующим шагам: Подбор токенов аутентификации при помощи уязвимостей 7 и 8; Создание подставного сервера доставки обновлений; Использование седьмой уязвимости для отправки запроса с использованием подобранного токена аутентификации для совершения операции обновления сервера; Сохранение в системе вредоносного скрипта при помощи уязвимости 6; Отправка специально оформленного запроса с использованием подобранного токена аутентификации. Через эксплуатацию 5 и 6 уязвимостей инициируется запуск процесса сканирования на наличие вирусов, который приведёт к выполнению подготовленного ранее скрипта с правами root.