Хостинговая компания Hetzner уведомила клиентов об обнаружении бэкдора в своих системах

Известная немецкая хостинговая компания Hetzner обнаружила взлом своих систем и зафиксировала размещение весьма труднообнаружимых бэкдоров на своих серверах. Взлом инфраструктуры был произведен с использованием бэкдора, обнаруженного инженерами компании во внутренней системе мониторинга, использующей Nagios (разработчики Nagios утверждают, что в Hetzner используется форк проекта - Icinga). В результате взлома атакующие потенциально могли получить доступ ко всем данным клиентов, указанным в панели управления, в том числе к хэшам паролей и информации о совершённых платежах. Наиболее интересным моментом данной атаки является тот факт, что Rootkit поражает процессы Apache и sshd только в оперативной памяти. Файлы, хранящиеся на диске модификации не подвергаются, что делает невозможным обнаружение подобного типа вредоносного ПО средствами поиска руткитов типа rkhunter или путем сверки контрольных сумм файлов. Кроме того, процессы поражаются на лету и после модификации не перезапускаются, что дополнительно усложняет обнаружение подобной атаки. Отмечается, также то, что в рутките присутствовали функции для манипуляции ProFTPD. В уведомлении, отправленном клиентам, компания отмечает, что пароли хранились с использованием SHA256 и солью, поэтому их подбор затруднён, тем не менее, несмотря на это, клиентам рекомендуется сменить пароли. Кроме того, утверждается, что данные кредитных карт скорее всего не пострадали, так как полный серийный номер карт не хранится на серверах компании, а хранятся только последние 3 цифры, а для взаимодействия с серверами платежной системы используется привязанный к карте случайный номер.