В развиваемом проектом OpenBSD SMTP-сервере OpenSMTPD выявлена порция уязвимостей

В опубликованном на днях выпуске SMTP-сервера OpenSMTPD 5.7.2, развиваемого под эгидой проекта OpenBSD и нацеленного на создание простой и безопасной замены Sendmail, представлены исправления, подготовленные по результатам проведённого компанией Qualys Security аудита безопасности кодовой базы, в ходе которого было выявлено несколько уязвимостей. В том числе обнаружены локальное переполнение буфера и удалённо эксплуатируемая use-after-free-уязвимость, которые потенциально могут привести к выполнению кода злоумышленника с правами пользователя smtpd вне chroot-окружения. Интересно, что разработчики OpenBSD отказались поменять на сайте заявление о наличии только двух удалённо эксплуатируемых уязвимостях в базовой поставке OpenBSD за всю историю существования проекта. Отказ мотивирован тем, что OpenSMTPD по умолчанию принимает соединения только от локальных пользователей системы и прикрепляется к сетевому интерфейсу loopback, что при настройках по умолчанию позволяет осуществить атаку только имея аккаунт в системе. При том, что в случае использования OpenSMTPD в качестве SMTP-сервера, принимающего запросы извне, атака может быть совершена любым сторонним злоумышленником. После этого, автор сообщения с просьбой поменять фразу об уязвимостях в OpenBSD, указал, что проведённый ранее аудит не охватил новые подсистемы OpenSMTPD, такие как модуль фильтрации контента, поэтому данная подсистема требует отдельного изучения. В качестве демонстрации, что проблемы OpenSMTPD не ограничиваются исправленными уязвимостями, он опубликовал информацию о потенциально эксплуатируемой проблеме, не исправленной в OpenSMTPD 5.7.2. Проблема позволяет осуществить переполнение буфера через передачу слишком длинного заголовка, размером больше 65535 байт. Дополнение: доступен OpenSMTPD 5.7.3 с устранением уязвимости.