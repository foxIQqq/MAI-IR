Уязвимости, позволяющие захватить управление коммутаторами Cisco, Zyxel и NETGEAR на чипах RTL83xx

В коммутаторах на базе чипов RTL83xx, включая Cisco Small Business 220, Zyxel GS1900-24, NETGEAR GS75x, ALLNET ALL-SG8208M и ещё более десятка устройств от менее известных производителей, выявлены критические уязвимости, позволяющие неаутентифицированному атакующему получить контроль над коммутатором. Проблемы вызваны ошибками в SDK Realtek Managed Switch Controller, код из которого использовался при подготовке прошивок. Первая уязвимость (CVE-2019-1913) затрагивает управляющий web-интерфейс и даёт возможность выполнить свой код с привилегиями пользователя root. Уязвимость вызвана недостаточной проверкой передаваемых пользователем параметров и отсутствием должной оценки границ буфера при чтении входных данных. В результате, атакующий может вызвать переполнение буфера через отправку специально оформленного запроса и эксплуатировать проблему для выполнения своего кода. Вторая уязвимость (CVE-2019-1912) позволяет без аутентификации загрузить произвольные файлы на коммутатор, в том числе перезаписать файлы с конфигурацией и организовать запуск обратного shell для удалённого входа. Проблема вызвана неполной проверкой полномочий в web-интерфейсе. Также можно отметить устранение менее опасной уязвимости (CVE-2019-1914), которая позволяет при наличии непривилегированного аутентифицированного входа в web-интерфейс выполнить произвольные команды с привилегиями root. Проблемы устранены в обновлениях прошивок Cisco Small Business 220 (1.1.4.4), Zyxel и NETGEAR. Детальное описание методов эксплуатации планируется опубликовать 20 августа. Проблемы также проявляются в других устройствах на чипах RTL83xx, но они пока не подтверждены производителями и не исправлены: EnGenius EGS2110P, EWS1200-28TFP, EWS1200-28TFP; PLANET GS-4210-8P2S, GS-4210-24T2; DrayTek VigorSwitch P1100; CERIO CS-2424G-24P; Xhome DownLoop-G24M; Abaniact (INABA) AML2-PS16-17GP L2; Araknis Networks (SnapAV) AN-310-SW-16-POE; EDIMAX GS-5424PLC, GS-5424PLC; Open Mesh OMS24; Pakedgedevice SX-8P; TG-NET P3026M-24POE.