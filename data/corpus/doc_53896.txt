Уязвимости в утилите fsck для F2FS, позволяющие выполнить код на этапе проверки ФС

В штатной утилите fsck для файловой системы F2FS, предназначенной для работы с накопителями на основе Flash-памяти, выявлены две уязвимости (CVE-2020-6105, CVE-2020-6108), приводящие к перезаписи областей памяти за пределами выделенного буфера при проверке специально модифицированной файловой системы. Уязвимости могут быть эксплуатированы для выполнение кода с правами суперпользователя во время проверки ФС. Проблемы устранены в пакете f2fs-tools 1.14. В некоторых устройствах на базе платформы Android, таких как Google Pixel 3, файловая система F2FS используется для раздела /data, а утилита f2fs.fsck запускается автоматически при каждой загрузке. Так как на смену шифрования всего диска в Android пришло шифрование на уровне файлов, атакующий имеет возможность повредить метаданные в ФС нужным образом и добиться выполнения своего кода с повышенными привилегиями на этапе загрузки, что может использоваться для обхода механизма верифицированной загрузки Android. При этом для эксплуатации уязвимости атакующий должен иметь физический доступ к накопителю или временно получить права root для записи на уровне блочного устройства.