Выявлены уязвимости, позволяющие манипулировать трафиком в сетях 4G LTE

В коммуникационном стандарте LTE (4G), применяемом в современных сетях мобильной связи, выявлено несколько уязвимостей, дающих возможность анализировать трафик абонента и манипулировать данными, отправляемыми на устройство пользователя. Исследователями разработано три варианта атаки на LTE. Две атаки проводятся в пассивном режиме и позволяют собирать метаданные о трафике, например, идентифицировать определённые виды трафика и определять какие сайты посещает пользователь. Третья атака, представленная под кодовым именем aLTEr, позволяет организовать отправку подставных ответов на устройство пользователя и может применяться, например, для перенаправления на вредоносные сайты путём замены IP-адреса DNS-сервера в DNS-пакетах. Атака требует физического присутствия поблизости от жертвы и основана на инициировании подключения устройства жертвы к фиктивной базовой станции, трафик с которой перенаправляется к настоящей базовой станции (MITM-атака, напоминающая IMSI-catcher, но позволяющая не только прослушивать трафик, но и модифицировать пакеты). Возможность манипуляции трафиком вызвана недоработками в механизмах шифрования, применяемых на канальном уровне LTE (Data Link Layer). В частности, данные в LTE шифруются с использованием алгоритма AES-CTR, работающего в режиме счётчика, но без применения средств для контроля целостности блоков. Отсутствие контроля целостности позволяет подменить шифротекст. В частности, в AES-CTR шифротекст формируется путём применения операции XOR между ключевой последовательностью (keystream) и исходными данными. Если атакующий знает какие данные будут переданы в пакете он может определить часть ключевой последовательности, используемую для создания куска шифротекста (операция XOR позволяет восстановить содержимое ключа зная итоговый шифротекст и исходные данные), и использовать его для подмены известных исходных данных на свои данные, сгенерировав для них корректный шифротекст. Наиболее простой практической реализацией является подмена IP-адреса DNS-сервера в DNS-пакетах, так как атакующий может предугадать адрес DNS-сервера (обычно используются серверы провайдера или публичные серверы вида 8.8.8.8 или 1.1.1.1). Примечательно, что проблема частично затрагивает и ещё не принятый стандарт 5G, в котором введён дополнительный режим надёжного шифрования передаваемых данных с контролем целостности, но проблема в том, что данный режим не обязателен и предложен в виде опции. Атаки могут быть проведены при нахождении в радиусе примерно километра от жертвы и требуют наличия специального SDR-оборудования (Software-Defined Radio), общей стоимостью примерно 4000 долларов, и применения модифицированного LTE-стека srsLTE. В лабораторных условиях для демонстрации стабильной атаки в помещении использовались специальные экраны, которые помогали избавиться от шумов и добиться поддержания устойчивого подключения. По мнению исследователей для проведения атаки в реальных условиях потребуется разработка дополнительных инженерных решений. Чтобы дать операторам связи и производителям оборудования время на устранение уязвимости (проблема заложена в спецификации LTE и её так просто не устранить), исследователями опубликована лишь общая концепция атак, а некоторые детали, необходимые для практической реализации, планируется опубликовать только в мае следующего года на конференции "IEEE Symposium on Security and Privacy 2019". Для защиты от подмены DNS-пакетов, продемонстрированной в практической реализации атаки на LTE, пользователям рекомендуется применять методы защиты DNS-трафика, такие как DNS-SEC и DNS over TLS/HTTPS.