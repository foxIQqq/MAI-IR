Уязвимость в SFTP при неверной конфигурации OpenSSH 6.6 и более ранних выпусков

В списке рассылки Full Disclosure опубликован прототип эксплоита, поражающего 64-разрядные системы с OpenSSH 6.6 и более ранними выпусками, в которых используется неверная конфигурация SFTP-сервера. В частности, проблема проявляется, если в настройках указано принудительное выполнение встроенной реализации sftp ("ForceCommand internal-sftp"), но не определена директория для его изоляции в chroot (ChrootDirectory). Проблема связана с тем, что без выполнения chroot пользователь SFTP имеет доступ к некоторым частям базовой файловой системы, в том числе может обратиться к содержимому файла /proc/self/maps, через манипуляции с которым можно произвести запись в произвольную область памяти текущего процесса и организовать выполнение своего кода на сервере с правами непривилегированного пользователя. В представленном вчера выпуске OpenSSH 6.7 проблема устранена за счёт использования prctl() для блокирования доступа к /proc/self/{mem,maps}.