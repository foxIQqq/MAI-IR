Уязвимость в сетевых хранилищах WD MyCloud, позволяющая получить доступ без аутентификации

В выпускаемых компанией Western Digital сетевых хранилищах My Cloud выявлена уязвимость (CVE-2018-17153), позволяющая получить доступ к хранимым данным без прохождения аутентификации. Для входа в web-интерфейс устройства достаточно было отправить запрос к скрипту /cgi-bin/network_mgr.cgi, установив Cookie "username=admin", и система предоставляла доступ с правами администратора не запрашивая пароль входа. Для генерации сессионного ключа для продолжения сеанса и обращения к другим скриптам с правами администратора можно отправить POST-запрос "cmd=cgi_get_ipv6&flag=1". Успешная атака позволяет полностью контролировать настройки устройства, а также читать, модифицировать и удалять любые данные в хранилище. Компания Western Digital была информирована о проблеме ещё в апреле, но до сих пор не выпустила обновления. После пяти месяцев ожидания исследователь счёл возможным раскрыть сведения о выявленной уязвимости. Оказалось, что ещё в начале 2017 года другой исследователь безопасности уже сообщал в Western Digital о данной проблеме, но она так и не была рассмотрена. После публикации метода эксплуатации представители Western Digital сообщили, что обновление прошивки с устранением проблемы находится на финальной стадии тестирования. Пользователям рекомендуется ограничить доступ к web-интерфейсу MyCloud только для заслуживающих доверие адресов, а также отключить функцию доступа из внешних сетей (Settings->General->Cloud Access). По умолчанию режим Dashboard Cloud Access отключен, но атака возможна и из локальной сети, например в результате компрометации других устройств.