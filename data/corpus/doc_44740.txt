Уязвимость в UEFI-прошивках, позволяющая выполнить код в режиме SMM

Дмитрий Олексюк в процессе изучения прошивки ноутбука Lenovo ThinkPad T450s выявил серьёзную уязвимость в реализации UEFI, позволяющую выполнить код в режиме SMM (System Management Mode), более приоритетном, чем режим гипервизора и нулевое кольцо защиты, и имеющим неограниченный доступ ко всей системной памяти. Выполнение кода в режиме SMM позволяет отключить блокировку записи во Flash и модифицировать прошивку для отключения проверки Secure Boot или обхода ограничений гипервизора. Изначально проблема появилась в эталонном коде прошивки для восьмой серии чипсета Intel, после чего была перенесена в прошивки Lenovo и других производителей. При этом в оригинальных прошивках Intel проблема была устранена ещё в 2014 году. Кроме Lenovo проблема уже подтверждена в ноутбуках HP Pavilion и материнских платах Gigabyte. По данным компании Lenovo уязвимая прошивка была разработана одним их трёх крупнейших производителей BIOS (имя поставщика не называется). Рабочий прототип эксплоита подготовлен для UEFI-драйвера SystemSmmRuntimeRt и работает на всех сериях ноутбуков Lenovo ThinkPad, начиная с X220. Эксплоит оформлен в виде приложения UEFI, запускаемого из UEFI shell, но не исключается возможность создания эксплоитов, выполняемых из окружения операционной системы (для запуска требуются права администратора), для чего достаточно добавить в эксплоит реализацию функции EFI_BASE_PROTOCOL.Communicate(). Обновления прошивок с устранением уязвимости пока не выпущены.