Компания Microsoft добавит код на Rust в ядро Windows 11

Дэвид Вестон, вице-президент Microsoft, отвечающий за безопасность операционной системы Windows, в своём докладе на конференции BlueHat IL 2023 поделился информацией о развитии механизмов защиты Windows. Среди прочего упомянут прогресс в задействовании языка Rust для повышения безопасности ядра Windows. Более того, заявлено, что написанный на Rust код будет добавлен в ядро Windows 11 возможно уже через несколько месяцев или даже недель. В числе основных мотивов применения Rust названы задействование средств для безопасной работы с памятью и проведение работы по уменьшению ошибок в коде. В качестве начальной цели заявлена замена некоторых внутренних типов данных C++ на эквивалентные типы, предоставляемые в Rust. В текущем виде для включения в ядро подготовлено около 36 тысяч строк кода на Rust. Тестирование системы с новым кодом показало отсутствие негативного влияния на производительность в пакете PCMark 10 (тест офисных приложений), а в некоторых микротестах новый код даже оказался быстрее. Первой областью внедрения Rust стал код DWriteCore, обеспечивающий парсинг шрифтов. В проект были вовлечены два разработчика, которые потратили на переработку полгода. Применение переписанной на Rust новой реализации повысило производительность формирования глифов для текста на 5-15%. Второй областью применения Rust стала реализация типа данных REGION в Win32k GDI (Graphics Driver Interface). Переписанные на Rust компоненты интерфейса GDI уже успешно проходят все тесты при использовании в Windows, и в скором времени новый код планируют включить по умолчанию в тестовых сборках Windows 11 Insider. Из других достижений, связанных с Rust, отмечается перевод на данный язык реализации отдельных системных вызовов Windows.