Уязвимость в SCSI-коде QEMU, позволяющая выйти за пределы гостевого окружения Xen

Разработчики гипервизора Xen сообщили о выявлении уязвимости (CVE-2013-4344) в коде эмуляции SCSI, развиваемом проектом QEMU и доступном для использования в Xen. При создании SCSI-контроллера с более чем 256 прикреплёнными устройствами и отправки команды REPORT LUNS из-за небольшого размера буфера результат может быть записан за пределы выделенной области памяти, что может быть использовано для выполнения кода на стороне хост-системы с правами процесса qemu (как правило, root). Проблема проявляется только для HVM-окружений с включенной эмуляцией SCSI-контроллера (по умолчанию не применяется) и присоединением к нему более 256 устройств.