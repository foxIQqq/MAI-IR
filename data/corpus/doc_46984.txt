Оценка безопасности IP-камер Loftek и VStartcam

Исследователи из компании Checkmarx провели анализ защищённости IP-камерах Loftek DSS-2200 и VStarcam C7837WIP, которые достаточно распространены в сети - сканирование адресов выявило примерно 1.3 млн экземпляров данных устройств, находящихся в обиходе по всему миру. Результаты не специфичны для Loftek и VStartcam, так как подобные камеры с аналогичными прошивками также выпускаются под брендами Foscam, Advance, Wanscan, Apexis, Visioncam, Eshine и EyeSight. В ходе исследования выявлена серия уязвимостей, позволяющих организовать атаки для получения контроля за устройствами и их использования для организации ботнетов или проведения атак на компьютеры в локальной сети. Всего в ходе исследования камер выявлена 21 уязвимость, которые можно отнести к категории неопасных или умеренных. Не отмечено критических и опасных проблем, которые позволяют напрямую получить управление устройством без обманных манипуляций (в отчёте все атаки строятся на том, что на устройстве не изменён заданный по умолчанию пароль). Среди имеющихся проблем выделяются предопределённые параметры входа без уведомления о необходимости смены пароля по умолчанию, отсутствие поддержки HTTPS, а также проблемы CSRF, позволяющие использовать iframe для отправки команд на камеры, находящиеся во внутренней сети пользователя, открывшего страницу. Для скрытия своего присутствия после успешного получения контроля над устройством атакующий может завести нового пользователя с именем "%20" и пустым паролем, который не будет заметен в списке пользователей, отображаемом в интерфейсе администратора. В камерах VStartcam дополнительно выявлен недокументированный открытый сетевой порт, допускающих вход по протоколу telnet. Камеры VStartcam также подвержены XSS-атакам, например, можно присвоить беспроводной точке доступа имя содержащее HTML-код и этот код при подключении к данной точке доступа будет показан при открытии web-интерфейса администратором. В камерах Loftek предоставляется бесплатный сервис DDNS, который существенно упрощает определения IP-адресов камер, находящихся в сети. Каждой камере заводится поддомен id_камеры.nwsvr.com, что позволяет методом перебора определить адреса активных камер.