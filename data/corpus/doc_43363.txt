Релиз сканера сетевой безопасности Nmap 7

После трёх c половиной лет разработки анонсирован выход новой ветки сканера сетевой безопасности - Nmap 7, предназначенного для проведения аудита сети и выявления активных сетевых сервисов. В процессе подготовки новой версии внесено более трёх тысяч изменений, добавлен 171 новый NSE-скрипт, реализована полноценная поддержка IPv6, представлены средства для анализа SSL/TLS, добавлено 1413 сигнатур для определения операционных систем (общее число сигнатур 4985), число сигнатур для определения версий приложений доведено до 10299, обеспечена поддержка 1091 протокола. Среди наиболее важных новшеств Nmap 7: Средства для анализа протоколов SSL/TLS, позволяющие выявлять применение ненадёжных методов шифрования или уязвимых конфигураций. Например, можно определить поддержку устаревшего протокола SSL 3, использование RC4, применение сертификатов SHA-1, подверженность атакам Heartbleed, POODLE, LOGJAM, и FREAK. Для определения списка поддерживаемых шифров представлен NSE-скрипт ssl-enum-ciphers. Расширены возможности опции "-sV" для определения параметров SSL и TLS. Для разработчиков NSE-скриптов в состав включена новая библиотека tls, которая уже использована для создания скриптов для определения типовых уязвимостей в системах шифрования (ssl-heartbleed, ssl-poodle, ssl-ccs-injection, ssl-dh-params) и ошибок конфигурации. Расширены возможности движка Nmap Scripting Engine (NSE), предназначенного для обеспечения автоматизации различных действий с Nmap. Модульная структура NSE позволяет автоматизировать решение широкого спектра сетевых задач, от формирования запросов для получения информации о конфигурации сетевых приложений, до выявления наличия определённых уязвимостей и реализации расширенных техник обнаружения хостов. По сравнению с Nmap 5.0 число поставляемых NSE-скриптов увеличено с 348 до 515, а число NSE-библиотек - с 96 до 116. 109 новых скриптов по умолчанию применяются при указании опции "-sC", а 35 при включении определения версий при помощи опции "-sV". Движок NSE теперь предоставляет достаточно возможностей для реализации таких базовых функций, как обнаружение хостов (dns-ip6-arpa-scan), сканирование версий (ike-version, snmp-info), определение доступных сервисов RPC (rpc-grind) и сканирование портов. В качестве примеров полезных скриптов приводятся firewall-bypass, supermicro-ipmi-conf, oracle-brute-stealth и ssl-heartbleed. Представлена серия новых скриптов для проверки на наличие известных уязвимостей. Добавлено 57 новых скриптов, связанных с HTTP, в том числе скрипты для анализа заголовков, определения параметров WebDAV, выявления xss-уязвимостей. Добавлена порция полезных библиотек, в том числе для вывода в формате XML, парсинга данных, форматирования списка файлов и манипуляций с Unicode. Доведена до полноценного состояния поддержка IPv6, в том числе предоставлена возможность указания диапазонов адресов IPv6 в стиле CIDR (например, "en.wikipedia.org/120"), реализован режим Idle-сканирования, улучшено определение типа ОС по параметрам стека IPv6 и добавлена поддержка параллельного обратного резолвинга. Поддержка IPv6 также реализована в большей части NSE-скриптов; Обновление инфраструктуры. В сентябре Nmap исполнилось 18 лет, при этом проект не останавливается и продолжает внедрять новые технологии и методы разработки. Сайт Nmap.Org переведён на обязательное использование HTTPS, разработка переместилась в Git c возможностью приёма pull-запросов и координации исправления ошибок через GitHub, внедрена система непрерывной интеграции Travis, созданные новые тестовые наборы, активно используется SecWiki.org для документирования; Добавлены новые сигнатуры для определения операционных систем и версий приложений. Поддерживается определение как свежих выпусков Windows, BSD, Linux, Android и OS X, так и специализированных ОС для телеприставок, принтеров, коммутаторов и других видов устройств. Улучшены средства для определения типа сервисов, размещённых на нестандартных сетевых портах. Для проверки доступно 10299 сигнатур приложений и 1091 сигнатур протоколов; Продолжена работа по оптимизации скорости сканирования. Новый движок Nsock, поддерживающий вызовы poll и kqueue, позволил ускорить операции проверки на платформах Windows и BSD. Значительно ускорены операции выявления версий (-sV). При массовом сканировании оптимизирован процесс группировки хостов с учётом маршрутизации; Разработанная в рамках проекта программа ncat, предоставляющая средства для чтения и записи данных по сети, теперь входит в состав дистрибутивов RHEL и Fedora в качестве реализации команд "netcat" и "nc". Включению предшествовала долгая работа по устранению ошибок и обеспечению совместимости с "netcat" на уровне опций. Из новшеств ncat можно отметить поддержку Unix-сокетов, возможность использования прокси SOCKS5 с аутентификацией, интеграцию встраиваемого интерпретатора Lua, позволяющего создавать простые кросс-платформенные сетевые серверы и фильтры трафика (запуск кода на Lua производится при помощи опции "--lua-exec" ); Обеспечено формирование сборок для различных версий Windows, включая Windows 10, Windows Vista и Windows XP, а также для OS X начиная с 10.8 Mountain Lion и заканчивая 10.11 El Capitan. Обновлена поддержка Solaris и AIX; Расширение возможностей кросс-платформенного GUI-интерфейса Zenmap. Добавлена поддержка локализации интерфейса, улучшены средства сканирования крупных сетей, добавлена поддержка фильтрации вывода по типу операционной системы; Добавлена опция "--exclude-ports", позволяющая быстро исключить определённые порты при сканировании; Добавлена опция "--proxies" для организации сканирования через цепочку прокси.