Опасная локальная уязвимость в реализации mmap из состава FreeBSD 9

Во всех выпусках FreeBSD 9.x выявлена уязвимость в реализации виртуальной памяти, при успешной эксплуатации позволяющая локальному злоумышленнику повысить свои привилегии в системе. Для эксплуатации уязвимости атакующий должен иметь возможность выполнения произвольного кода с пользовательскими привилегиями. Проблема может привести к неавторизированной модификации произвольного файла к которому атакующий имеет доступ на чтение, но в обычных условиях не имеет доступа на запись. Ошибка связана с отсутствием должных проверок доступа при трассировке приложений. В частности, процесс осуществляющий трассировку (например, отладчик) может получить права доступа к областям памяти трассируемого процесса, к которым у самого трассируемого процесса нет доступа (например, используя mmap для доступного только на чтение файла, можно получить доступ на запись к связанным с данным файлом областям памяти). Всем пользователям FreeBSD 9.x рекомендуется как можно скорее произвести обновление системы до 9.1-RELEASE-p4 или 9.1-STABLE. Дополнение 1: доступен эксплоит для проверки системы на наличие уязвимости. Дополнение 2: в качестве обходного пути защиты от проявления уязвимости достаточно запретить непривилегированным пользователям выполнение ptrace - "sysctl security.bsd.unprivileged_proc_debug=0".