Оценка эффективности работы fsck на гигантских разделах XFS и Ext4

Представлены результаты оценки эффективности работы утилиты fsck при проверке файловых систем XFS и Ext4. Особенностью проведённых тестов является размер проверяемых данных - для каждой из ФС эксперименты проводились на разделе размером 72 Тб: DDN SFA10K-X из 590 дисков по 450 Гб, на базе которых создано 23 RAID-6 по 10 дисков в каждом, которые объединены в единый раздел при помощи mdadm. Для заполнения раздела на 50% использовалась утилита fs_mark, позволяющая сгенерировать структуру каталогов с наполненными случайными данными файлами (в разных тестах создано 100-400 млн файлов). Результаты: Размер ФС в Тб Число файлов (млн) Время выполнения "xfs_repair -v" для XFS (сек) Время выполнения "fsck -pfFt" для Ext4 (сек) 72 105 1629 3193 72 51 534 1811 72 10.2 161 972 38 105 710 3372 38 51 266 1358 38 10.2 131 470 Отдельно было проведено несколько дополнительных тестов для файловой системы XFS. На проверку 415 млн файлов на файловой системе XFS ушло более 3 часов. Выполнение fsck для раздела с фрагментированным наполнением из 105 тысяч файлов, созданных в результате 15 этапов наполнения, было затрачено около 11 минут. Проверка тех же 105 тысяч файлов, созданных только в директории первого уровня, заняла 27 минут.