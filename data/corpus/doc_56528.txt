Выпуск hostapd и wpa_supplicant 2.10

После полутора лет разработки подготовлен выпуск hostapd/wpa_supplicant 2.10, набора для обеспечения работы беспроводных протоколов IEEE 802.1X, WPA, WPA2, WPA3 и EAP, состоящего из приложения wpa_supplicant для подключения к беспроводной сети в роли клиента и фонового процесса hostapd для обеспечения работы точки доступа и сервера аутентификации, включающего такие компоненты как WPA Authenticator, клиент/сервер аутентификации RADIUS, сервер EAP. Исходные тексты проекта распространяются под лицензией BSD. Кроме функциональных изменений в новой версии блокирован новый вектор атаки по сторонним каналам, затрагивающий метод согласования соединений SAE (Simultaneous Authentication of Equals) и протокол EAP-pwd. Злоумышленник, имеющий возможность выполнения непривилегированного кода на системе пользователя, подключающегося к беспроводной сети, может через отслеживания активности в системе получить сведения о характеристиках пароля и использовать их для упрощения подбора пароля в offline-режиме. Проблема вызвана утечкой по сторонним каналам информации о характеристиках пароля, которые позволяют по косвенным данным, таким как изменение задержек при выполнении операций, уточнить правильность выбора частей пароля в процессе его подбора. В отличие от похожих проблем, устранённых в 2019 году, новая уязвимость вызвана тем, что внешние криптографические примитивы, используемые в функции crypto_ec_point_solve_y_coord(), не обеспечивали постоянное время выполнения операций, не зависящее от характера обрабатываемых данных. На основе анализа поведения процессорного кэша атакующий, имеющий возможность запуска непривилегированного кода на том же ядре процессора, мог получить информацию о ходе выполнения операций с паролем в SAE/EAP-pwd. Проблеме подвержены все версии wpa_supplicant и hostapd, собранные с поддержкой SAE (CONFIG_SAE=y) и EAP-pwd (CONFIG_EAP_PWD=y). Другие изменения в новых выпусках hostapd и wpa_supplicant: Добавлена возможность сборки с криптографической библиотекой OpenSSL 3.0. Реализован предложенный в обновлении спецификации WPA3 механизм Beacon Protection, предназначенный для защиты от активных атак на беспроводную сеть, манипулирующих изменением кадров Beacon. Добавлена поддержка протокола DPP 2 (Wi-Fi Device Provisioning Protocol), определяющего метод аутентификации по открытым ключам, задействованный в стандарте WPA3 для организации упрощённой настройки устройств без экранного интерфейса. Настройка осуществляется с использованием другого более продвинутого устройства, уже подключенного к беспроводной сети. Например, параметры для IoT-устройства без экрана можно задать со смартфона на основе снимка QR-кода, напечатанного на корпусе; Добавлена поддержка расширенных идентификаторов ключей (Extended Key ID, IEEE 802.11-2016). В реализацию метода согласования соединений SAE добавлена поддержка механизма защиты SAE-PK (SAE Public Key). Реализован режим мгновенной отправки подтверждения, включаемый опцией "sae_config_immediate=1", а также механизм hash-to-element, включаемый при выставлении параметра sae_pwe в значения 1 или 2. В реализацию EAP-TLS добавлена поддержка TLS 1.3 (отключена по умолчанию). Добавлены новые настройки (max_auth_rounds, max_auth_rounds_short) для изменения лимитов на число EAP-сообщений в процессе аутентификации (изменение лимитов может потребоваться при использовании очень больших сертификатов). Добавлена поддержка механизма PASN (Pre Association Security Negotiation) для установки защищённого соединения и защиты обмена управляющими кадрами на ранней стадии подключения. Реализован механизм Transition Disable, позволяющий для усиления безопасности автоматически отключать режим роуминга, допускающий переключение между точками доступа по мере перемещения. Из сборок по умолчанию исключена поддержка протокола WEP (для возвращения поддержки WEP требуется пересборка с опцией CONFIG_WEP=y). Удалена устаревшая функциональность, связанная с протоколом IAPP (Inter-Access Point Protocol). Прекращена поддержка libnl 1.1. Добавлена сборочная опция CONFIG_NO_TKIP=y для сборки без поддержи TKIP. Устранены уязвимости в реализации UPnP (CVE-2020-12695), в обработчике P2P/Wi-Fi Direct (CVE-2021-27803) и механизме защиты PMF (CVE-2019-16275). Из специфичных для hostapd изменений можно отметить расширение поддержки беспроводных сетей HEW (High-Efficiency Wireless, IEEE 802.11ax), включая возможность использования частотного диапазона 6 GHz. Изменения, специфичные для wpa_supplicant: Добавлена поддержка настроек режима точки доступа для SAE (WPA3-Personal). Для каналов EDMG (IEEE 802.11ay) реализована поддержка режима P2P. Улучшено прогнозирование пропускной способности и выбор BSS. Расширен интерфейс управления через D-Bus. Добавлен новый бэкенд для хранения паролей в отдельном файле, позволяющий вынести конфиденциальную информацию из основного файла конфигурации. Добавлены новые политики для SCS, MSCS и DSCP.