Обновление Samba 4.6.1, 4.5.7 и 4.4.12 с устранением уязвимости

Опубликованы корректирующие выпуски Samba 4.6.1, 4.5.7 и 4.4.12 в которых устранена уязвимость (CVE-2017-2619), позволяющая клиенту, имеющему право на запись файлов, через манипуляции символическими ссылками выйти за пределы экспортируемого раздела и получить доступ к произвольным частям файловой системы сервера. Проблема проявляется только при включении unix-расширений для протокола SMB1 (в качестве обходного пути защиты в настройках можно указать "unix extensions = no"). Обновления пакетов с устранением уязвимости доступны для Debian, Ubuntu, Fedora, FreeBSD, RHEL и SUSE. Для проверки попадания клиентских запросов в экспортируемую область ФС в Samba применяется системный вызов realpath(). Клиент может воспользоваться состоянием гонки (race condition) и переименовать файл в символическую ссылку в то мгновение, когда файл уже проверен в realpath(), но операция с ним ещё не обработана. Таким образом, при удачном завершении атаки сервер выполнит операцию не с проверенным файлом, а с файлом, на который ссылается символическая ссылка. Теоретически подобное стечение обстоятельств не исключается, но практически проведение успешной атаки маловероятно. В частности, продемонстрированный прототип эксплоита успешно работает только при замедлении выполнения серверного процесса при помощи strace.