Новый вид атаки на HTTPS ставит под вопрос дальнейшее существование SSL 3.0

Исследователи безопасности из компании Google представили новый вид атаки POODLE (CVE-2014-3566), которая позволяет атакующему извлечь из зашифрованного канала связи закрытую информацию, такую как содержимое Cookies, которые могут содержать идентификаторы сеанса и коды доступа, что сводит на нет средства обеспечения безопасного соединения на основе протокола SSL 3.0. Разработчики проекта Mozilla уже заявили о намерении в ближайшее время прекратить поддержку SSL 3.0 и ограничиться поддержкой последних версий протокола TLS в своих продуктах. Аналогичным образом рекомендовано поступить и другим браузерам и владельцам сайтов, заботящимся о безопасности своих пользователей. Сообщается, что прекращение поддержки SSL 3.0 не должно негативно отразиться на работе пользователей, так как по данным Mozilla в настоящее время только 0.3% всех защищённых соединений устанавливаются в Firefox с использованием SSL 3.0 и поддержка данного протокола на сайтах сохраняется в основном для обеспечения совместимости с браузером Internet Explorer 6. Mozilla планирует отключить поддержку SSL 3.0 по умолчанию начиная с выпуска Firefox 34, который намечен на 25 ноября. Кроме того, для обеспечения защиты от атак по понижению версии протокола защищённого соединения, в Firefox 35 планируется добавить поддержку механизма TLS_FALLBACK_SCSV, которые уже добавлен в Chrome начиная с февраля. Для немедленного отключения SSLv3 в Firefox подготовлено специальное дополнение. Компания Google также намерена прекратить поддержку протокола SSL 3.0 в ближайших выпусках Chrome. Патч с реализацией TLS_FALLBACK_SCSV уже подготовлен для ветки OpenSSL 1.0.1. Атака POODLE (Padding Oracle On Downgraded Legacy Encryption) позволяет восстановить содержимое отдельных секретных идентификаторов, передаваемых внутри зашифрованного SSLv3-соединения, и по своей сути напоминает такие ранее известные виды атак на HTTPS, как BREACH, CRIME и BEAST, но значительно проще для эксплуатации и не требует выполнения каких-то особых условий. Проблеме подвержен любой сайт, допускающий установку защищённых соединений с использованием протокола SSLv3, даже если в качестве более приоритетного протокола указаны актуальные версии TLS. Для отката на SSLv3 атакующие могут воспользоваться особенностью современных браузеров переходить на более низкую версию протокола, в случае сбоя установки соединения. Для организации атаки требуется получение контроля за трафиком на промежуточном шлюзе и выполнение на стороне браузера клиента JavaScript-кода злоумышленника (в случае получения контроля над транзитным шлюзом, осуществить подстановку JavaScript-кода в незащищённый трафик не составляет труда). Атака строится на возможности выделения в отслеживаемом зашифрованном трафике блоков данных с метками, отправляемыми подставным JavaScript-кодом на сайт, для которого требуется перехватить идентификационные данные, в рамках общего шифрованного канала связи. Манипулируя тем, что отправляемое JavaScript-кодом содержимое известно за исключением секретного идентификатора, атакующий путем повторной отправки подставных запросов может символ за символом восстановить содержимое искомых данных. Для сокращения числа попыток используется такая особенность SSLv3, как пропуск проверки некоторых данных, сопровождающих зашифрованное сообщение. В частности, зная позицию cookie в зашифрованном сообщении на подконтрольном атакующему узле производится реорганизации SSL-сообщения путём копирования части cookie в хвост сообщения. В большинстве случаев подобная манипуляция приводит к искажениям при расшифровке, но с вероятностью 1 к 256 сообщение декодируется верно, что сигнализирует о правильно подобранном символе. В зависимости от сложности ситуации на подбор Cookie атакующему может потребоваться от 1 до 10 минут. Для защиты на стороне сервера можно применить следующие настройки: Nginx: "ssl_protocols TLSv1.2 TLSv1.1 TLSv1;" Apache: "SSLProtocol -SSLv3 -SSLv2"