Уязвимость в библиотеке Infineon, упрощающая факторизацию закрытого RSA-ключа

В библиотеке Infineon, которой оснащаются смарткарты и TPM-модули на базе чипов компании Infineon Technologies AG, выявлена уязвимость, существенно снижающая стойкость к факторизации параметров генерации ключа по имеющемуся открытому ключу. Атака получила название "ROCA" и касается RSA-ключей, сгенерированных с использованием смарткарт и вшитых в некоторые материнские платы чипов-криптоакселераторов. Уязвимость присутствует как минимум с 2012 года и затрагивает в том числе устройства, имеющие сертификаты безопасности NIST FIPS 140-2 и CC EAL 5+. Например, проблеме оказались подвержены 750 тысяч выпущенных в Эстонии идентификационных карт, снабжённых 2048-битными ключами RSA, а также ключи созданные с использованием TPM-модулей Infineon в устройствах Microsoft (BitLocker), Google (Chromebook), HP, Lenovo, Acer, ASUS, LG, Samsung, Toshiba и Fujitsu. Проблема также присутствует в брелоках YubiKey 4, выпущенных до 6 июня 2017 года. Практические методы атаки доступны для 512-, 1024- и 2048-разрядных ключей и позволяют воссоздать закрытый ключ только на основе данных открытого ключа (доступ к смарткарте или TPM-модулю не требуется). Из-за некачественного формирования случайных простых чисел, лежащих в основе RSA-ключа, стойкость созданных при помощи библиотеки Infineon ключей кардинально снижается, например, для воссоздания 512-битного RSA-ключа по открытому ключу требуется всего 2 часа процессорного времени, 1024-битного - 97 дней работы CPU (стоимость подбора в Amazon AWS составляет $40-$80), 2048-битного - 140.8 лет CPU (стоимость подбора $20-40 тысяч). Ключи размером 3072 и 4096 бит требуют слишком много ресурсов и даже несмотря на существенное снижение стойкости остаются надёжными. Для проверки RSA-ключей введена в строй web-форма, которая позволяет определить наличие проблемы по открытому RSA-ключу. Детали атаки планируется раскрыть 2 ноября на конференции ACM CCS-2017.