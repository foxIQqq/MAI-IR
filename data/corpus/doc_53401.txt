BadPower - атака на адаптеры быстрой зарядки, способная вызвать возгорание устройства

Исследователи безопасности из китайской компании Tencent представили (интервью) новый класс атак BadPower, нацеленный на поражение зарядных устройств для смартфонов и ноутбуков, поддерживающих протокол быстрой зарядки. Атака позволяет инициировать передачу зарядным устройством чрезмерной мощности, на которую не рассчитано оборудование, что может привести к выходу из строя, расплавлению частей или даже возгоранию устройства. Атака производится со смартфона жертвы, управление которым захвачено атакующим, например, через эксплуатацию уязвимости или внедрение вредоносного ПО (устройство одновременно выступает в качестве источника и объекта атаки). Метод может применяться для физического повреждения уже скомпрометированного устройства и проведения диверсий, способных вызвать пожар. Атака применима к зарядным устройствам, поддерживающим обновление прошивки и не использующим верификацию загружаемого кода по цифровой подписи. Зарядные устройства, не поддерживающие перепрошивку, атаке не подвержены. Степень возможных повреждений зависит от модели зарядного устройства, выдаваемой мощности и наличия механизмов защиты от перегрузки у заряжаемых устройств. Протокол быстрой зарядки по USB подразумевает наличие процесса согласования параметров зарядки c заряжаемым устройством. Заряжаемое устройство передаёт зарядному устройству сведения о поддерживаемых режимах и допустимом напряжении (например, вместо 5 вольт сообщается о возможности принять 9, 12 или 20 вольт). Зарядное устройство может контролировать параметры в ходе зарядки, изменять скорость заряда и регулировать напряжение в зависимости от температуры. В случае распознания зарядным устройством заведомо завышенных параметров или внесения изменений в код управления ходом зарядки, зарядное устройство может выдать параметры заряда, на которые устройство не рассчитано. Метод проведения атаки BadPower связан с повреждением прошивки или загрузкой на зарядное устройство модифицированной прошивки, выставляющей максимально возможное напряжение. Мощность зарядных устройств стремительно растёт и, например, Xiaomi планирует в следующем месяце выпустить устройства, поддерживающие технологии быстрой зарядки на 100 и 125 Вт. Из 35 протестированных исследователями адаптеров быстрой зарядки и внешних аккумуляторов (Power Bank), выбранных из доступных на рынке 234 моделей, атака оказалась применима к 18 устройствам, выпускаемым 8 производителями. Атака на 11 из 18 проблемных устройств оказалась возможной в полностью автоматическом режиме. Для замены прошивки на 7 устройствах потребовались физические манипуляции с зарядным устройством. Исследователи пришли к выводу, что степень безопасности не зависит от используемого протокола быстрой зарядки, а связана исключительно с возможностью обновления прошивки по USB и с применением криптографических механизмов верификации операций с прошивкой. Перепрошивка некоторых зарядных устройств производится через штатный USB-порт и позволяет выполнить модификацию прошивки с атакуемого смартфона или ноутбука без применения спецоборудования и скрыто от владельца устройства. По данным исследователей около 60% чипов предлагаемых на рынке чипов быстрой зарядки позволяют в финальных продуктах организовать обновление прошивки через USB-порт. Большую часть связанных с технологией атаки BadPower проблем можно устранить на уровне прошивки. Для блокирования атаки производителям проблемных зарядных устройств предложено усилить защиту от неавторизированной модификации прошивок, а производителям потребительских устройств добавить дополнительные механизмы контроля перегрузки. Пользователям не рекомендуется использовать переходники с Type-C для подключения устройств быстрой зарядки к смартфонам, не поддерживающим такой режим, так как подобные модели хуже защищены от возможных перегрузок.