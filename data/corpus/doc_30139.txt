Уязвимость в реализации протокола IPComp в NetBSD и FreeBSD

В операционных системах NetBSD и FreeBSD найдена уязвимость, позволяющая инициировать переполнение стека на уровне ядра системы, что теоретически позволяет злоумышленнику добиться выполнения своего кода на уровне ядра через отправку специально сформированных сетевых пакетов. Уязвимость вызвана проявляющейся при обработке рекурсивных запросов ошибкой в реализации поддержки протокола IPcomp (IP Payload Compression Protocol, RFC3173), используемом для сжатия отдельных IP-датаграмм. Для эксплуатации уязвимости пакеты могут быть отправлены с фиктивного IP-адреса и не требуют предварительной аутентификации при использовании IPComp совместно с VPN или IPSec. Для платформы NetBSD упомянута возможность организации удаленного выполнения кода в системе. Для FreeBSD говорится только о возможности совершения DoS-атаки (теоретически возможность выполнения кода не исключается). Проблема проявляется только при сборке системы с поддержкой IPSec (в NetBSD и FreeBSD по умолчанию IPSec отключен). Исправление проблемы доступно в виде патчей для FreeBSD и NetBSD. В качестве обходного варианта защиты от уязвимости, является блокирование ipcomp-трафика (ipfw add deny proto ipcomp). Не исключено, что уязвимости подвержены и другие операционные системы, использующие KAME IPSec-стек NetBSD, такие как Mac OS X.