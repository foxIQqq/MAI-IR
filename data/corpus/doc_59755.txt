В инсталляторе Ubuntu 23.10 будет возвращена поддержка ZFS

В Ubuntu 23.10 в инсталляторах, применяемых для установки серверной и настольной редакций дистрибутива, появится поддержка установки системы с использованием файловой системы ZFS на корневом разделе. В Ubuntu Desktop подобная возможность присутствовала и ранее, но была убрана в Ubuntu Desktop 23.04 из-за задействования нового инсталлятора, написанного на языке Dart и использующего пользовательский интерфейс на базе фреймворка Flutter. Одним из недостатков нового инсталлятора, который также используется в Ubuntu Server, было отсутствие поддержки ZFS, но в осеннем выпуске эта недоработка будет устранена, с одним ограничением - пока не реализована возможность создания шифрованных разделов ZFS. По умолчанию во всех редакциях Ubuntu продолжает предлагаться файловая система Ext4, а поддержка ZFS позиционируется как экспериментальная. Напомним, что возможность распространения готового модуля ZFS в составе дистрибутивов вызывает споры у юристов. Код ZFS распространяется под свободной лицензией CDDL, которая несовместима с GPLv2, что не позволяет добиться интеграции модуля zfs.ko в состав основной ветки ядра Linux, так как смешивание кода под лицензиями GPLv2 и CDDL недопустимо. Для обхода данной лицензионной несовместимости проектом OpenZFS было решено распространять продукт целиком под лицензией CDDL в виде отдельно загружаемого модуля, который поставляется отдельно от ядра. Юристы организации Software Freedom Conservancy (SFC) считают, что поставка в дистрибутиве бинарного модуля ядра образует комбинированный с GPL продукт с требованием распространения итоговой работы под GPL. Юристы компании Canonical не согласны и утверждают, что поставка модуля zfs допускается, если компонент поставляется в виде самодостаточного модуля, отдельно от пакета с ядром. Canonical отмечает, что дистрибутивы давно используют подобный подход для поставки проприетарных драйверов, таких как драйверы NVIDIA. SFC считает, что аналогия неуместна, так как проблема совместимости с ядром в проприетарных драйверах решается поставкой небольшой прослойки, распространяемой под лицензией GPL (в ядро грузится модуль под лицензией GPL, который уже загружает проприетарные компоненты). Для ZFS подобную прослойку можно подготовить только в случае предоставления лицензионных исключений от компании Oracle. В Oracle Linux несовместимость с GPL решается предоставлением компанией Oracle лицензионного исключения, снимающего требование по лицензированию комбинированной работы под CDDL, но это исключение не действует для других дистрибутивов. Обходным манёвром является поставка в дистрибутиве только исходных текстов модуля, которая не приводит к связыванию и рассматривается как поставка двух отдельных продуктов. В Debian для этого задействована система DKMS (Dynamic Kernel Module Support), при которой модуль поставляется в исходных текстах и собирается на системе пользователя, непосредственно после установки пакета.