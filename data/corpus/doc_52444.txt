Ростелеком начал подстановку своей рекламы в трафик абонентов

Ростелеком, крупнейший в РФ оператор широкополосного доступа, обслуживающий около 13 млн абонентов, без лишней огласки ввёл в строй систему подстановки своих рекламных баннеров в незашифрованный HTTP-трафик абонентов. Так как подставляемые в транзитный трафик JavaScript-блоки включали обфусцированный код и обращение к неаффилированным с Ростелекомом сомнительным сайтам (p.analytic.press, d.d1tracker.ru, dmd.digitaltarget.ru), вначале возникло подозрение на компрометацию оборудования провайдера и внедрение вредоносного ПО во внутридомовой маршрутизатор. Но после отправки претензии представители Ростелекома указали на то, что подстановка рекламы осуществляется в рамках действующего с 10 февраля сервиса показа баннерной рекламы абонентам. Показ рекламы осуществляется через баннерную сеть mail.ru, а перемещения отслеживаются через d1tracker.ru (обработчик размещён в облаке Amazon). В коде также фигурируют обращения к домену analytic.press, который зарегистрирован в конце декабря. Как правило, отображается либо полноэкранная реклама, перекрывающее всё содержимое страницы, либо в верхнюю часть страниц добавляется баннер. В большинстве случаев размещаемые блоки выглядят как размещение назойливой рекламы самими сайтами и абонент не догадывается, что на деле реклама подставлена провайдером. Рекламируются всевозможные услуги сторонних компаний (не связанных с Ростелекомом), вплоть до продажи фонариков. Пример подставляемого кода можно изучить в данном архиве. Часть кода обфусцирована и загружается динамически, поэтому без детального анализа трудно судить, подставляют они только рекламу или выполняют какие-то иные действия на стороне клиентского браузера. Через штатные интерфейсы личного кабинета не предусмотрена возможность отключения подстановки рекламы, но после написание претензии на странице заявок, сотрудники Ростелекома отключают подстановку рекламы для конкретных абонентов. Вопрос о том, касается подстановка только незашифрованного HTTP-трафика или компания также вклинивается и в HTTPS-трафик через подмену сертификатов остался без ответа. На сайте компании информация о начале модификации транзитного трафика клиентов не отражена. Дополнение 1: После пометки заявки на прекращение модификации транзитного трафика выполненной, реклама некоторое время не всплывала, но сейчас стала появляться опять, т.е. механизм отключения подстановки рекламы для абонентов в Ростелеком не работает или через какое-то время подстановка включается опять. Дополнение от 2 марта: Несмотря на отправку повторной заявки, спустя неделю подстановка рекламы так и не отключена. Служба поддержки не имеет каких-либо сведений о выполнении заявки и о том, кто её должен выполнить, а лишь предлагает повторно отправить заявку. Судя по всему, заявки отправляются в пустоту и без выполнения закрываются. Более того, началась подстановка закреплённых баннеров, которые перекрывают нижнюю половину контента и остаются на месте при прокрутке страницы. Данные баннеры уже вполне можно рассматривать как вредоносную активность, так как они мешают просмотру страниц, не имеют кнопки закрытия (дополнение: кнопка закрытия появляется при наведении курсора на баннер, но не показывается по умолчанию, например, не видна на сенсорных экранах) и не позволяют полностью прочитать содержимое. В тексте договора о предоставлении услуг связи (копия стр 1, стр 2) явно ничего не сказано про условия пропускания трафика, но указано, что все подобные вещи должны соответствовать Закону "О Связи". Сомнительно, что Закон "О Связи" разрешает изменять трафик в корыстных целях и подставлять данные третьих лиц, мешающие просмотру запрошенной информации. Дополнение от 6 марта: 3 марта представители Ростелекома позвонили и сообщили, что отключение подстановки рекламы по требованию абонента налажено. Подстановки рекламы за последние три дня не замечено.