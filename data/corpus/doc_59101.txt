Уязвимости в Netfilter и io_uring, позволяющие повысить свои привилегии в системе

В подсистемах ядра Linux Netfilter и io_uring выявлены уязвимости, позволяющие локальному пользователю повысить свои привилегии в системе: Уязвимость (CVE-2023-32233) в подсистеме Netfilter, вызванная обращением к памяти после её освобождения (use-after-free) в модуле nf_tables, обеспечивающем работу пакетного фильтра nftables. Уязвимость может быть эксплуатирована через отправку специально оформленных запросов на обновление конфигурации nftables. Для проведения атаки требуется наличие доступа к nftables, который можно получить в отдельном сетевом пространстве имён (network namespaces) при наличии прав CLONE_NEWUSER, CLONE_NEWNS или CLONE_NEWNET (например, при возможности запуска изолированного контейнера). Чтобы дать пользователям время на установку обновлений выявивший проблему исследователь пообещал отложить на неделю (до 15 мая) публикацию детальной информации и примера рабочего эксплоита, предоставляющего root shell. Уязвимость устранена в обновлении 6.4-rc1. Проследить за исправлением уязвимости в дистрибутивах можно на страницах: Debian, Ubuntu, Gentoo, RHEL, Fedora, SUSE/openSUSE, Arch. Уязвимость (CVE-2023-2598) в реализации интерфейса асинхронного ввода/вывода io_uring, входящего в ядро Linux начиная с выпуска 5.1. Проблема вызвана ошибкой в функции io_sqe_buffer_register, позволяющей получить доступа к физической памяти за границей статически выделенного буфера. Проблема проявляется только в ветке 6.3 и будет устранена в готовящимся обновлении 6.3.2. Для тестирования уже доступен рабочий прототип эксплоита, позволяющий выполнить код с привилегиями ядра.