Во FreeBSD появится прослойка для использования графических драйверов ядра Linux

Разработчики FreeBSD пересмотрели подход к портированию DRM/KMS-драйверов из ядра Linux. Если ранее новая версия DRM-драйвера Linux адаптировалась для ядра FreeBSD, что приводило к необходимости применения достаточного большого патча (различия составляют почти 17 тысяч строк), то при портировании драйвера Intel i915 из ядра Linux 3.9+ будет применён новый подход - драйвер будет поставляться с минимальным числом изменений, а для его работы будет применена специальная прослойка KPI, транслирующая вызовы окружения Linux в окружение ядра FreeBSD. В настоящее время уже подготовлен рабочий прототип прослойки, позволивший запустить во FreeBSD DRM-драйвер i915 из ядра Linux 4.6, сократив число изменений до 4 тысяч строк. Конечной целью является сведение числа изменений до менее чем 1 тыcячи строк и обеспечение непрерывного портирования актуальной кодовой базы DRM и KMS драйверов Linux. Модуль KPI и новые модули DRM в ближайшее время будут включены в дерево портов FreeBSD. Первый бета выпуск планируется успеть подготовить к релизу FreeBSD 11.