В почтовом сервере Exim 4.80.1 устранена критическая уязвимость

Разработчики почтового сервера Exim сообщили, что во всех версиях, начиная с 4.70 и заканчивая 4.80 включительно, найдена уязвимость, которая позволяет удалённому атакующему теоретически получить полный доступ к системе на которой запущен Exim. Уязвимость проявляется в конфигурациях с подсистемой DKIM, которая включена по умолчанию и присутствует в большинстве сборок Exim в разных дистрибутивах. Ошибка найдена в коде с реализацией протокола аутентификации подлинности e-mail сообщений DKIM (DomainKeys Identified Mail) и проявляется из-за отсутствия достаточной проверки данных, возвращаемых удалённым DNS-сервером, что позволяет выполнить произвольный код при декодировании специально оформленного DNS-ответа. Для эксплуатации уязвимости достаточно отправить email с домена, который обслуживается подконтрольным злоумышленникам DNS-сервером, и на запрос сервера жертвы вернуть специально модифицированный DNS-ответ. Для исправления бреши в безопасности был выпущен внеплановый корректирующий релиз Exim 4.80.1, который отличается от версии 4.80 только исправлением вышеупомянутой уязвимости. В настоящий момент в процессе подготовки находится значительный релиз 4.82, который было решено не выпускать раньше времени, так как он ещё не в полной мере протестирован. Ошибка была найдена при проведении внутреннего аудита кода компонента Exim, отвечающего за подписание и верификацию DKIM записей. Для временного решения проблемы без пересборки и обновления приложения, в секции cl_smtp_connect или acl_smtp_rcpt файла конфигурации можно добавить строку "warn control = dkim_disable_verify". Обновления с исправлением уязвимости в настоящий момент доступны только для Debian, Ubuntu и FreeBSD. Статус выхода исправлений для остальных систем можно отследить на следующих страницах: Gentoo, Mandriva, openSUSE, CentOS, Fedora, RHEL.