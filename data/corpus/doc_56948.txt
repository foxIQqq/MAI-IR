Уязвимость в GitLab, позволяющая захватить аккаунты, авторизированные через OAuth, LDAP и SAML

В корректирующих обновлениях платформы для организации совместной разработки GitLab 14.7.7, 14.8.5 и 14.9.2 устранена критическая уязвимость (CVE-2022-1162), связанная с установкой предопределённых (hardcoded) паролей для учётных записей, зарегистрированных с использованием провайдера OmniAuth (OAuth, LDAP и SAML). Уязвимость потенциально позволяет атакующему получить доступ к учётной записи. Всем пользователям рекомендуется срочно установить обновление. Детали проблемы пока не раскрываются. Для пользователей, чьи учётные записи были подвержены проблеме, инициирован сброс установленных паролей. Проблема выявлена сотрудниками GitLab и проведённое расследование не выявило следов компрометации пользователей. В новых версиях также устранено ещё 16 уязвимостей, из которых 2 помечены как опасные, 9 - умеренные и 5 неопасные. Среди опасных проблем - возможность подстановки HTML-кода (XSS) в примечания (CVE-2022-1175) и комментарии/описания в issue (CVE-2022-1190). Дополнение: Судя по изменениям в коде, в рабочем коде вместо отдельного токена использовался типовой тестовый пароль из переменной "Gitlab::Password.test_default", генерируемый как '"123qweQWE!@#" + "0" * (User.password_length.max - DEFAULT_LENGTH') и предназначенный для проведения тестов.