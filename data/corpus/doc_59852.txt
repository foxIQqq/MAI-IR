Уязвимости в ядре Linux, Glibc, GStreamer, Ghostscript, BIND и CUPS

Несколько недавно выявленных уязвимостей: CVE-2023-39191 - уязвимость в подсистеме eBPF, дающая возможность локальному пользователю повысить свои привилегии и выполнить код на уровне ядра Linux. Уязвимость вызвана некорректной проверкой eBPF-программ, передаваемых пользователем для выполнения. Для проведения атаки пользователь должен иметь возможность загрузки своей BPF-программы (если параметр kernel.unprivileged_bpf_disabled выставлен в значение 0, например, как в Ubuntu 20.04). Сведения об уязвимости переданы разработчикам ядра ещё в декабре прошлого года, а исправление без лишней огласки внесено в январе. CVE-2023-42753 - ошибка при работе с индексами массивов в реализации ipset в подсистеме ядра netfilter, которая может использоваться для инкремента/декремента указателей и создания условий для записи или чтения в область памяти за пределами выделенного буфера. Для проверки наличия уязвимости подготовлен прототип эксплоита, вызывающий аварийное завершение (не исключены более опасные сценарии эксплуатации). Исправление включено в состав выпусков ядра 5.4.257, 6.5.3, 6.4.16, 6.1.53, 5.10.195, 5.15.132. CVE-2023-39192, CVE-2023-39193, CVE-2023-39193 - несколько уязвимостей в ядре Linux, приводящих к утечке содержимого памяти ядра из-за возможности чтения из областей вне выделенного буфера в функциях match_flags и u32_match_it подсистемы Netfilter, а также в коде обработки фильтров состояния. Уязвимости устранены в августе (1, 2) и июне. CVE-2023-42755 - уязвимость, позволяющая непривилегированному локальному пользователю вызвать крах ядра из-за ошибки при работе с указателями в классификаторе трафика rsvp. Проблема проявляется в LTS-ядрах 6.1, 5.15, 5.10, 5.4, 4.19 и 4.14. Подготовлен прототип эксплоита. Исправление пока не принято в состав ядра и доступно в виде патча. CVE-2023-42756 - состояние гонки в подсистеме ядра NetFilter, которое можно использовать для вызова локальным пользователем состояния Panic. Доступен прототип эксплоита, работающий как минимум в ядрах 6.5.rc7, 6.1 и 5.10. Исправление пока не принято в состав ядра и доступно в виде патча. CVE-2023-4527 - переполнение стека в библиотеке Glibc, возникающее в функции getaddrinfo при обработке DNS-ответа, размером более 2048 байт. Уязвимость может привести к утечке данных из стека или аварийному завершению. Уязвимость проявляется только версиях Glibc новее 2.36 при использовании опции "no-aaaa" в /etc/resolv.conf. CVE-2023-40474, CVE-2023-40475 - уязвимости в мультимедийном фреймворке GStreamer, вызванные целочисленным переполнением в обработчиках файлов с видео в формате MXF. Уязвимости могут привести к выполнению кода атакующего при обработке специально оформленных MXF-файлов в приложении, использующем GStreamer. Проблема устранена в пакете gst-plugins-bad 1.22.6. CVE-2023-40476 - переполнение буфера в предлагаемом в GStreamer обработчике видео в формате H.265, позволяющее организовать выполнение кода при обработке специально оформленного видео. Уязвимость устранена в пакете gst-plugins-bad 1.22.6. Разбор - разбор эксплоита, использующего уязвимость CVE-2023-36664 в пакете Ghostscript для выполнения своего кода при открытии специально оформленных документов в формате PostScript. Проблема вызвана некорректной обработкой имён файлов, начинающихся с символа "|" или префикса %pipe%. Уязвимость устранена в выпуске Ghostscript 10.01.2. CVE-2023-3341, CVE-2023-4236 - уязвимости в DNS-сервере BIND 9, приводящие к аварийному завершению процесса named при обработке специально оформленных управляющих сообщений (достаточно доступа к TCP-порту, через который выполняется управление named (по умолчанию открыт только для loopback-интерфейса), знания ключа RNDC не требуется) или создания определённой высокой нагрузки в режиме DNS-over-TLS. Уязвимости устранены в выпусках BIND 9.16.44, 9.18.19 и 9.19.17. CVE-2023-4504 - уязвимость в сервере печати CUPS и библиотеке libppd, приводящая к переполнению буфера при разборе специально оформленных документов в формате Postscript. Не исключена эксплуатация уязвимости для организации выполнения своего кода в системе. Проблема устранена в выпусках CUPS 2.4.7 (патч) и libppd 2.0.0 (патч).