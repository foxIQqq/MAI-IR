Уязвимости в Samba, приводящие к переполнению буфера и выходу за границу базового каталога

Опубликованы корректирующие выпуски пакета Samba 4.17.2, 4.16.6 и 4.15.11 с устранением двух уязвимостей. Выпуск обновлений пакетов в дистрибутивах можно проследить на страницах: Debian, Ubuntu, Gentoo, RHEL, SUSE, Arch, FreeBSD. CVE-2022-3437 - переполнение буфера в функциях unwrap_des() и unwrap_des3(), предоставляемых в библиотеке GSSAPI из пакета Heimdal (поставляется в составе Samba, начиная с версии 4.0). Эксплуатация уязвимости возможна через отправку специально оформленного пакета на системы, в которых используется GSSAPI. Например проблема проявляется в реализации клиента и файлового сервера на базе протокола SMB1, при применении DCE/RPC и в контроллере домена Active Directory. Системы собранные с MIT Kerberos (--with-system-mitkrb5) вместо Heimdal проблеме не подвержены. CVE-2022-3592 - возможность выхода за границы экспортируемого каталога и доступа к любому файлу на сервере через манипуляции с символическими ссылками. Проблема проявляется только в ветке Samba 4.17 и вызвана ошибкой в новом коде для обработки символических ссылок в пространстве пользователя (в коде отсутствовала проверка нахождения целевого каталога ссылки за границей экспортируемого каталога). Уязвимость может быть эксплуатирована клиентом, имеющим доступ на запись в экспортируемый раздел, предоставляемый через протоколы SMB1 или NFS, допускающие создание символических ссылок.