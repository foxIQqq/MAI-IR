Опубликован Microsoft-Performance-Tools для Linux и началось распространение WSL для Windows 11

Компания Microsoft представила открытый пакет Microsoft-Performance-Tools для анализа производительности и диагностики связанных с производительностью проблем на платформах Linux и Android. Для работы предлагается набор утилит командной строки для анализа производительности всей системы и профилирования отдельных приложений. Код написан на языке C# с использованием платформы .NET Core и распространяется под лицензией MIT. В качестве источника для отслеживания активности в системе и профилирования приложений могут использоваться подсистемы LTTng, perf и Perfetto. LTTng даёт возможность оценивать работу планировщика задач, отслеживать активность процессов, анализировать системные вызовы, ввод/вывод и события в ФС. Perf применяется для оценки нагрузки на CPU. Perfetto может применяться для анализа производительности Android и браузеров на базе движка Chromium, и позволяет учитывать работу планировщика задач, оценивать нагрузку на CPU и GPU, применять FTrace и выполнять трассировку типовых событий. Инструментарий также может извлекать информацию из логов в форматах dmesg, Cloud-Init и WaLinuxAgent (Azure Linux Guest Agent). Для наглядного анализа трассировок с использованием графиков поддерживается интеграция с графическим интерфейсом Windows Performance Analyzer, доступным только для Windows. Отдельно отмечается появление в Windows 11 Insider Preview Build 22518 возможности установки окружения WSL (Windows Subsystem for Linux) в виде приложения, распространяемого через каталог Microsoft Store. При этом с точки зрения используемых технологий начинка WSL осталась прежней, изменился лишь метод установки и обновления (WSL для Windows 11 не встроен в системный образ). Заявлено, что распространение через Microsoft Store даст возможность ускорить доставку обновлений и новых возможностей WSL, в том числе позволяя устанавливать новые версии WSL без привязки к версии Windows. Например, после готовности таких экспериментальных функций, как поддержка графических Linux-приложений, вычислений на стороне GPU и монтирования дисков, пользователь сразу сможет получить к ним доступ, без необходимости обновления Windows или использования тестовых сборок Windows Insider. Напомним, что в современном окружении WSL, обеспечивающем запуск исполняемых файлов Linux, вместо эмулятора, выполнявшего трансляцию системных вызовов Linux в системные вызовы Windows, используется окружение с полноценным ядром Linux. Предлагаемое для WSL ядро основано на выпуске ядра Linux 5.10, который расширен специфичными для WSL патчами, включающими оптимизации для сокращения времени запуска ядра, уменьшения потребления памяти, возвращения Windows освобождённой Linux-процессами памяти, оставления в ядре минимально необходимого набора драйверов и подсистем. Ядро выполняется в окружении Windows при помощи виртуальной машины, уже задействованной в Azure. Окружение WSL выполняется в отдельном дисковом образе (VHD) c файловой системой ext4 и виртуальным сетевым адаптером. Компоненты пространства пользователя устанавливаются отдельно и базируются на сборках различных дистрибутивов. Например, для установки в WSL в каталоге Microsoft Store предлагаются сборки Ubuntu, Debian GNU/Linux, Kali Linux, Fedora, Alpine, SUSE и openSUSE.