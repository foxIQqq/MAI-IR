Критическая уязвимость в Xen, позволяющая получить контроль над хост-системой

Проект Xen сообщил об устранении в гипервизоре порции уязвимостей, из которых отдельного внимания заслуживает проблема CVE-2015-7835 (XSA-148). Уязвимость позволяет привилегированному пользователю паравиртуализированной гостевой системы получить полный контроль над хост-системой и другими виртуальными окружениями. Проблема была выявлена инженерами компании Alibaba, которые недавно подключились к разработке Xen. Проблема вызвана ошибкой в коде "маппинга" больших страниц памяти в паравиртуализированных гостевых системах (PV) и позволяет получить доступ на запись к страницам памяти, рассчитанным на обращение только в режиме чтения. По мнению разработчиков операционной системы Qubes, выявленная проблема является самой опасной уязвимостью за всю историю существования проекта Xen. То, что проблема присутствует в кодовой базе Xen уже семь лет заставляет задуматься о необходимости аудита безопасности кодовой базы гипервизора и рассмотрению безопасности как первичного приоритета в разработке Xen. Уязвимость проявляется в Xen 3.4 и более новых выпусках, на 32- и 64-разрядных системах x86 (платформы ARM проблеме не подвержены). Всем пользователям Xen рекомендуется срочно применить патчи или установить обновления, которые в настоящий момент доступны только для Qubes OS (пакеты 4.4.3-8 и 4.1.6.1-23). Обходным вариантом является перевод паравиртуализированных гостевых систем в режим полной виртуализации (HVM). Компания Amazon сообщила, что её облачные сервисы не подвержены проблеме. Rackspace, IBM/Softlayer и Linode также уже устранили проблему до её публичного обнародования в рамках программы предварительного информирования вендоров.