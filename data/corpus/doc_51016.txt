Уязвимости во FreeBSD, затрагивающие UFS, iconv и драйвер cd

Во FreeBSD устранены три уязвимости, которые позволяют повысить свои привилегии в системе или получить доступ к данным ядра. Проблемы исправлены в обновлениях 11.2-RELEASE-p11 и 12.0-RELEASE-p7. CVE-2019-5602 - в драйвере "cd", применяемом для доступа к CD-ROM, выявлена уязвимость, которая позволяет через отправку определённых ioctls добиться перезаписи областей памяти ядра и организовать выполнение своего кода с правами ядра. Для доступа к проблемным ioctls пользователь должен входить в группу operator. Для успешного совершения атаки необходимо, чтобы в накопителе находился определённый диск. Для защиты можно ограничить доступ к устройствам CD через удаление соответствующих правил в файлах devfs.conf и devfs.rules; CVE-2019-5600 - в реализации API iconv, предназначенном для перекодирования текста в разных кодировках, выявлена ошибка, которая может привести к записи хвоста данных за пределы выделенного буфера. В зависимости от применения iconv в приложениях возможен вызов отказа в обслуживании или организация выполнения кода с правами приложения при обработке специально оформленных данных (возможно совершение и удалённой атаки на сетевые обработчики, применяющие iconv для перекодирования текста); CVE-2019-5601 - ошибка в реализации файловой системы UFS может привести к записи данных из стека ядра в качестве добавочного заполнения структур каталога, которые могут прочитать непривилегированные пользователи, имеющие доступ к каталогу. При наличии доступа только на чтение возможна утечка до 3 байт на каждый элемент каталога, а при доступе на запись - до 254 байт данных из стека ядра.