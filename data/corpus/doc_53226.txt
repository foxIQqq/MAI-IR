Анонсирован Perl 7

На проходящей сегодня виртуальной конференции разработчиков языка Perl анонсирован проект Perl 7, который плавно продолжит развитие ветки Perl 5 без внесения радикальных изменений. Perl 7 будет аналогичен выпуску Perl 5.32.0, за исключением иных настроек по умолчанию, лучше соответствующих современной практике разработки. В остальном Perl 7 останется тем же Perl 5 и сохранит совместимость с ранее разработанными приложениями. Значительная смена номера версии выступит своеобразным разделителем перехода к новой модели наращивания функциональности языка Perl без ощутимого нарушения обратной совместимости. Предполагается, что создание Perl 7 поможет привлечь к использованию Perl новых разработчиков и наладить процесс добавления в язык значительных новых возможностей, сохраняя при этом совместимость с кодовой базой существующих проектов. Номер 7 выбран так как Perl 6 был использован при разработке языка, который теперь развивается под отдельным именем Raku. Первый релиз Perl 7 ожидается в следующем году. Ветка Perl 5.32 станет последней в серии Perl 5 и её планируется поддерживать от 5 до 10 лет. Наиболее заметным изменением в Perl 7 станет включение по умолчанию режима "strict", подразумевающего строгую проверку объявления переменных, использования символьных указателей и присвоения подпрограмм. Использование "use strict" является хорошим тоном и применяется большинством разработчиков. Аналогично по умолчанию планируют включить обработку предупреждений ("use warnings"). В Perl 7 также рассчитывают стабилизировать и включить по умолчанию некоторые уже существующие экспериментальные возможности, такие как сигнатуры функций ("use feature 'signatures'"), позволяющие при определении функции определить входящие аргументы и автоматизировать проверку их числа (можно будет писать "sub foo ($left, $right) {" вместо "sub foo { my($left, $right) = @_;"). Планируют включить по умолчанию и поддержку оператора "isa" для проверки того, является ли объект экземпляром указанного класса или классом, производным от него ("if( $obj isa Package::Name )", а также операций постфиксного разыменования (postderef) "$sref->$*" вместо "${ $sref }", "$aref->@*" вместо "@{ $aref }" и "$href->%{ ... }" вместо "%$href{ ... }". Претендентами на отключение по умолчанию в Perl 7 являются: Косвенная нотация вызова объектов ("no feature qw(indirect)") - устаревший способ вызова объектов, при котором вместо "->" используется пробел ("method $object @param" вместо "$object->$method(@param)"). Например, вместо "my $cgi = new CGI" нужно будет всегда использовать "my $cgi = CGI->new". Голые файловые дескрипторы без объявления переменных ("no bareword::filehandle") - использование конструкций вида "open FH, $file" будет приводить к ошибке, нужно использовать "open my $fh, $file". Изменение не затронет стандартные файловые дескрипторы STDIN, STDOUT, STDERR, ARGV, ARGVOUT и DATA. Фиктивные многомерные массивы и хэши в стиле Perl 4 ("no multidimensional"). Например, указание "$hash{1, 2}" будет приводить к ошибке, нужно использовать промежуточный массив, например "$hash{join($;, 1, 2)}". Объявление прототипов в стиле Perl 4 (нужно использовать "use :prototype()"). В более отдалённых планах по умолчанию рассчитывают включить поддержку Unicode, что избавит разработчиков от указания "use utf8" в коде. Для модулей и скриптов, в которых возникнут проблемы с новыми настройками по умолчанию, предусмотрена возможность возвращения поведения Perl 5 через добавление в код строки "use compat::perl5". Отдельные настройки также сохранятся и их можно будет изменить по отдельности. Дополнение 1: Leon Timmermans выступил с критикой новой инициативы. Он не верит, что для Perl 7 возможно будет обеспечить линейный прогресс и вероятнее всего в итоге возникнет очередной затянувшийся форк, как было при переходе на Python 3. Ключевой проблемой является то, что /usr/bin/perl является инфраструктурой, которую нельзя ломать по тем же причинам, что и нарушать совместимость кода на shell и awk. На /usr/bin/perl завязано множество приложений, сборочных утилит и системных скриптов. Включение strict и отключение прототипов нарушит работу огромного числа существующих скриптов, поэтому маловероятно, что дистрибутивы когда-нибудь заменят /usr/bin/perl на perl7 и возникнет ситуация похожая на затянувшийся переход /usr/bin/python на python3. Кроме того, при создании Perl 7 упускается из виду, что Perl используется не только для написания больших приложений, но и востребован для однострочников, для которых использование "strict" лишено смысла. В конечном счёте спорен критерий хорошего кода, заявленный при анонсе Perl 7. Хороший код - это прежде всего код, который работает и решает возложенные на него задачи, а не только качественно оформленный код. Дополнение 2: Дэн Бук (Dan Book), поддерживающий более 70 модулей в CPAN, опубликовал результаты анализа рисков при воплощении предложенного плана внедрения Perl 7.