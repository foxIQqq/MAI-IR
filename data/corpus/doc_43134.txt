Релиз гипервизора Xen 4.6.0

После десяти месяцев разработки состоялся релиз свободного гипервизора Xen 4.6. По сравнению с прошлым выпуском в Xen 4.6 внесено более 2 тысяч изменений. Ключевые изменения в Xen 4.6: В libxc/libxl представлена полностью новая реализация Live-миграции (Migration v2), учитывающая особенности различных слоёв программного стека Xen, отличающаяся большей надёжностью и расширяемостью, а также лучшей поддержкой инфраструктур следующего поколения и работ, запланированных для будущих релизов гипервизора. Переработан инструментарий Remus для создания конфигураций высокой доступности, который теперь основан на наработках Migration v2; В Libxl обеспечена возможность отмены уже инициированных асинхронных операций, что позволяет пользователю безболезненно отменить длительно выполняемые параллельные работы, воспользоваться всеми преимуществами libvirt и упростить интеграцию со стеками оркестровки облачных систем; Улучшена поддержка протокола SPICE/QXL; Добавлена поддержка дисковых контроллеров AHCI; В основную кодовую базу добавлен инструмент Xenalyze для анализа буферов трассировки гипервизора, который может быть использован для оптимизации и отладки; Реализована поддержка новых возможностей выпусков ядра Linux с 3.18 по 4.3, в том числе поддержка бэкенда и фронтэнда Xen SCSI, поддержка ядер VPMU, увеличение производительности mmap, возможность адресовать в P2M более 512 Гб для паравиртуальных гостевых систем; Добавлена экспериментальная поддержка PVH Dom0/DomU на платформе FreeBSD. Удалены специфичный для FreeBSD классический порт i386 PV и неработающие расширения blkfront/back. Добавлена поддержка косвенного дескриптора Blkfront. Продолжается работа над поддержкой запуска гостевых систем на базе ARM32 и ARM64 во FreeBSD; Подсистема обработки связанных с памятью событий переработана в новую подсистему VM event, поддерживающую архитектуры ARM и x86. Подсистема VM event может быть использована для перехвата любых специфичных для виртуальной машины событий, таких как обращение к памяти и регистрам, что позволяет создавать приложения для инспектирования работы гостевых систем и средства мониторинга; Добавлена поддержка vTPM 2.0 (Virtual Trusted Platform Module), реализованная компаниями Intel и BitDefender; Значительно увеличена масштабируемость таблицы доступа (Grant table), что в некоторых конфигурациях привело к удвоению общей пропускной способности виртуальной сетевой подсистемы хоста и значительному повышению производительности драйверов ввода/вывода; Повышена эффективность механизма блокировок для улучшения работы крупных конфигураций, в которых на одном хосте запускаются сотни и тысячи виртуальных окружений; Прекращена поддержка неиспользуемого планировщика SEDF; Mini-OS выделен из кодовой базы в отдельное дерево исходных текстов и будет развиваться как отдельный проект; Компания Intel реализовала для Xen ряд новых технологий, специфичных для архитектуры x86: альтернативный P2M-фреймворк с новыми возможностями интроспекции и защиты VM; технологию журналирования IPML (Intel Page Modification Logging) для отслеживания обращения к страницам памяти при выполнении Live-миграции; систему индивидуальной настройки L3 кэша для VM; механизмы мониторинга пропускной способности памяти; инструменты для профилирования гипервизора; Доведена до полной функциональности реализация виртуальной системы NUMA для гостевых систем, работающих в режиме HVM; Внесена большая порция улучшений, связанных с архитектурой ARM: число поддерживаемых на платформах ARM64 виртуальных CPU увеличено с 8 до 128; добавлена поддержка проброса доступа к не-PCI устройствам; поддержка ARM GICv2 на GICv3; поддержка 32-разрядного пользовательского окружения на 64-разрядных гостевых системах; поддержка OVMF; поддержка ARM-платформ Renesas R-Car Gen2, Thunder X, Huawei hip04-d04 и Xilinx ZynqMP SoC; Представлен проект Raisin, предоставляющий инструментарий для сборки и формирования пакетов для развёртывания рабочих конфигураций Xen путём пересборки из исходных текстов и загрузки всех необходимых зависимостей, таких как Grub и Libvirt. Введена в строй система непрерывной интеграции для тестирования кода Xen в сочетании с компонентами OpenStack. Уровень качества поддержки Xen в OpenStack повышен с уровня С до уровня B.