Уязвимость в ядре Linux, позволяющая изменить содержимое tmpfs и разделяемой памяти

В ядре Linux выявлена уязвимость (CVE-2022-2590), позволяющая непривилегированному пользователю изменить отражённые в память файлы (mmap) и файлы в tmpfs, не имея прав на запись в них, и поднять свои привилегии в системе. По своему типу выявленная проблема напоминает уязвимость Dirty COW, но отличается тем, что ограничивается только воздействием на данные в разделяемой памяти (shmem / tmpfs). Эксплуатация проблемы может применяться для модификации запущенных исполняемых файлов, использующих разделяемую память. Проблема вызвана состоянием гонки в подсистеме управления памятью, возникающем при обработке исключения (fault), генерируемого при попытке доступа на запись к доступным только на чтение областям в разделяемой памяти, отражённым в режиме COW (copy-on-write mapping). Проблема проявляется начиная с ядра 5.16 на системах с архитектурой x86-64 и aarch64 при сборке ядра с опцией CONFIG_USERFAULTFD=y. Уязвимость устранена в выпуске 5.19. Пример эксплоита планируют опубликовать 15 августа. Дополнение: Опубликован прототип эксплоита.