Обновление GnuPG с устранением уязвимости, позволяющей восстановить закрытые RSA-ключи

Представлено корректирующее обновление пакета GnuPG 1.4.14 (GNU Privacy Guard) и библиотеки Libgcrypt 1.5.3 с реализацией компонентов, лежащих в основе механизмов шифрования, применяемых в GnuPG 2.0. В указанных выпусках устранена интересная уязвимость, позволяющая восстановить содержимое закрытого RSA-ключа другого пользователя многопользовательской системы, используя особенности помещения данных в совместно используемый L3-кэш. Суть метода сводится к определению содержимого кэша, полагаясь на различие времени доступа к прокэшированным и отсутствующим в кэше значениям. Атакующий добивается вытеснения участков кэша своими данными с последующим выявлением попадания в кэш сторонних данных на основе методов статистического анализа. В качестве эталона используется установленный в системе вариант программы gpg, который одинаков для атакующего и жертвы. При запуске нескольких копий, программы размещаются в памяти с использованием разделяемой памяти, с обработкой изменяемых данных в отдельных страницах, но с попаданием в кэш сходным образом (зная как размещена программа в памяти, атакующий может на основе оценки изменения времени доступа попытаться подобрать данные из не разделяемых страниц памяти). Представленная техника атаки позволяет восстановить более 98% битов закрытого ключа при проведении в системе каждого цикла дешифровки данных или формирования цифровой подписи. В отличие от ранее известных атак, представленный метод не требует привязки выполнения на одном ядре CPU шифрующего кода и кода злоумышленника, так как L3-кэш разделяется между всеми процессорными ядрами. Более того, атака может применяться и в виртуализированных окружениях, в которых злоумышленник может атаковать GnuPG-сеанс, выполняемый в другой гостевой системе. Несмотря на то, что отдельного корректирующего обновления GnuPG 2.0 не выпущено, проблема также затрагивает ветку GnuPG 2.0.x, для пользователей которой выпущено обновление Libgcrypt 1.5.3 (в ветке GnuPG 2.0.x базовая логика шифрования вынесена в отдельную библиотеку).