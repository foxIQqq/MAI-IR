Релиз Proxmox VE 6.1, дистрибутива для организации работы виртуальных серверов

Состоялся релиз Proxmox Virtual Environment 6.1, специализированного Linux-дистрибутива на базе Debian GNU/Linux, нацеленного на развертывание и обслуживание виртуальных серверов с использованием LXC и KVM и способного выступить в роли замены таких продуктов, как VMware vSphere, Microsoft Hyper-V и Citrix XenServer. Размер установочного iso-образа 776 Мб. Proxmox VE предоставляет средства для развёртывания полностью готовой системы виртуальных серверов промышленного уровня с управлением через web-интерфейс, рассчитанный на управление сотнями или даже тысячами виртуальных машин. Дистрибутив имеет встроенные инструменты для организации резервного копирования виртуальных окружений и доступную из коробки поддержку кластеризации, включая возможность миграции виртуальных окружений с одного узла на другой без остановки работы. Среди особенностей web-интерфейса: поддержка безопасной VNC-консоли; управление доступом ко всем доступным объектам (VM, хранилище, узлы и т.п.) на основе ролей; поддержка различных механизмов аутентификации (MS ADS, LDAP, Linux PAM, Proxmox VE authentication). В новом выпуске: Пакетная база синхронизирована с Debian 10.2. Ядро Linux обновлено до версии 5.3. Дополнительно поставляется ядро Linux 5.0 на основе пакетов из Ubuntu 19.04 с поддержкой ZFS. Обновлены версии Ceph Nautilus 14.2.4.1, Corosync 3.0, LXC 3.2, QEMU 4.1.1 и ZFS 0.8.2; Изменения в веб интерфейсе Через графический интерфейс теперь можно редактировать больше параметров конфигурации уровня датацентра, включая настройки двухфакторной аутентификации и ограничение пропускной способности на уровне кластера для следующих типов трафика: миграция, резервное копирование/восстановление, клонирование, перемещение диска. Улучшения в двухфакторной аутентификации, позволяющие использовать аппаратный ключ TOTP. Мобильный графический интерфейс: реализован вход в систему для учётных записей пользователей с поддержкой двухфакторной аутентификации TOTP. Продолжена работа по преобразованию пиктограмм из растровых в векторизованные форматы из Font Awesome. Режим масштабирования noVNC теперь можно изменить в разделе «Мои настройки». Новая кнопка «Выполнить сейчас» для запуска заданий резервного копирования всего кластера. При наличии установленного ifupdown2 теперь можно изменить конфигурацию сети и обновить её из графического интерфейса, без перезагрузки. Изменения для контейнеров Реализованы ожидающие (pending) изменения для контейнеров. Можно внести изменения для запущенного контейнера, и они будут применены после следующей перезагрузки контейнера. Перезагрузка работающего контейнера через GUI, API и из интерфейса командной строки (CLI). Горячее подключение точек монтирования с помощью нового API монтирования, доступного в ядре Linux 5.3. Поддержка последних выпусков дистрибутивов GNU/Linux, таких как Fedora 31, CentOS 8 и Ubuntu 19.10. Изменения в SPICE Аудиоустройства теперь могут быть добавлены через графический интерфейс (нет необходимости редактировать файл конфигурации). Каталоги теперь могут быть разделены между клиентом SPICE и виртуальной машиной (эта возможность пока считается экспериментальной). Можно включать поддержку потокового видео, что помогает улучшить производительность при выводе быстро меняющихся областей отображения, например, при просмотре видео. USB-устройство SPICE теперь поддерживает USB3 (QEMU >= 4.1). Улучшения в функциях резервного копирования и восстановления Виртуальные машины с включенными в настройках IOThreads теперь могут быть зарезервированы. Возможен ручной запуск запланированных заданий резервного копирования из датацентра в графическом интерфейсе. Улучшения в стеке HA Новая политика выключения «migrate». Если включить её при завершении работы, запущенные сервисы будут перенесены на другой узел. Как только узел возвращается в строй, и, если сервисы за это время не были вручную перемещены на другой узел, службы будут перемещены назад. Новая команда 'crm-command stop'. Выключает виртуальную машину/контейнер с указанным временем ожидания и выполняет полную остановку (hard stop), если время ожидания указано «0». Команда остановки виртуальной машины или контейнера теперь будет вызывать эту новую crm-command. Улучшения QEMU Разрешены домены, отличные от '0000', для PCI(e) passthrough. Новый вызов API «reboot». Позволяет применять ожидающие изменения, не дожидаясь выключения гостя, прежде чем запускать его снова. Устранена проблема таймаута монитора QEMU, которая препятствовала успешному резервному копированию в определённых конфигурациях. PCI(e) passthrough поддерживает до 16 устройств PCI(e). Поддержка QEMU Guest Agents, использующих для связи последовательный порт ISA (не VirtIO), что, среди прочего, позволит использовать QEMU Guest Agents в FreeBSD. Общие улучшения для виртуальных гостевых систем В конфигурации гостевых систем добавлены «теги». Эта метаинформация может быть полезна для таких вещей, как управление конфигурацией (пока не поддерживается в GUI). VM/CT: «Purge» научилась удалять соответствующую виртуальную машину или контейнер из заданий репликации, или резервного копирования при уничтожении. Стабильность кластера В апстриме выявлен и исправлен ряд ошибок (в сотрудничестве с corosync и kronosnet). Устранены проблемы, с которыми некоторые пользователи сталкивались при изменении MTU. pmxcfs прошёл аудит с использованием ASAN (AddressSanitizer) и UBSAN (Undefined Behavior Sanitizer), в результате исправлены различные возможные проблемы для определённых пограничных случаев. Система хранения Разрешена настройка нестандартных свойств «точки монтирования» для ZFS. Разрешено применение файлов .img в качестве альтернативы образам .iso. Различные улучшения iSCSI. Переработана поддержка ZFS на iSCSI с target-провайдером LIO. Обеспечена поддержка всех функций, предлагаемых более новыми ядрами с Ceph и KRBD. Различные улучшения В межсетевой экран добавлена поддержка raw-таблиц и использование их для защиты от Synflood-атак. Реализовано автоматическое продление самоподписанного сертификата за 2 недели до истечения срока действия. Сокращён срок действия вновь сгенерированных сертификатов (2 года вместо 10 лет). Изменение внесено так как некоторые современные браузеры жалуются на очень длительный срок действия сертификата. Проведена вычитка частей документации (стиль и грамматика). Расширена документация для администрирования Ceph. Многочисленные исправления ошибок и обновления пакетов (все детали смотрите в bugtracker и GIT-репозитории).