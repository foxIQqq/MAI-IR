Уязвимость в SMT/Hyper-Threading, позволяющая определить ключи шифрования чужих процессов

Группа исследователей из Университета технологий в Тампере (Финляндия) и Гаванского технологического университета (Куба) продемонстрировали уязвимость (CVE-2018-5407) в технологии одновременной многопоточности (SMT или Hyper-Threading) на примере процессоров Intel. Уязвимость получила кодовое имя PortSmash и позволяет при наличии непривилегированного доступа к системе определить информацию, обрабатываемую в ходе выполнения чужих процессов, что может использоваться, например, для извлечения ключей шифрования. Разработанный исследователями прототип эксплоита (zip) позволяет определить содержимое закрытого ключа P-384 на TLS-сервере, использующем OpenSSL. Для успешной эксплуатации уязвимости процесс атакующего должен выполняться на том же физическим ядре CPU, что и процесс жертвы. Атака успешно опробована на процессорах на базе микроархитектуры Intel Skylake и Kaby Lake в окружении Ubuntu 18.04. Уязвимость в OpenSSL была исправлена в выпусках 1.1.0i и 1.1.1. Детальное описание этой уязвимости пока не опубликовано, сообщается лишь то, что применяется упомянутая выше атака по сторонним каналам, анализирующая изменение времени выполнения операций для мониторинга за выполнением другого процесса. Атака манипулирует утечкой сведений в процессе совместного использования логическими процессорами механизма выполнения арифметико-логических операций (Execution Engine) при активном режиме Hyper-Threading. Уязвимость в общих чертах напоминает исследованную 13 лет назад проблему CVE-2005-0109, но новая атака никак не связана с подсистемой памяти и кэшированием.