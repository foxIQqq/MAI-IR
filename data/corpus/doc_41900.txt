Для PostgreSQL подготовлен инструмент ресинхронизации pg_rewind

В состав будущего выпуска СУБД PostgreSQL 9.5 будет включен новый полезный инструмент pg_rewind, позволяющий существенно упростить процесс восстановления отказоустойчивых конфигураций серверов, после переключения на резервный сервер. В настоящее время при выходе из строя основного сервера некоторые транзакции могут не успеть перенестись на запасной сервер, в случае использования асинхронной репликации. После возвращения в строй основного сервера возникает задача синхронизации его состояния с продолжившим работу запасным сервером, который успел накопить свою порцию изменений. После восстановления работы первичного сервера его начинка обычно создаётся заново, с помощью взятия копии с работающего резервного сервера - запасной сервер переводится в состояние заморозки БД для бэкапа, а содержимое директории с данными переносится на основной сервер. При этом не успевший реплицироваться хвост теряется, а процесс копирования крупных БД занимает достаточно много времени. Утилита pg_rewind пытается восстановить состояние первичного сервера по WAL-логу транзакций, перебирая их начиная с момента незадолго до сбоя, определяя изменённые данные и перенося только изменившиеся блоки. Изменения накатываются начиная с последней зафиксированной на основном сервере транзакции.