Обновление X.Org Server 21.1.4 с устранением уязвимостей

Доступен корректирующий выпуск X.Org Server 21.1.4, в котором устранены две уязвимости в обработчиках расширения Xkb, позволяющие поднять свои привилегии в системе, если X-сервер выполняется с правами root, или выполнить код на удалённой системе, если для доступа используется перенаправление сеанса X11 при помощи SSH. Уязвимости вызваны отсутствием корректной проверки размера в обработчиках запросов ProcXkbSetGeometry (CVE-2022-2319) и ProcXkbSetDeviceInfo (CVE-2022-2320), которые можно эксплуатировать для записи в область памяти за границей выделенного буфера. В случае ProcXkbSetGeometry отсутствовала проверка размера полей запроса, что позволяло клиенту вызвать переполнение, указав в запросе число секций, не соответствующее фактически отправленным данным. В обработчике ProcXkbSetDeviceInfo уязвимость вызвана неверным порядком вызова функций - функция для проверки параметров вызывалась после функции, в которой эти параметры использовались (были перепутаны названия функций и функция XkbSetDeviceInfo включала код для проверки, а XkbSetDeviceInfoCheck - для выставления значений). Дополнение: Рассмотренные уязвимости также устранены в выпуске XWayland 22.1.3, DDX-компонента (Device-Dependent X), обеспечивающего запуск X.Org Server для организации выполнения X11-приложений в окружениях на базе Wayland.