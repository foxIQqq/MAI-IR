Локальная root-уязвимость в ядре Linux

Компания Qualys раскрыла информацию об уязвимости (CVE-2018-14634) в ядре Linux. Проблема вызвана целочисленным переполнением в функции create_elf_tables() и проявляется на 64-разрядных системах, имеющих более 32 Гб ОЗУ. Локальный атакующий может эксплуатировать уязвимость через исполняемый файл с флагом SUID root для получения полноценных root-привилегий в системе. Вызывающая проблему ошибка была внесена в ядро в июле 2007 года вместе с кодом для поддержки аргументов переменной длины. Около года назад в ядро было принято исправление, ограничивающее размер стека для аргументов exec(). Данное исправление блокирует возможность эксплуатации уязвимости, но некоторые дистрибутивы не портировали его в свои длительно поддерживаемые пакеты с ядром. Например, проблема затрагивает ядро, поставляемое в Red Hat Enterprise Linux 6 и 7, Ubuntu 12.04 и Debian 8. Уязвимость эксплуатируется через запуск при помощи функции execve() suid-файла с передачей ему очень большого числа аргументов (около 16 миллиардов). Для успешной атаки в системе должно быть как минимум 32GB свободной оперативной памяти. Код прототипов эксплоитов доступен в открытом доступе. Кроме того, в ядре выявлена уязвимость (CVE-2018-14633), затрагивающая код iscsi target. Проблема вызвана ошибкой в функции chap_server_compute_md5() и позволяет записать 17 байт вне границ стека через отправку специального запроса авторизации от ISCSI initiator. Проблема не проявляется на системах с RHEL-7/x86_64. Для совершения атаки требуется, чтобы в системе был активен ISCSI target.