Уязвимость в подсистеме ядра Linux Netfilter

В ядре Linux выявлена уязвимость (CVE-2022-1966, CVE-2022-32250), позволяющая локальному пользователю получить права root в системе. Заявлено о подготовке эксплоита, демонстрирующего получение root-привилегий в Ubuntu 22.04. Для включения в ядро предложен патч с устранением проблемы (дополнение: патч принят в ядро). Уязвимость вызвана обращением к уже освобождённой области памяти (use-after-free) при манипуляции с set-списками при помощи команды NFT_MSG_NEWSET в модуле nf_tables. Для проведения атаки требуется наличие доступа к nftables, который можно получить в отдельном сетевом пространстве имён (network namespaces) при наличии прав CLONE_NEWUSER, CLONE_NEWNS или CLONE_NEWNET (например, при возможности запуска изолированного контейнера). Дополнение: Опубликован детальный разбор техники эксплуатации уязвимости.