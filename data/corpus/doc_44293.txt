Проблемы с изоляцией в Ubuntu Snap при работе в окружении X11

Мэттью Гаррет продемонстрировал наличие в Ubuntu Snap проблем, сводящих на нет заявленные достоинства технологии, связанные с изоляцией приложений от остальной системы. Мэттью удалось создать snap-пакет, который при установке в полностью обновлённом окружении Ubuntu 16.04 LTS позволяет перехватить ввод других X11-программ, запущенных в основной системе или других snap-окружениях. Кроме того, вредоносное snap-приложение имеет возможность осуществить подстановку своего ввода и выполнить действия вне изолированного окружения, например, выдав горячую клавишу открытия терминала и передав в него любые команды, такие как вызов утилиты curl для отправки ssh-ключей пользователя на внешний сервер. Следует отметить, что проблема не специфична для системы Snap и проявляется в любых других изолированных окружениях, обращающихся к внешнему X-серверу. Именно поэтому в системах изоляции не открывается доступ к X11, а используется отдельная прослойка Xnest. Например, по этой причине система изоляции настольных приложений xdg-app обязательно требует использования Wayland для своей работы. В Qubes OS для обхода проблемы в каждой виртуальной машине используется отдельный X-сервер, не пересекающихся с X-серверами других виртуальных машин. Из-за особенностей протокола X11 любое приложение может получить доступ ко всем событиям ввода и осуществить подстановку фиктивных нажатий клавиш, что позволяет без выхода из изолированного окружения передать любые клавиатурные комбинации в активные окна других приложений. При работе snap-пакетов в окружениях Wayland и Mir проблема отсутствует.