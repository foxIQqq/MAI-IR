Релиз Firefox 61

Состоялся релиз web-браузера Firefox 61, а также мобильной версии Firefox 61 для платформы Android. Кроме того, сформировано обновление веток с длительным сроком поддержки 52.9.0 и 60.1.0. В ближайшее время на стадию бета-тестирования перейдёт ветка Firefox 62, релиз которой намечен на 5 сентября. Основные новшества: На платформах Windows и Linux включён механизм ускорения перехода между открытыми вкладками, работающий через упреждающую отрисовку содержимого, не дожидаясь явного клика на вкладке. При подведении курсора к вкладке браузер осуществит отрисовку в буфер композитинга и в случае клика мгновенно выведет уже готовое содержимое на экран, устраняя задержку на отрисовку видимых областей; В движке Quantum CSS реализована техника оптимизации "Retained Display Lists" для ускорения отрисовки страниц. Метод базируется на изменении обработки списка отображаемых на экране высокоуровневых элементов страницы (окантовка, фоновая заливка, текст и т.п.), отсортированных в соответствии с правилами CSS для определения перекрытия элементов и видимости частей страницы на экране. Ранее при каждом обновлении экрана список полностью перестраивался, что с одной стороны значительно упрощало реализацию, но с другой стороны с ростом разрешений экрана и сложности сайтов возрастали накладные расходы, при том, что по статистике в 40% случаях перерисовывались почти идентичные кадры. В новой версии обеспечено сохранение списка между перерисовками с генерацией нового сокращённого списка, охватывающего только изменённые части страницы. После формирования сокращённого списка выполняется операция его слияния со старым полным списком. Во многих случаях новый список изменённых элементов существенно меньше исходного полного списка, что позволяет добиться заметного повышения производительности, несмотря на общее усложнение алгоритма. Тестирование показало, что после внесения оптимизации время на полный цикл отрисовки в среднем сократилось на 33%, а частота вызова операций отрисовки уменьшилась на 40%; В Quantum CSS также обеспечено распараллеливание операций парсинга CSS-файлов, помимо ранее реализованного режима параллельной обработки разобранных CSS-стилей; API WebExtension расширен средствами для скрытия вкладок, которые позволяют реализовать расширения для сворачивания и группировки вкладок (см. пример на скринкасте). Для тех, кому не хватает удалённой функциональности Tab Groups предложено дополнение Panorama View; Добавлена экспериментальная поддержка нового web-сервиса Firefox Monitor и связанного с ним встроенного дополнения , позволяющего проверить наличие email в базе скомпрометированных учётных записей, а также подписаться на вывод уведомления в случае появления сведений о компрометации в будущем. Проверка осуществляется через интеграцию с базой данных проекта haveibeenpwned.com, включающей сведения о более чем 5 миллиардах учётных записей, похищенных в результате взломов 289 сайтов. Метод проверки является анонимным и основан на передаче префикса SHA-1 хэша от email (несколько первых символов), в ответ на который сервер выдаёт соответствующие запросу хвосты хэшей из своей базы, а браузер на своей стороне сверяет их с имеющимся полным хэшем и в случае совпадения выдаёт предупреждение (полный хэш не передаётся). Дополнение будет предложено для тестирования ограниченному числу пользователей Firefox (предположительно в тестировании примут участие 250 тысячей пользователей, преимущественно в США); Появилась возможность добавления поисковых систем через контекстное меню адресной строки. Если сайт предоставляет плагин OpenSearch, в меню теперь выводится соответствующее приглашение добавить новую поисковую систему; Улучшена поддержка тёмной темы оформления, обеспечено её сочетание со всеми элементами интерфейса Firefox; Упрощён обмен ссылками в версии Firefox для macOS - в меню адресной строки появилась возможность отправки URL страницы в активной вкладке; Улучшена система синхронизации закладок; Добавлена новая отдельная секция настроек (about:preferences#home) для управления содержимым домашней страницы и страницы новой вкладки. Настройки также доступны через пиктограмму в виде шестерёнки на странице новой вкладки; Включено несколько оптимизаций для увеличения скорости запуска: добавлена настройка browser.startup.blankWindow для отображения пустого окна как можно раньше с последующим заполнением, API для работы со списками блокировки переведён на асинхронный режим работы, в ContentPrefs задействован Sqlite.jsm. При запуске Firefox теперь оценивает время запуска и в случае слишком медленного старта выдаёт подсказку со ссылкой на страницу с обзором типового решения проблем с производительностью (сброс настроек); Встроена поддержка изменчивых шрифтов OpenType (variable fonts), в которых толщина, ширина и другие стилистические характеристики глифа могут произвольно меняться. Для управления начертанием изменчивых шрифтов добавлены новые CSS-свойства font-weight, font-stretch и font-style, а также унифицированное свойство @font-face; Включена по умолчанию поддержка последнего чернового варианта спецификации TLS 1.3; Запрещена загрузка ресурсов по протоколу FTP из страниц, открытых по HTTP/HTTPS. Прямое открытие URL "ftp://" в адресной строке по-прежнему допустимо; Добавлена поддержка Cookie-атрибута SameSite, который можно использовать для блокирования CSRF-атак. При помощи SameSite можно разрешить отправку Cookie только в ответ на запросы, инициированные с сайта, с которого эти Cookie изначально были получены. Запросы, отправленные с URL, который не совпадает адресом назначения, будут уходить без выставленных для целевого сайта Cookie. Атрибут SameSite может принимать два значения ‘strict’ или ‘lax’. В режиме 'strict' Cookie будут удерживаться от отправки любых видов межсайтовых запросов. В режиме 'lax' будут применяться более мягкие ограничения и передача Cookie будет блокироваться только для межсайтовых субзапросов, таких как запрос изображения или загрузка контента через iframe; Кнопка "Forget", доступная в интерфейсе кастомизации, теперь приводит к очистке всех Service Workers и связанного с ними кэша; Добавлены новые JavaScript-методы String.prototype.trimStart() и String.prototype.trimEnd() для удаления пробелов в начале или конце строки; Добавлен API PerformanceServerTiming, предоставляющий доступ к метрикам производительности сервера, переданным через HTTP-заголовок "Server-Timing"; В CSS-свойстве "flex-basis" добавлена поддержка параметра "content" для включения автоматического выбора размера блока на основе фактического размера содержимого; В CSS реализована поддержка псевдокласса ":host"; Добавлена поддержка расширенного синтаксиса CSS-свойства overflow с двумя значениями (например, "overflow: hidden visible;" эквивалентно "overflow-x: hidden; "overflow-y: visible;"); DOM-свойства anchors, applets, embeds, forms, head, images, links, plugins и scripts перенесены из интерфейса HTMLDocument в Document; Добавлено новое DOM-свойство Request.destination, возвращающее тип запрошенного контента (например, "document", "manifest", "image", "worker", "audioworklet" и т.п.); В инструменты для web-разработчиков добавлена система инспектирования применения на странице средств для людей с ограниченными возможностями (Accessibility inspector). Включено по умолчанию новое оформление web-консоли - Browser Console и Browser Toolbox. Старый интерфейс консоли удалён; Изменено оформление основной панели инструментов для web-разработчиков, которое адаптировано для комфортной работы на слишком узких или широких экранах. Вкладки любых панелей инструментов теперь могут перемещаться мышью и группироваться по желанию пользователя, который может собрать в одном месте коллекцию из наиболее часто используемых инструментов; В режиме инспектирования для просмотра переменных CSS теперь достаточно подвести курсор и параметры будут отображены на всплывающей подсказке. Так же добавлена поддержка автодополнения переменных CSS c наглядным отображением значений цветов; В инструментах для web-разработчиков в режиме инспектировния сети появилось новое меню для урезания пропускной способности с целью симуляции открытия страниц через низкоскоростные каналы связи. Ранее данная возможность была доступна только в Responsive Design Mode. В интерфейс инспектирования сети также добавлены кнопки для быстрого сохранения и импорта HTTP-запросов в формате HAR (HTTP Archive). На панель добавлена новая вкладка Cache с информацией об уже ранее прокэшированных ресурсах; В версии для платформы Android проведена оптимизация прокрутки экрана и устранена проблема, приводившая к краху на устройстве Samsung Galaxy S8 при использовании платформы Android 8.0 (Oreo); Кроме новшеств и исправления ошибок в Firefox 61 устранено 52 уязвимости, из которых 39 помечены как критические (3 одиночных, 9 под CVE-2018-5186, 10 под CVE-2018-5187 и 17 под CVE-2018-5188), т.е. потенциально могут привести к выполнению кода злоумышленника при открытии специально оформленных страниц.