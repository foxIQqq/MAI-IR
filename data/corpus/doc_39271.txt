Разработчики systemd представили механизм автоматического монтирования разделов на основе GPT-меток

В списке рассылки разработчиков systemd представлена реализация автоматического обнаружения и монтирования разделов, основанная на идентификаторах типов разделов, используемых в разметке GUID Partition Table (GPT). Такой подход в перспективе позволяет отказаться от использования файла /etc/fstab в некоторых ситуациях. Формат разметки диска GPT является современной альтернативой классическому методу разметки, основанному на сохранении таблицы разделов в главной загрузочной записи (MBR). Существенным преимуществом формата GPT является поддержка жестких дисков объемом до 9.4 зетабайт, в то время как MBR-разметка ограничивается 2.2 терабайтами. Кроме того, формат GPT, в отличие от MBR, полностью совместим с EFI-системами. Предложенный разработчиками systemd механизм основан на 16-байтовых идентификаторах типов разделов, используемых в таблице разделов формата GPT. Например, раздел подкачки идентифицируется как 0657FD6D-A4AB-43C4-84E5-0933C84B4F4F. В отличие от уникальных идентификаторов разделов (UUID), идентификаторы типов известны заранее. Это позволяет автоматически обнаруживать и монтировать разделы, основываясь на их типе. В частности, в настоящий момент systemd поддерживает автоматическое обнаружение корневого раздела, /boot (загрузочный EFI-раздел), /home, /srv и разделов подкачки. Эта функция реализована при помощи двух специальных модулей, systemd-auto-gpt-generator и systemd-efi-boot-generator. На ранних этапах загрузки они анализируют таблицы разделов всех доступных дисков и создают соответствующие юниты, описывающие точки монтирования и устройства подкачки. Механизм обнаружения раздела автоматически отключается, если монтирование в данную точку было уже настроено вручную (через /etc/fstab или юнит-файл), а также в том случае, если каталог, в который производится монтирование, не пуст. Если в системе имеется несколько разделов одного типа, используется первый из найденных (за исключением разделов подкачки, количество которых не ограничивается). Такой подход упрощает установку и администрирование систем в некоторых ситуациях, в частности, при наличии нескольких установленных Linux-систем, использующих общие разделы с информацией пользователей (/home) и системных демонов (/srv), а также разделы подкачки. Кроме того, значительно упрощается работа с live-системами и образами виртуальных контейнеров, которые теперь могут подключать разделы без дополнительной настройки. В простейших случаях, например, при наличии одного корневого раздела и одного раздела /home, становится возможным полностью отказаться от использования файла /etc/fstab. В более сложных ситуациях, требующих дополнительных настроек, рекомендуется, как и раньше, использовать /etc/fstab или юнит-файлы. Автоматическое обнаружение некоторых других типов разделов, в частности, /var и /usr, поддерживать не планируется, так как содержимое этих разделов сильно обусловлено спецификой дистрибутивов, и их совместное использование несколькими установленными дистрибутивами Linux весьма проблематично.