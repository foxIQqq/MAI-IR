Обновление Tor 0.4.5.16 и 0.4.7.13 с устранением уязвимости, связанной с утечкой DNS-запросов

Опубликованы корректирующие выпуски инструментария Tor 0.4.5.16 и 0.4.7.13, используемого для организации работы анонимной сети Tor. В новой версии устранена уязвимость, связанная с нарушением работы защиты от утечки DNS-запросов через локальный резолвер при подключении клиента через SOCKS4. Tor Browser не использует SOCKS4, поэтому проблема его не касается. При установке в torrc параметра "SafeSocks 1" в Tor включается режим блокирования запросов, в которых фигурируют IP-адреса вместо имён хостов, так как подобные запросы могут свидетельствовать, что домен открытого через Tor сайта уже определён локальным резолвером, а не полностью транслирован через Tor (т.е. владелец прописанного в параметрах системы DNS-сервера может узнать к какому домену обращался пользователь через Tor). Уязвимость вызвана ошибкой из-за которой проверка настройки SafeSocks при использовании SOCKS4 инвертировалась и защита не применялась в то время, как пользователь считал, что он защищён от утечек через DNS. Утечка через локальный резолвер происходила при использовании SOCKS4 в приложениях, не поддерживающих SOCKS4a (расширение, принимающее запросы с именами доменов вместо IP), или в приложениях, поддерживающих SOCKS4a, но откатывающихся до SOCKS4 после выдачи Tor-ом ошибки. Кроме устранения уязвимости в выпуске Tor 0.4.7.13 также устранена недоработка в коде управления перегрузкой, которая могла повлиять на работу клиентов и операторов выходных узлов. На платформе Linux реализована поддержка флага IP_BIND_ADDRESS_NO_PORT для релеев, использующих настройку OutboundBindAddress. Также разработчики напоминают, что поддержка ветки 0.4.5.x будет прекращена 15 февраля и пользователям следует обновить свои системы до ветки 0.4.7.x.