Уязвимости в QoS-подсистеме ядра Linux, позволяющие поднять свои привилегии в системе

В ядре Linux выявлены две уязвимости (CVE-2023-1281, CVE-2023-1829), позволяющие локальному пользователю поднять свои привилегии в системе. Для проведения атаки требуются полномочия на создание и изменение классификаторов трафика, доступные при наличии прав CAP_NET_ADMIN, которые можно получить при возможности создания пространств имён идентификаторов пользователя (user namespace). Проблемы проявляются начиная с ядра 4.14 и устранены в ветке 6.2. Уязвимости вызваны обращением к памяти после её освобождения (use-after-free) в коде классификаторе трафика tcindex, входящего в состав подсистемы QoS (Quality of service) ядра Linux. Первая уязвимость проявляется из-за состояния гонки при обновлении неоптимальных hash-фильтров, а вторая уязвимость при удалении оптимального hash-фильтра. Проследить за исправлением в дистрибутивах можно на следующих страницах: Debian, Ubuntu, Gentoo, RHEL, SUSE, Fedora, Arch. Для блокирования эксплуатации уязвимости обходным путём можно отключить возможность создания пространств имён непривилегированными пользователями ("sudo sysctl -w kernel.unprivileged_userns_clone=0").