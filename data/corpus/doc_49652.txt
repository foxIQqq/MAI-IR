Разработан метод атаки на DRAM-память, позволяющий обойти защиту ECC

Группа исследователей из Амстердамского свободного университета разработала (PDF) усовершенствованный вариант атаки RowHammer, позволяющей изменить содержимое отдельных битов в памяти на базе чипов DRAM, для защиты целостности в которых применяются коды коррекции ошибок (ECC). Атака может быть выполнена удалённо при наличии непривилегированного доступа к системе. Напомним, что уязвимость RowHammer позволяет исказить содержимое отдельных битов памяти путём цикличного чтения данных из соседних ячеек памяти. Так как память DRAM представляет собой двухмерный массив ячеек, каждая из которых состоит из конденсатора и транзистора, выполнение непрерывного чтения одной и той же области памяти приводит к флуктуации напряжения и аномалиям, вызывающим небольшую потерю заряда соседних ячеек. Если интенсивность чтения достаточно большая, то ячейка может потерять достаточно большой объём заряда и очередной цикл регенерации не успеет восстановить её первоначальное состояние, что приведёт к изменению значения сохранённых в ячейке данных. До сих пор использование ECC считалось наиболее надёжным способом защиты от вышеописанных проблем, но исследователям удалось разработать метод изменения заданных битов памяти, не приводящий к срабатыванию механизма коррекции ошибок. Метод может применяться на серверах с ECC-памятью для модификации данных, подстановки вредоносного кода и изменения прав доступа. Например, в ранее продемонстрированных RowHammer-атаках при наличии у злоумышленника доступа к виртуальной машине инициировалась загрузка вредоносных системных обновлений через изменение в процессе apt имени хоста для загрузки и модификации логики проверки цифровой подписи. Обход ECC основан на особенностях коррекции ошибок: если изменён один бит - ECC откорректирует ошибку, если два бита - будет сгенерировано исключение и программа будет принудительно завершена, но в случае одновременного изменения трёх битов ECC может не заметить модификации. Для определения условий при которых проверка ECC не срабатывает разработан похожий на состояние гонки метод проверки, позволяющий оценить возможность совершения атаки для конкретного адреса в памяти. Метод основывается на факте, что при исправлении ошибки возрастает время чтения и возникающая задержка вполне измерима и заметна. Атака сводится к последовательным попыткам изменить каждый бит по отдельности, определяя успешность изменения возникновением задержки, вызванной корректировкой ECC. Таким образом выполняется поиск машинных слов с тремя изменяемыми битами. На последнем этапе необходимо добиться, чтобы три изменяемые бита в двух местах были разными, после чего попытаться за один проход изменить их значение. Исследователи успешно продемонстрировали возможность атаки на четырёх разных серверах с памятью DDR3 (теоретически уязвима и память DDR4), три из которых были укомплектованы процессорами Intel (E3-1270 v3, Xeon E5-2650 v1, Intel Xeon E5-2620 v1 ), а один - AMD (Opteron 6376). При этом отмечается, что поиск необходимого сочетания битов в лабораторных условиях на неактивном сервере занимает около 32 минут. Совершить атаку на работающем сервере значительно труднее из-за наличия помех, возникающих в процессе активности приложений. На рабочих системах для поиска необходимого сочетания изменяемых бит может потребоваться до одной недели. Итоговый вывод сводится к тому, что ECC полностью не исключает проведение атаки RowHammer, но существенно замедляет и усложняет её. Для выявления попыток совершения атаки администраторам многопользовательских систем рекомендуется включить в логах отображение фактов коррекции ошибок ECC и настроить мониторинг связанной с ними активности.