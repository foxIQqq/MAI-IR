Использование JavaScript для атаки через манипуляцию с содержимым буфера обмена

Появление в JavaScript средств для копирования и изменения данных в буфере обмена открыло двери для организации нового вида атаки по подстановке дополнительных команд при вставке данных в терминал из буфера обмена. В отличие от ранее предложенной атаки, основанной на размещении невидимого блока "span", новая атака подменяет данные силами JavaScript, отслеживая событие копирования из текущего окна браузера в буфер обмена - определив нажатие Ctrl+C, скрипт ожидает 800 мс и осуществляет добавление дополнительных данных в буфер обмена. При этом браузер не запрашивает у пользователя подтверждения операции по изменению содержимого буфера обмена, а копируемая строка в представлении HTML соответствует строке на экране. Метод также предоставляет более простой способ подстановки в буфер обмена спецсимволов и шестнадцатеричных последовательностей (например, "\x1b"), которые могут применяться для атаки на vim. В демонстрационном примере предлагается скопировать из окна браузера в буфер обмена строку (выделить и нажать Ctrl+C): echo "not evil" при вставке которой в терминал будет выведена совсем иная последовательность: echo "evil"\n Для скрытия лишнего ввода можно использовать команду "clear" или "echo -ne '\033[1F\033[2K'", например, в данном примере будет выполнено: touch ~/.evil clear echo "not evil"