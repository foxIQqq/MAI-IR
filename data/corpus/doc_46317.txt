В Android и старых ядрах Linux устранена уязвимость, эксплуатируемая через отправку UDP-пакетов

В апрельском обновлении платформы Android в сетевой подсистеме ядра Linux устранена критическая уязвимость (CVE-2016-10229), потенциально позволяющая выполнить код на уровне ядра, отправив специально оформленный набор UDP-пакетов, который приводит к двойному вычислению контрольной суммы в процессе выполнения системного вызова recv с флагом MSG_PEEK. Ошибка, вызвавшая уязвимость, была устранена больше года назад в выпусках основного ядра Linux 4.5 и 4.4.21, поэтому проблеме подвержены только старые версии ядра, меньше 4.4.21. Для эксплуатации требуется наличие серверного приложения, читающего данных из сокета с флагом MSG_PEEK (помечает данные непрочитанными и они будут опять выданы при следующем вызове recv()). Уязвимость не проявляется в Debian и SUSE, но вероятно присутствует в openSUSE 42.1. Уязвимость не проявляется в актуальных поддерживаемых ветках Ubuntu и Ubuntu Touch. Проблема была исправлена в RHEL 7.3 и в ядре 3.10.0.327.el7 для 7.2, ядро из RHEL 6 подвержено уязвимости. Кроме уязвимости в UDP-стеке и уже ранее упомянутых проблем в беспроводном стеке Broadcom и crypto-движке Qualcomm, в апрельском обновлении Android также устранено шесть критических уязвимостей в медиасервере, позволяющих организовать выполнение кода с правами процесса mediaserver при обработке специально оформленного контента, а также критические уязвимости в драйвере MediaTek, драйвере сенсорных экранов HTC, в подсистеме ядра ION и в различных компонентах Qualcomm. Опасные уязвимости, позволяющие поднять свои привилегии в системе, устранены в CameraBase, Audioserver, SurfaceFlinger, libskia, v8, Freetype, звуковой подсистеме ядра, различных драйверах MediaTek, Broadcom, Qualcomm и NVIDIA. Дополнительно можно отметить заявление о наличии в платформе Tizen около 40 неисправленных 0-day уязвимостей. Информация пока не подтверждена и представлена в виде голословных заявлений, данных исследователем безопасности Amihai Neiderman в интервью изданию Motherboard. Не ясно в каких компонентах выявлены уязвимости (судя по всему речь ведётся о проблемах в прикладных приложениях и специфичных дополнениях Samsung) и насколько эти уязвимости эксплуатируемы. В материале упоминается повсеместное использование в коде функции strcpy(), передача данных с сервисов Samsung без шифрования, удалённо эксплуатируемые уязвимости в приложении TizenStore, позволяющие получить контроль над устройством. Дополнение: разработчики Tizen скептически отнеслись к заявлению, так как только она из отмеченных в презентации проблем непосредственно имеет отношение к платформе Tizen.