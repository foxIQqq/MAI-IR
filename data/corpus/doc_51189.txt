11 удалённо эксплуатируемых уязвимостей в TCP/IP стеке VxWorks

Исследователи безопасности из компании Armis раскрыли информацию об 11 уязвимостях (PDF) в TCP/IP стеке IPnet, используемом в операционной системе VxWorks. Проблемам присвоено кодовое имя "URGENT/11". Уязвимости могут быть эксплуатированы удалённо через отправку специально оформленных сетевых пакетов, в том числе для некоторых проблем возможно совершение атаки при доступе через межсетевые экраны и NAT (например, если атакующий контролирует сервер DNS, к которому обращается размещённое во внутренней сети уязвимое устройство). Шесть проблем могут привести к выполнению кода злоумышленника при обработке некорректно выставленных опций IP или TCP в пакете, а также при разборе пакетов DHCP. Пять проблем являются менее опасными и могут привести к утечке информации или совершению DoS-атак. Раскрытие информации об уязвимостях скоординировано с компанией Wind River - в опубликованном на прошлой неделе последнем выпуске VxWorks 7 SR0620 проблемы уже устранены. Так как каждая уязвимость затрагивает разные части сетевого стека, проблемы могут быть специфичны для определённых выпусков, но утверждается, что в каждой версии VxWorks начиная с 6.5 проявляется хотя бы одна уязвимость, позволяющая добиться удалённого выполнения кода. При этом для каждого варианта VxWorks необходимо создание отдельного эксплоита. По оценке компании Armis проблема затрагивает около 200 млн устройств, среди которых промышленное и медицинское оборудование, маршрутизаторы, VOIP-телефоны, межсетевые экраны, принтеры и различные устройства интернета вещей. Компания Wind River считает, что данная цифра завышена и проблема охватывает лишь относительно небольшое число некритичных устройств, которые, как правило, ограничены внутренней корпоративной сетью. Сетевой стек IPnet поставлялся лишь в некоторых редакциях VxWorks, включая выпуски, поддержка которых уже прекращена (до 6.5). В устройствах на базе платформ VxWorks 653 и VxWorks Cert Edition, применяемых в критически важных областях (промышленные роботы, автомобильная и авиационная электроника), проблемы не проявляются. Представители Armis считают, что из-за сложности обновления подверженных уязвимостям устройств не исключено появление червей, поражающих локальные сети и в массовом порядке атакующих наиболее популярные категории уязвимых устройств. Например, некоторые устройства, такие как медицинское и промышленное оборудование, при обновлении прошивки требуют проведения повторной сертификации и длительного тестирования, что затрудняет обновлением в них прошивок. Wind River полагает, что в таких случаях риск компрометации можно снизить включением уже имеющихся встроенных средств обеспечения безопасности, таких как неисполняемый стек, защита от переполнения стека, ограничение системных вызовов и изоляция процессов. Защита может быть обеспечена и через добавление блокирующих атаки сигнатур на межсетевых экранах и системах предотвращения вторжений, а также через ограничение сетевого доступа к устройству только внутренним периметром безопасности.