Критическая уязвимость в Samba

Представлены корректирующие выпуски Samba 4.1.3, 4.0.13 и 3.6.22, в которых устранены две уязвимости, одна из которых помечена как критическая. Критическая уязвимость (CVE-2013-4408) выявлена в процессе внутреннего аудита, общественно доступных рабочих эксплоитов пока не зафиксировано. Проблеме подвержены все выпуски samba, начиная с samba 3.4.0, в том числе уже не поддерживаемые ветки 3.4.x и 3.5.x, для который выпущены отдельные патчи. Проблема вызвана некорректной проверкой размера фрагмента DCE-RPC, что позволяет инициировать переполнение буфера при обработке специально оформленных пакетов DCE-RPC на стороне клиента samba. В том числе уязвимость может быть применена для эксплуатации процесса winbindd, который обычно применяется на системах, подключенных к домену Active Directory, и использует в своей работе проблемный клиентский код. Успешная атака против системы с winbindd, проведённая со стороны подконтрольного злоумышленникам контроллера домена Active Directory или через транзитное внедрение в трафик в результате MITM-атаки (man-in-the-middle), позволяет добиться выполнения кода злоумышленника с правами пользователя root. Дополнительно отмечается наличие похожей проблемы в серверном коде веток 3.4 и 3.5, но вектор атаки для серверной проблемы ограничен вызовом отказа в обслуживании в результате краха серверного процесса. Аналогичные проверки размера также были пропущены в вызовах LookupSids (lsa, samr), LookupNames (lsa, samr) и LookupRids (samr), что может привести к появлению похожих проблем. Вторая уязвимость (CVE-2012-6150), проявляется в Winbind и позволяет пропустить ошибку при задании дополнительных ограничений, заданных для логинов через PAM с использованием параметра require_membership_of, который определяет список групп или SID в которые обязательно должен входить пользователь. Суть уязвимости в том, что некорректные имена групп игнорируются без предупреждения или блокирования входа. Проблема проявляется в Samba 3.3.10, 3.4.3, 3.5.0 и более новых выпусках, при указании неверного имени группы в require_membership_of.