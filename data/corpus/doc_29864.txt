На соревновании Pwn2own 2011 взломаны Safari и IE, браузеры Firefox и Chrome устояли

Завершился первый день соревнований Pwn2own по взлому типичных программных окружений, проводимых ежегодно в рамках конференции CanSecWest. В рамках соревнования были продемонстрированы успешные атаки на систему через взлом браузеров Safari и Internet Explorer 8. Попытки взлома браузера Chrome не увенчались успехом, несмотря на учреждение компанией Google дополнительного приза в размере 20 тыс. долларов, который планировалось вручить любому участнику, продемонстрировавшему способ эксплуатации системы через взлом web-браузера Chrome. Соревнования по взлому браузера Firefox и телефонов на базе платформ iPhone, Blackberry OS, Android и Windows Phone 7 будут проведены в ближайшие часы, итоги пока не известны. Среди факторов, помешавших взлому, Chrome называется грамотная организация многоуровневой защиты и изоляции подсистем браузера. Реализованные методы защищают от эксплуатации уязвимостей в html или JavaScript движке. Тем не менее, за историю существования Chrome было найдено несколько критических проблем, как правило, связанных с уязвимостями в мультимедиа системах. За день до проведения конкурса компания Google выпустила обновление браузра Chrome 10, в котором было устранено 23 уязвимости, среди которых не было критических проблем. В процессе атаки на Safari и Internet Explorer 8 взлом был произведен через ранее неизвестные уязвимости (zero-day). Браузеры и операционные системы были самых последних версий с наложением всех доступных патчей. Взлом считался удачным только после обхода всех дополнительных механизмов защиты операционной системы, таких как DEP (Data Execution Prevention) и ASLR (Address Space Layout Randomization), и итогового выполнения своего кода в системе. Детали взлома браузеров по условиям соревнований будут оставаться в тайне до момента выпуска официальных обновлений. При взломе Safari использовалась последняя версия браузера 5.0.3, запущенная в операционной системе Mac OS X 10.6.6, на которую был наложен полный комплект всех доступных патчей. Взлом был продемонстрирован представителями французской фирмы VUPEN, специализирующейся на компьютерной безопасности. Для организации атаки оказалось достаточным открыть в браузере специально подготовленную страницу. Для демонстрации выполнения своего кода в процессе эксплуатации уязвимости был организован запуск системного калькулятора, а для демонстрации обхода ограничений изолированного окружения было произведено создание файла на диске. В процессе взлома Safari была задействована уязвимость в подсистеме рендеринга страниц, но основные трудности при написании эксплоита были связаны с обходом механизмов защиты ASLR и DEP. Сами по себе методы обхода данных механизмов давно известны, но трудности были связаны с их адаптацией для используемой в конкурсе 64-разрядной сборки Safari, что потребовало разработки с нуля дополнительных инструментов для проведения атаки. Примечательно, что непосредственно перед началом соревнований компания Apple выпустила обновление web-браузера Safari 5.0.4, в котором было исправлено 60 уязвимостей. Взлом Internet Explorer 8 был произведен Стивеном Фьюэром (Stephen Fewer) из организации Harmony Security. В процессе атаки использовалась 32-разрядная версия браузера, запущенная на 64-разрядной системе Windows 7 Service Pack 1. Повторив историю со взломом Safari, после открытия специально оформленной web-страницы Стивен Фьюэр организовал запуск калькулятора и записал файл на диск. В процессе эксплуатации были задействованы три различные уязвимости: две для запуска кода в контексте браузера и одна для обхода механизма защиты Protected Mode sandbox. На разработку техники атаки Internet Explorer ушло 5-6 недель, а Safari - 2 недели работы группы экспертов VUPEN. Для сравнения, для выявления уязвимости в браузере Safari в рамках проведения первого конкурса pwn2own в 2007 году было потрачено 5 часов, а для написания рабочего эксплоита - 4 часа, что свидетельствует о прогрессе в обеспечении защиты браузеров. Внедрение таких техник защиты, как ASLR и DEP, существенно усложнило процесс эксплуатации уязвимостей, но, как видно по результатам конкурса, полностью не исключило возможности проведения атак. Дополнение: Завершился второй день соревнования Pwn2own, на котором успешно были взломаны только телефоны iPhone и BlackBerry. Атаки на платформы Android и Windows Phone 7 не принесли результата. Что касается Firefox, то попытка по его взлому не удалась - конкурсант взял самоотвод, пояснив свой поступок нестабильностью работы созданного эксплоита. Завтра будут известны результаты третьего дня конкурса.