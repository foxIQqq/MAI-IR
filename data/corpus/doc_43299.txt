Уязвимость в вымогательском ПО для Linux/FreeBSD свела стойкость шифрования на нет

Исследователи лаборатории Bitdefender проанализировали недавно анонсированное вымогательское вредоносное ПО Linux.Encoder.1, осуществляющее шифрование данных на серверах с Linux и FreeBSD, и нашли в нём серьёзный промах в организации процесса шифрования, позволяющий расшифровать данные без получения приватного ключа RSA. Результаты анализа послужили основой для написания Python-скрипта, автоматизирующего расшифровку и восстановление данных. Напомним, что метод сокрытия данных Linux.Encoder.1 сводится к генерации ключа для алгоритма симметричного шифрования AES, шифрование файлов при помощи AES, а затем шифровании ключа AES при помощи открытого ключа на основе асимметричного алгоритма RSA. Таким образом, для того чтобы расшифровать конечные файлы необходимо знать ключ для алгоритма AES, который зашифрован методом RSA, а для расшифровки требуется получить закрытый ключ RSA. Алгоритм AES применяется для конечных файлов в силу высокой производительности, в то время как RSA ограничивается только шифрованием ключей AES из-за большой ресурсоёмкости. Суть ошибки разработчиков вредоносного ПО в том, что для генерации ключа AES, они использовали в качестве генератора случайных чисел rand(3) из libc, причём инициализированный по-умолчанию, то есть текущим системным временем (текущим - на момент шифрования данных). Время начала шифрования легко выясняется по времени последней модификации файлов. Оставленной информации оказалось достаточно для восстановления исходного ключа AES и позволило обойтись без дешифровки ключа с использованием метода RSA. Кроме того, стали известны подробности поражения серверов вредоносным шифровальщиком. Linux.Encoder.1 проникал в систему эксплуатируя уязвимость в платформе электронной коммерции Magento, позволяющую атакующему выполнить произвольный PHP-код на сервере.