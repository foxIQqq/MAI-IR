Выпуск GnuPG 2.2.17 с изменениями для противостояния атаке на серверы ключей

Опубликован релиз инструментария GnuPG 2.2.17 (GNU Privacy Guard), совместимого со стандартами OpenPGP (RFC-4880) и S/MIME, и предоставляющего утилиты для шифрования данных, работы с электронными подписями, управления ключами и доступа к публичным хранилищам ключей. Напомним, что ветка GnuPG 2.2 позиционируется как развивающийся выпуск, в котором продолжают добавляться новые возможности, в ветке 2.1 допускаются только корректирующие исправления. В новом выпуске предложены меры для противостояния атаке на серверы ключей, приводящей к зависанию GnuPG и невозможности дальнейшей работы до удаления проблемного сертификата из локального хранилища или пересоздания хранилища сертификатов на основе проверенных открытых ключей. Добавленная защита построена на полном игнорировании по умолчанию всех сторонних цифровых подписей сертификатов, полученных с серверов хранения ключей. Напомним, что любой пользователь может добавить на сервер хранения ключей свою цифровую подпись для произвольных сертификатов, что используется злоумышленниками для создания для сертификата жертвы огромного числа таких подписей (более сотни тысяч), обработка которых нарушает нормальную работу GnuPG. Игнорирование сторонних цифровых подписей регулируются опцией "self-sigs-only", которая допускает загрузку для ключей только собственных подписей их создателей. Для восстановления старого поведения в gpg.conf может добавить настройку "keyserver-options no-self-sigs-only,no-import-clean". При этом если в процессе работы фиксируется импортирование числа блоков, которое вызовет переполнение локального хранилища (pubring.kbx), GnuPG вместо вывода ошибки автоматически включает режим игнорирования цифровых подписей ("self-sigs-only,import-clean"). Для обновления ключей c использованием механизма Web Key Directory (WKD) добавлена опция "--locate-external-key", которую можно использовать для пересоздания хранилища сертификатов на основе проверенных открытых ключей. При выполнении операции "--auto-key-retrieve" механизм WKD теперь является более предпочтительным, чем серверы ключей. Суть работы WKD заключается в размещении открытых ключей в web c привязкой к домену, указанному в почтовом адресе. Например, для адреса "test@example.com" ключ может быть загружен через ссылку "https://example.com/.well-known/openpgpkey/hu/183d7d5ab73cfceece9a5594e6039d5a".