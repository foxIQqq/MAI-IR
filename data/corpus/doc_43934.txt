Уязвимость MouseJack позволяет получить контроль над системами, использующими беспроводные мыши

Исследователи из компании Bastille Networks разработали новый вид атаки, позволяющей на расстоянии до ста метров получить контроль над беспроводными мышами, работающими на частоте 2.4GHz, и симулировать ввод любых клавиатурных комбинаций. Атака получила название MouseJack и охватывает большинство моделей беспроводных мышей, использующих собственные проприетарные протоколы для обмена данными (атака не затрагивает устройства, работающие через Bluetooth). В том числе атаке подвержены беспроводные устройства ввода от компаний Logitech, HP, Dell, Gigabyte, Microsoft и Lenovo. Обновления с устранением проблем пока выпущены только компанией Logitech. Выпуск исправления для дешёвых моделей устройств под вопросом, так как у некоторых мышей не предусмотрен механизм обновления прошивки. Суть атаки в недостаточной защите протокола, используемого при обмене данными между компьютером и мышью. Если для беспроводных клавиатур все данные шифруются для избежания перехвата пользовательского ввода, то специфичные для мышей команды передаются без использования шифрования и не требуют аутентификации, что позволяет атакующему находясь на расстоянии до 100 метров вклиниться в канал связи и путём генерации специально оформленных пакетов организовать выполнение произвольных действий мышью. Главная проблема состоит в том, что в силу унификации протокола незашифрованные команды от мыши можно использовать не только для отправки данных о кликах, но и для передачи сведений о клавиатурных комбинациях, т.е. можно симулировать ввод с клавиатуры. Воспользовавшись данной возможностью, атакующий может получить полный контроль над системой пользователя. При создании экспериментального прототипа исследователям удалось добиться подстановки ввода со скоростью до 1000 слов в минуту. Для установки руткита на систему пользователя оказалось достаточно 10 секунд. В зависимости от производителя и используемой модификации протокола разработано девять основных методов атаки, в числе которых отправка фиктивных HID-пакетов, подстановка нажатий клавиш, сопряжение дополнительной мыши или клавиатуры и симуляция фиктивной мыши или клавиатуры. В качестве передатчика могут выступать работающие на частоте 2.4 GHz недорогие программируемые беспроводные USB-адаптеры, основанные на чипах Nordic Semiconductor nRF24LU1+, которые также используются в подключаемом к компьютеру брелоке для большинства беспроводных мышей и клавиатур. Прошивка и набор утилит для совершения атаки опубликованы на GitHub. В состав инструментария включены утилита для обнаружения беспроводных клавиатур и мышей, сниффер для декодирования пакетов и определитель сетевого адреса.