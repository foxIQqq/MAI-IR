В ядре Linux 3.3 появится новая реализация механизма изменения размера Ext4 на лету

Ted Ts'o опубликовал список планируемых к включению в ядро Linux 3.3 патчей для файловой системы Ext4, который, кроме многочисленных мелких доработок и исправлений ошибок, включает в себя новую реализацию механизма изменения размера ФС, работающую в пространстве ядра. Механизм был разработан Yongqiang Yang и представлен ещё 8 ноября 2011 года в виде патча. В отличие от существующей в настоящее время системы изменения размера, он полностью реализован в ядре, а потому работает намного быстрее. В тестах производительности он значительно обогнал прошлую реализацию, позволив изменить размер файловой системы, с 20 Гб до 230 Гб за 3.3 секунды, вместо более чем 5 минут, которые понадобились утилите resize2fs. Для выполнения изменения размера в ядро был добавлен новый ioctl EXT4_IOC_RESIZE_FS. Общий размер нового кода составил около 1000 строк.