Intel устранил удалённую уязвимость в технологии AMT (Active Management Technology)

Компания Intel сообщила об устранении критической уязвимости, позволяющей непривилегированному атакующему получить доступ к функциям удалённого управления оборудованием. Проблема затрагивает серверные системы с чипами, предоставляющими независимые интерфейсы Intel Active Management Technology (AMT), Intel Standard Manageability (ISM) и Intel Small Business Technology (SBT), применяемые для мониторинга и управления оборудованием. Утверждается, что уязвимость проявляется в версиях прошивок с 6 по 11.6 включительно. Персональные компьютеры на чипах Intel проблеме не подвержены. Описывается два возможных вектора атаки - сетевой и локальный. При сетевой атаке злоумышленник может получить привилегии для управления системой через AMT и ISM (сетевые порты 16992 и 16993, проброс на которые осуществляется автоматически без обработчика на уровне ОС), а при локальной атаке доступ можно получить через локальное обращение к интерфейсам AMT, ISM и SBT. В обычных условиях вход в интерфейс AMT защищён паролем, но рассматриваемая уязвимость позволяет получить доступ без пароля. Атака возможна только при явном включении AMT, а для локальной атаки непривилегированным пользователем в системе должны быть активированы специальные драйверы. Детали о методе эксплуатации пока остаются неопубликованными. Интерфейс AMT позволяет получить доступ к функциям управления питанием, мониторингу трафика, изменению настроек BIOS, обновлению прошивок, очистке дисков, удалённой загрузке новой ОС (эмулируется USB-накопитель с которого можно загрузиться), перенаправлению консоли (Serial Over LAN и KVM по сети) и т.д. Предоставляемых интерфейсов достаточно для проведения атак, применяемых при наличии физического доступа к системе, например, можно загрузить Live-систему и внести из неё изменения в основную систему. В настоящее время сервис Shodan находит около 7 тысяч хостов с открытыми сетевыми портами 16992 и 16993, что относительно немного. Для пользователей, которые не имеют возможность установить обновление прошивки подготовлено руководство с описанием обходных путей решения проблемы. В частности для блокирования удалённых атак рассказано как отключить обработку сетевых запросов (перевод в состояние UnConfigure), а для защиты от проведения локальных атак указано как отключить сервисы LMS (Local Manageability Service, применяются на серверах под управлением Windows). Определить наличие поддержки AMT из Linux можно командной 'lspci| grep -E "MEI|HECI"', если один из данных контроллеров присутствует, то следует убедиться в BIOS (ctrl+p при загрузке), что он не активирован. Напомним, что современные чипсеты Intel оснащены отдельным микропроцессором Management Engine, работающим независимо от CPU и операционной системы. На Management Engine вынесено выполнение задач, которые необходимо отделить от ОС, такие как обработка защищённого контента (DRM), реализации модулей TPM (Trusted Platform Module) и низкоуровневые интерфейсы для мониторинга и управления оборудованием. Примечательно, что Фонд СПО несколько лет назад предупреждал о потенциальных проблемах с безопасностью в Management Engine и признавал не соответствующим критериям обеспечения приватности и свободы пользователей. Кроме того, Йоанна Рутковская (Joanna Rutkowska) развивала проект по созданию ноутбука, не сохраняющего состояние (stateless), для обеспечения блокировки скрытого доступа к информации пользователя из аппаратных компонентов, подобных Management Engine. Дополнение от 5 мая: Раскрыты детали эксплуатации уязвимости. Из-за ошибки в коде проверки маски при аутентификации методом HTTP Digest, вход в интерфейс AMT возможен при указании пользователя "admin" и любого пароля, если в браузере настроена работа через прокси (например, "127.0.0.1:16992"). Суть проблемы в том, что для проверки корректности параметров аутентификации используется функция strncmp(), в которой по ошибке в поле размера сравниваемой строки, указана длина переданного пользователем параметра "response=", а не исходных данных аутентификации. Таким образом, если пользователем не переданы данные, то осуществляется выполнение операции вида strncmp(a,b,0), которая вернёт значение TRUE. Например: Authorization: Digest username="admin", realm="Digest:048A0000000000000000000000000000", nonce="qTILAAUFAAAjY7rDwLSmxFCq5EJ3pH/n", uri="/index.htm", response="", qop=auth, nc=00000001, cnonce="60513ab58858482c"