Дистрибутив Fedora 33 перешёл на стадию бета-тестирования

Началось тестирование бета-версии дистрибутива Fedora 33. Бета-выпуск ознаменовал переход на финальную стадию тестирования, при которой допускается только исправление критических ошибок. Релиз запланирован на конец октября. Выпуск охватывает Fedora Workstation, Fedora Server, Fedora Silverblue, Fedora IoT и Live-сборки, поставляемые в форме спинов c десктоп-окружениями KDE Plasma 5, Xfce, MATE, Cinnamon, LXDE и LXQt. Сборки подготовлены для архитектур x86_64, ARM (Raspberry Pi 2 и 3), ARM64 (AArch64) и POWER. Наиболее значимые изменения в Fedora 33: Все варианты дистрибутива для рабочего стола (Fedora Workstation, Fedora KDE и т.п.) переведены на использование по умолчанию файловой системы Btrfs. Применение встроенного менеджера разделов Btrfs позволит решить проблемы с исчерпанием свободного дискового пространства при раздельном монтировании каталогов / и /home. При Btrfs данные разделы можно будет поместить в два подраздела, монтируемые раздельно, но использующие общее дисковое пространство. Btrfs также позволит использовать такие возможности, как снапшоты, прозрачное сжатие данных, корректную изоляцию операций ввода/вывода через cgroups2, изменение размера разделов на лету. Рабочий стол Fedora Workstation обновлён до выпуска GNOME 3.38, в котором проведена оптимизация производительности, предложен вводный интерфейс (Welcome Tour) со сведениями об основных возможностях GNOME, расширены средства родительского контроля, предоставлена возможность назначения разных частот обновления экрана для каждого монитора, добавлена опция для игнорирования подключения неавторизированных USB-устройств во время блокировки экрана. В состав Fedora Workstation добавлен новый фоновый процесс uresourced, использующий cgroup для предоставления гарантированных ресурсов активному графическому сеансу пользователя. За активным пользователем закрепляется 250МБ неотбираемой памяти (но не больше 10% от системной памяти) и включаются контроллеры cgroup для CPU и ввода/вывода для гарантирования того, что у процессов в активном сеансе останутся необходимые ресурсы для сохранения нормальной отзывчивости интерфейса в случае нехватки памяти в системе или запуска fork-бомб. В поставку Fedora Workstation по умолчанию добавлен Thermald для отслеживания параметров температурных датчиков и защиты CPU от перегрева во время пиковых нагрузок. По умолчанию включены анимированные обои рабочего стола, в которых в зависимости от времени суток меняется цвет. Вместо vi по умолчанию предложен текстовый редактор nano. Изменение обусловлено желанием сделать дистрибутив более доступным для новичков, предоставив редактор, которым сможет пользоваться любой пользователь, не имеющий специальных знаний о методах работы в редакторе Vi. При этом в базовом составе сохранена поставка пакета vim-minimal (прямой вызов vi сохранился) и предоставлена возможность изменения редактора по умолчанию на vi по желанию пользователя. В число официальных редакций дистрибутива принят вариант для интернета вещей (Fedora IoT), который теперь поставляется наравне с Fedora Workstation и Fedora Server. Редакция Fedora IoT базируется на тех же технологиях, что применяются в Fedora CoreOS, Fedora Atomic Host и Fedora Silverblue, и предлагает урезанное до минимума системное окружение, обновление которого производится атомарно через замену образа всей системы, без разбивки на отдельные пакеты. Для контроля целостности применяется заверение всего системного образа цифровой подписью. Для отделения приложений от основной системы предлагается использовать изолированные контейнеры (для управления применяется podman). Системное окружение Fedora IoT формируется с использованием технологии OSTree, при которой системный образ атомарно обновляется из Git-подобного хранилища, позволяющего применять методы версионного контроля к компонентам дистрибутива (например, можно быстро откатить систему к прошлому состоянию). RPM-пакеты транслируются в репозиторий OSTree при помощи специальной прослойки rpm-ostree. Готовые сборки предоставляются для архитектур x86_64, Aarch64 и ARMv7 (armhfp). Заявлена поддержка плат Raspberry Pi 3 Model B/B+, 96boards Rock960 Consumer Edition, Pine64 A64-LTS, Pine64 Rockpro64, Rock64 и Up Squared, а также виртуальных машин x86_64 и aarch64. В редакции Fedora с рабочим столом KDE по умолчанию активирован фоновый процесс earlyoom, который в прошлом выпуске был предложен в Fedora Workstation. Earlyoom позволяет более оперативно реагировать на нехватку памяти, не доходя до вызова обработчика OOM (Out Of Memory) в ядре, который срабатывает, когда ситуация становится критичной и система, как правило, уже не реагирует на действия пользователя. Если объём доступной памяти меньше меньше 4%, но не более 400 MiB, earlyoom принудительно завершит работу процесса, наиболее активно потребляющего память (имеющего самое большое значение /proc/*/oom_score), не доводя состояние системы до очистки системных буферов. Обновлены версии многих пакетов, включая RPM 4.16, Python 3.9, Perl 5.32, Binutils 2.34, Boost 1.73, Glibc 2.32, Go 1.15, Java 11, LLVM/Clang 11, GNU Make 4.3, Node.js 14, Erlang 23, LXQt 0.15.0, Ruby on Rails 6.0, Stratis 2.1.0. Прекращена поддержка Python 2.6 и Python 3.4. Для архитектуры aarch64 обеспечена поставка .NET Core. Прекращена поддержка модуля mod_php для http-сервера Apache, вместо которого для запуска web-приложений на языке PHP предложено использовать php-fpm. В пакете с Firefox для Fedora активирована поддержка аппаратного ускорения декодирования видео при помощи VA-API (Video Acceleration API) и FFmpegDataDecoder, которое включается в том числе в сеансах на базе технологии WebRTC, используемой в web-приложениях для проведения видеоконференций. Ускорение работает в окружениях на базе Wayland и X11 (при запуске "MOZ_X11_EGL=1 firefox" и включении настройки "media.ffmpeg.vaapi.enabled"). В сервере и клиенте синхронизации точного времени chrony и в инсталляторе включена поддержка механизма аутентификации NTS (Network Time Security). В Wine по умолчанию задействован бэкенд на основе прослойки DXVK, предоставляющей реализацию DXGI (DirectX Graphics Infrastructure), Direct3D 9, 10 и 11, работающую через трансляцию вызовов в API Vulkan. В отличие от встроенных в Wine реализаций Direct3D 9/10/11, работающих поверх OpenGL, DXVK позволяет добиться более высокой производительности при запуске 3D-приложений и игр в Wine. При сборке пакетов по умолчанию включены оптимизации на этапе связывания (LTO, Link Time Optimization). В redhat-rpm-config добавлена опция "-flto". В NetworkManager для хранения настроек вместо плагина ifcfg-rh задействован файл в формате keyfile. Для систем ARM64 включена сборка пакетов с применением аутентификации указателей (Pointer Authentication) и защиты от выполнения наборов инструкций, на которые не должны выполняться переходы при ветвлении (BTI, Branch Target Indicator). Указанные механизмы эффективны для защиты от атак, использующих приёмы возвратно-ориентированного программирования (ROP) при которых атакующий не пытается разместить свой код в памяти, а оперирует уже имеющимися в загруженных библиотеках кусками машинных инструкций, завершающихся инструкцией возврата управления. Проведена работа по упрощению реализации технологии выборочного показа загрузочного меню, при которой меню по умолчанию скрыто и показывается только после сбоя или активации опции в GNOME. Вместо создания традиционного раздела подкачки реализовано размещение подкачки (swap) с использованием блочного устройства zRAM, обеспечивающем хранение данных в ОЗУ в сжатом виде. Добавлен фоновый процесс SID (Storage Instantiation Daemon) для отслеживания состояния устройств в различных подсистемах хранения (LVM, multipath, MD) и вызова обработчиков при наступлении определённых событий, например, для активации и деактивации устройств. SID работает в виде надстройки над udev и реагирует на события от него, позволяя избавиться от создания усложнённых правил udev для взаимодействия с различными классами устройств и подсистем хранения, которые трудно сопровождать и отлаживать. База данных пакетов RPM (rpmdb) переведена с BerkeleyDB на SQLite. В качестве основной причины замены называется применение в rpmdb устаревшей версии Berkeley DB 5.x, которая уже несколько лет не сопровождается. Переходу на более новые выпуски мешает изменение лицензии Berkeley DB 6 на AGPLv3, требования которой распространяются и на приложения, использующие BerkeleyDB в форме библиотеки (RPM поставляется под GPLv2, а AGPL несовместима с GPLv2). Кроме того, текущая реализация rpmdb на основе BerkeleyDB не обеспечивает необходимой надёжности, так как не использует транзакции и не способна выявлять несоответствия в БД.