Обнаружена локальная root-уязвимость в 64-битных Linux-ядрах, выпущенных с 2008 года

В 2007 году была обнаружена уязвимость в 64-разрядных Linux-ядрах, которая позволяла непривилегированному локальному пользователю получить root-доступ к системе из-за небезопасной трансляции 32-битных вызовов. Ошибка на тот момент была исправлена и все про неё благополучно забыли. Ben Hawkes, который изначально нашёл эту уязвимость, недавно обнаружил, что проблема снова возникла в ядре в виду того, что в 2008 году из-за первоначального патча появилась регрессия и код был поправлен таким образом, что ядро снова стало уязвимо. Сделав небольшую правку изначального кода exploit'a, Ben Hawkes добился его работоспособности во всех свежих 64-битных Linux-ядрах. Таким образом, все свежие 64-битные ядра являются уязвимыми к локальной атаке, и в случае использования Linux для организации работы системы совместного доступа, например, для обеспечения работы хостинга, следует незамедлительно обновить Linux-ядро или временно запретить shell-доступ. Компания RedHat заявила, что ядра, поставляемые в дистрибутивах RHEL и CentOS версий только 3 и 4 (но не 5.x), не являются уязвимыми, так как проблемный патч d4d67150 не был принят. Информацию о появлении обновлений с исправлением уязвимости в других популярных Linux-дистрибутивах, можно узнать по следующим ссылкам: Ubuntu, Slackware, Gentoo, Mandriva, openSUSE, Fedora и Debian. Эксплоит для проверки подверженности системы вышеописанной уязвимости можно загрузить здесь (ВНИМАНИЕ ! Указанный эксплоит на деле сочетает в себе функции бэкдора). Кроме того, на днях в Linux-ядре обнаружены еще несколько менее серьезных уязвимостей: При вызове некоторыми функциями (например, "compat_mc_getsockopt()") процедуры "compat_alloc_user_space()" не осуществляется проверка корректности данных о возвращаемой области памяти, что может быть использовано для повреждения содержимого памяти ядра; Ошибка в коде проверки допустимости границ в функции "niu_get_ethtool_tcam_all()" из состава драйвера NIU, может привести к краху ядра или потенциальному выполнению кода на уровне ядра при отправке специально оформленного ETHTOOL_GRXCLSRLALL IOCTL. Проблеме подвержены только системы, использующие драйвер для Ethernet-адаптеров Sun Neptune (NIU). Проблема исправлена в выпуске 2.6.36-rc4; В реализации файловой системы XFS зафиксирована проблема, связанная с отсутствием очистки памяти перед передачей некоторых структур данных на пользовательский уровень. Используя ошибку, злоумышленник может получить доступ к некоторым закрытым областям памяти ядра через отправку XFS_IOC_FSGETXATTR IOCTL. Проблема устранена в ядре 2.6.36-rc4; В функциях "de4x5_ioctl()", "cxgb_extension_ioctl()", "eql_g_master_cfg()" и "hso_get_count()" найдены ошибки, приводящие к копированию неинициализированных областей памяти ядра, в которых могут содержать закрытые данные из области стека ядра. Проблема проявляется при отправке соответствующих IOCTL драйверам de4x5, cxgb, eql и hso.