Уязвимость в подсистеме ядра Linux perf, позволяющая поднять привилегии

В ядре Linux выявлена уязвимость (CVE-2022-1729), позволяющая локальному пользователю получить root-доступ к системе. Уязвимость вызвана состоянием гонки в подсистеме perf, которое можно использовать для инициирования обращения к уже освобождённой области памяти ядра (use-after-free). Проблема проявляется начиная с выпуска ядра 4.0-rc1. Возможность эксплуатации подтверждена для выпусков 5.4.193+. Исправление пока доступно только в форме патча. Опасность уязвимости сглаживает то, что большинство дистрибутивов по умолчанию ограничивают доступ к perf для непривилегированных пользователей. В качестве обходного пути защиты можно выставить sysctl-параметр kernel.perf_event_paranoid в значение 3.