Умные замки KeyWe оказались не защищены от перехвата ключа доступа

Исследователи безопасности из компании F-Secure проанализировали умные дверные замки KeyWe Smart Lock и выявили серьёзную уязвимость, позволяющую при помощи nRF-сниффера для Bluetooth Low Energy и Wireshark перехватить управляющий трафик и выделить из него секретный ключ, применяемый для открытия замка со смартфона. Проблему усугубляет то, что замки не поддерживают обновление прошивки и уязвимость будет устранена только в новой партии устройств. Существующие пользователи могут избавиться от проблемы только заменив замок или прекратив использовать смартфон для открытия двери. Замки KeyWe продаются по цене $155 и, как правило, используются в дверях частных домов и магазинов. Кроме обычного ключа, замок может быть открыт и электронным ключом через мобильное приложение на смартфоне или при помощи браслета с NFC-меткой. Для защиты канала связи, через который передаются команды с мобильного приложения, используется алгоритм AES-128-ECB, но ключ для шифрования формируется на основе двух предсказуемых ключей - общего ключа и дополнительного вычисляемого ключа, которые можно легко определить. Первый ключ формируется на основе параметров Bluetooth-соединения, таких как MAC-адрес, имя устройства и характеристики устройства. Алгоритм вычисления второго ключа можно определить через анализ мобильного приложения. Так как информация для формирования ключей изначально известна, то шифрование является лишь формальным, и для взлома замка достаточно определить параметры замка, перехватить сеанс открытия двери и выделить из него код доступа. Инструментарий для анализа канала связи с замком и определения ключей доступа опубликован на GitHub.