Опубликован инструментарий для дешифровки микрокода Intel

Группа исследователей безопасности из команды uCode опубликовала исходные тексты для дешифровки микрокода Intel. Для извлечения зашифрованного микрокода может использоваться техника Red Unlock, разработанная теми же исследователями в 2020 году. Предложенная возможность расшифровки микрокода позволяет исследовать внутреннюю структуру микрокода и методы реализаций машинных инструкций x86. Дополнительно, исследователями восстановлен формат обновлений с микрокодом, алгоритм шифрования и ключ, использованный для защиты микрокода (RC4). Для определения применяемого ключа шифрования была использована уязвимость в Intel TXE, при помощи которой удалось активировать недокументированный отладочный режим, которому исследователи присвоили кодовое имя "Red Unlock". В отладочном режиме напрямую из CPU удалось загрузить дамп с работающим микрокодом и выделить из него алгоритм и ключи. Инструментарий позволяет только дешифровать микрокод, но не даёт возможность его изменения, так как целостность микрокода допонительно проверяется при помощи цифровой подписи на основе алгоритма RSA. Метод применим к процессорам Intel семейства Gemini Lake на базе микроархитектуры Goldmont Plus и Intel Apollo Lake на базе микроархитектуры Goldmont.