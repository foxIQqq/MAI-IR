DRM-защита Widevine L3 полностью взломана

Исследователь по безопасности из Британии, Дэвид Бьюкенен (David Buchanan), успешно взломал технологию защиты аудио/видео контента Widevine третьего уровня, что позволяет получить полный дамп данных, передаваемых через защищённый DRM канал связи. Widevine разрабатывается компанией Google и применяется для распространения защищённого авторскими правами контента в Netflix, Disney, Amazon Video, BBC, HBO, Facebook, Hulu, Spotify и многих других сервисах. Для декодирования контента поставляется одноимённый CDM-модуль (Content Decryption Module), применяемый в Chrome, ChromeOS, Android и Firefox, а также в продуктах Samsung, Intel, Sony и LG. Widevine L3 - это самый слабый, почти полностью программный уровень защиты, поэтому компании-дистрибьюторы используют его только для распространения контента в относительно низком качестве (хуже, чем 1080p). Второй уровень (L2) подразумевает выполнение криптографических операций на стороне аппаратно изолированного TEE-окружения (Trusted Execution Environment, например, Intel SGX, ARM TrustZone и AMD PSP). При использовании первого уровня на сторону TEE выносится не только криптографические операции, но и функции обработки контента. Ошибка была найдена в реализации алгоритма шифрования Whitebox AES-128, который подвержен атаке DFA (Differential Fault Analysis), позволяющей получить доступ к ключу шифрования. Атака позволяет получить доступ к зашифрованным потокам звука и видео в формате MPEG-CENC, которые можно расшифровать и сохранить, используя, например, ffmpeg, не прибегая к усложнённым методам захвата на стадии вывода информации на экран. При этом найденный метод обхода DRM не предоставляет доступ к данным, обрабатываемым с помощью Widevine L1, ибо в этом случае используется специальная изолированная среда исполнения внутри процессора. Детальные сведения о методе проведения атаки переданы в компанию Google, но, по мнению исследователя, проблема не подлежит исправлению, так как она вызвана архитектурными особенностями Widevine L3.