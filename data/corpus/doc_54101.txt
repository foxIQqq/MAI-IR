Релиз Firefox 83

Состоялся релиз web-браузера Firefox 83. Кроме того, сформировано обновление ветки с длительным сроком поддержки 78.5.0. На стадию бета-тестирования перешла ветка Firefox 84, релиз которой намечен на 15 декабря. Основные новшества: По умолчанию включён новый JIT-компилятор, развивавшийся под кодовым именем Warp, который позволил заметно упростить архитектуру JIT, повысить отзывчивость, сократить время загрузки страницы и снизить потребление памяти. Проведённые тесты демонстрируют ускорение загрузки до 15%, повышение отзывчивости до 12% и снижение потребления памяти до 8%. Скорость прохождения теста Speedometer увеличилась на 10%. Тестирование на реальных сайтах показало сокращение времени загрузки Google Docs на 20%. Показатель SpeedIndex при открытии раздела Android в Reddit улучшился на 13%. Pdfpaint стал работать быстрее на 18%. Производительность JavaScript-движка увеличена в основном за счёт сокращения внутренней информации о типах, отслеживаемой внутри движка, и применению техники кэширования промежуточного кода (CacheIR), ранее предложенной в "baseline" интерпретаторе байткода, который занимает промежуточную нишу между обычным интерпретатором и предварительным JIT-компилятором. Warp также позволил избавиться от дополнительных накладных расходов для кода Baseline/C++, исключил лишние перекомпиляции, вынес формирование промежуточного кода MIR (Middle-level IR) из основного потока в отдельный поток, снизил потребление памяти за счёт прекращения хранения данных о типах и группах объектов (ObjectGroups). В разделе настроек "Конфиденциальность и безопасность" предложен режим "HTTPS Only", при включении которого все выполняемые без шифрования запросы автоматически перенаправляются на защищённые варианты страниц ("http://" заменяется на "https://"). Предусмотрена возможность включения данного режима для всех окон или только для окон, открываемых в режиме приватного просмотра. По умолчанию режим перенаправления на HTTPS находится в отключённом состоянии. Для отдельного сайта режим можно включить через меню, показываемое при клике на изображении щита в адресной строке. Если при включённом режиме проброс на https:// завершается таймаутом, пользователю показывается страница с ошибкой, на которой присутствует кнопка для выполнения запроса по http://. В случае сбоев при загрузке по "https://" cубресурсов, загружаемых при обработке страницы, подобные сбои игнорируются, но в web-консоль выводятся предупреждения, которые можно посмотреть через инструменты для web-разработчика. Активирован новый диалог web-аутентификации, не блокирующий другие вкладки. Форма ввода параметров аутентификации теперь привязана к конкретной вкладке и не блокирует весь интерфейс. Добавлена поддержка масштабирования страниц щипком. Функция пока доступна только для Windows-систем с сенсорными экранами и тачпадами, а также для систем с тачпадами на базе macOS. Добавлены горячие клавиши для быстрой перемотки видео, отображаемого в режиме "картинка в картинке". Для перемотки вперёд и назад с шагом в 15 секунд теперь достаточно нажать соответствующие клавиши управления курсором. Улучшен интерфейс, отображаемый при включении совместного доступа к экрану в процессе проведения видеоконференции в Firefox. В интерфейсе теперь более явно обозначено, к каким устройствам и экранам предоставлен совместный доступ. В адресной строке появилась возможность быстрого переключения на другую поисковую систему - список пиктограмм доступных поисковых систем теперь отображается в нижней части окна ещё до начала набора запроса (ранее список появлялся только после ввода первой буквы запроса). При клике на поисковой системе из списка, данная система становится активной и показывается перед полем ввода. Для того чтобы сразу начать поиск, как было раньше, нужно кликнуть на пиктограмме с нажатой клавишей Shift. Пользователю также предоставлена возможность определения произвольных псевдонимов для обращения к поисковым системам. Кроме того, доступна функция "Tab-to-search", позволяющая через нажатие клавиши Tab в адресной строке перейти в режим поиска с выбором активной поисковой системы на основе набранных символов, если автодополнением предложена одна из установленных поисковых систем. Например, набрав "ya" будет предложено "yandex.ru", после чего можно нажать Tab и будет включён режим набора запроса в Yandex. Переработан интерфейс встроенного просмотрщика PDF-документов (заменены пиктограммы, использован светлый фон для панели с инструментами). Добавлена поддержка механизма AcroForm для заполнения форм ввода и сохранения результирующего PDF с введёнными пользователем данными. Для пользователей из Индии в англоязычной сборке на странице новой вкладки добавлена секция со статьями, рекомендованными сервисом Pocket (ранее подобные рекомендации были предложены для пользователей из США, Германии, Австрии, Бельгии и Швейцарии и Великобритании). Связанная с подбором контента персонализация выполняется на стороне клиента и без передачи сведений о пользователе третьим лицам (в браузер загружается весь список рекомендованных ссылок на текущий день, который ранжируется на стороне пользователя, отталкиваясь от данных истории посещений). Для отключения рекомендованного Pocket контента предусмотрена настройка в конфигураторе (Firefox Home Content/Recommended by Pocket) и опция "browser.newtabpage.activity-stream.feeds.topsites" в about:config. Добавлено контекстное меню для вывода на печать выделенного фрагмента. Для устройств Apple, поставляемых с macOS Big Sur и оснащённых новыми CPU Apple, предоставлена возможность использования Firefox, применяя бинарный транслятор Rosetta 2. В следующих версиях планируется предоставить родные сборки для CPU Apple M1. В версии для macOS также обеспечено восстановление сеансов с минимизацией окон, позволяющей снизить потребление энергии. Для пользователей Windows 7/8/8.1 и macOS 10.12-10.15 активирован движок композитинга WebRender, написанный на языке Rust и позволяющий добиться существенного увеличения скорости отрисовки и снижения нагрузки на CPU за счёт выноса на сторону GPU операций отрисовки содержимого страницы, которые реализованы через выполняемые в GPU шейдеры. Таким образом, WebRender теперь включён для всех версий Windows и macOS (кроме 10.16 Beta). Для Linux в списке блокировки для WebRender остаются проприетарные драйверы NVIDIA, а также драйверы Intel при использовании экранных разрешений 3440x1440 и выше. На платформе Android движок WebRender включён для устройств с GPU Adreno 5xx (Google Pixel, Google Pixel 2/XL, Oneplus 5), Adreno 6xx (Google Pixel 3, Google Pixel 4, Oneplus 6), а также смартфонов Pixel 2 и Pixel 3. Пользователи бинарных драйверов NVIDIA в Linux, которые вручную включили WebRender (gfx.webrender.all=true в about:config) и не пользуются композитингом, могут столкнуться с регрессией, которая выражается в том, что верхняя половина экрана превращается в закрашенный прямоугольник. Решить проблему можно, либо включив композитинг, либо экспортировав любую из следующих переменных окружения: MOZ_GTK_TITLEBAR_DECORATION=system (к сожалению, она включает заголовок окна) или MOZ_X11_EGL=1 (эта опция выключает поддержку WebGL 2). Также можно отключить на время WebRender. Добавлена CSS-функция conic-gradient() для создания конусообразных градиентов, в которых изменение цвета производится вокруг центра, а не от центра к краю, что позволяет создавать эффекты в виде колеса меняющихся оттенков. В инструментах для web-разработчиков в интерфейсе инспектирования страниц предоставлена метка "scroll" для отладки прокручиваемых переполнений содержимого. При клике на значок на странице подсвечиваются элементы, приводящие к переполнению. В версии для платформы Android расширено число поддерживаемых дополнений. В число дополнений, которые можно использовать в Firefox для Android, включены FoxyProxy, Bitwarden, AdGuard AdBlocker, Tomato Clock, LeechBlock NG, Web Archives и Ghostery. Дополнительно можно отметить начало тестирования бета-версии Firefox 84, в которой на платформе Linux по умолчанию задействован движок композитинга WebRender для X11 и GNOME. Также реализована упреждающая загрузка сертификатов промежуточных удостоверяющих центров с использованием инфраструктуры Remote Settings, что позволит снизить число сообщений об ошибках при просмотре некорректно настроенных сайтов. Кроме новшеств и исправления ошибок в Firefox 83 устранена 31 уязвимость, из которых 14 помечены как опасные. 12 уязвимостей (собраны под CVE-2020-26969 и CVE-2020-26968) вызваны проблемами работы с памятью, такими как переполнения буферов и обращение к уже освобождённым областям памяти. Потенциально данные проблемы способны привести к выполнению кода злоумышленника при открытии специально оформленных страниц.