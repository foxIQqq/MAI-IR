Выпуск сканера сетевой безопасности Nmap 7.94

Опубликован выпуск сканера сетевой безопасности Nmap 7.94, предназначенного для проведения аудита сети и выявления активных сетевых сервисов. Код проекта поставляется под лицензией NPSL, основанной на лицензии GPLv2, которая дополнена рекомендациями по использованию программы OEM-лицензирования и покупке коммерческой лицензии, если производитель не желает открывать код своего продукта в соответствии требованиями копилефт-лицензии или намерен интегрировать Nmap в продукты, несовместимые с GPL. Основные изменения: GUI Zenmap и утилита Ndiff переведены на использование Python 3. В Zenmap для формирования графического интерфейса задействована библиотека PyGObject вместо PyGTK. Обновлены базы сигнатур для определения сетевых приложений и операционных систем. Добавлены 22 новых сигнатуры операционных систем, определяющие свежие версии Windows, iOS, macOS, Linux и BSD-систем. Общее число сигнатур доведено 5700. До версии 1.75 обновлена библиотека Npcap, применяемая для захвата и подстановки пакетов на платформе Windows. Библиотека развивается проектом Nmap в качестве замены WinPcap, построена с использованием современного Windows API NDIS 6 LWF и демонстрирует более высокую производительность, безопасность и надёжность. Обеспечен вывод имён производителей на основе MAC-адресов с префиксами MA-S (24-bit), MA-M (28-bit) и MA-L (36-bit). Ранее для определения производителя использовался только 3-байтовый префикс из MAC-адреса. В установщик для платформы Windows добавлена поддержка "тихого" режима установки (/S). Оптимизировано потребление памяти и повышена производительность кода для определения операционной системы, поиска имён сервисов, сопоставления и проверок повторной передачи. Сокращено время запуска. Добавлен новый NSE-скрипт tftp-version, запрашивающий у TFTP-сервера несуществующий файл и на основе текста ошибки определяющий название и версию tftp-сервера. В утилите Ncat разрешён приём "соединений" от нескольких хостов по UDP при использовании режима listen с опцией "--keep-open". Изменение позволяет использовать в Ncat режимы "--broker" и "--chat" через UDP. В готовых сборках обновлены версии библиотек OpenSSL 3.0.8, zlib 1.2.13, Lua 5.4.4, libpcap 1.10.4. Режимы сканирования портов UDP (-sU) и определения версий (-sV) переведены на использование общего источника данных nmap-service-probes. В режиме сканирования сервисов (-sV) появилась возможность определения UDP-сервисов, доступных через туннель DTLS (по аналогии с TCP-сервисами, для которых используется шифрование SSL/TLS). В утилите Ncat, при работе в режиме listen и указании опций "--udp --ssl", для защиты входящих соединений обеспечено использование DTLS. На платформах, функция getaddrinfo на которых поддерживает флаг AI_IDN, реализована поддержка интернационализированных имён доменов, таких как "Яндекс.рф". Улучшен разбор доменных имён, возвращаемых серверами DNS. Для противостояния проведению атак через манипуляцию ответами DNS-серверов добавлена защита от рекурсии и реализовано ограничение размера доменного имени. Значительно ускорена передача данных через Ncat на платформе Windows (решена проблема с возникновением задержки в 125ms при каждом чтении из STDIN). Обновлён текст лицензии NPSL (Nmap Public Source License), в которую добавлено уточнение, что требования к производным работам и другие условия лицензии применимы только к сторонам, принявшим лицензию в обмен на получение особых прав, таких как право на редистрибуцию Nmap. При этом участвующая сторона может делать всё что ей необходимо в соответствии с положениями авторского права, такими как добросовестное использование, и разработчики Nmap не будут пытаться установить контроль над их работой.