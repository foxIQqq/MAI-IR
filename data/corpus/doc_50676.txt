Уязвимость в сетевом стеке ядра Linux

В коде обработчика протокола RDS на базе TCP (Reliable Datagram Socket, net/rds/tcp.c) выявлена уязвимость (CVE-2019-11815), которая может привести к обращению к уже освобождённой области памяти и отказу в обслуживании (потенциально не исключается возможность эксплуатации проблемы для организации выполнения кода). Проблема вызывается состоянием гонки (race condition), которое может возникнуть при выполнении функции rds_tcp_kill_sock в момент очистки сокетов для пространства сетевых имён. В спецификации NVD проблема помечена как удалённо эксплуатируемая по сети, но судя по описанию исправления, без локального присутствия в системе (необходимо контролировать состояние сокетов и присутствие приложения, принимающего запросы по RDS) и манипуляции с пространствами имён удалённо организовать атаку не получится. В частности, по мнению разработчиков SUSE уязвимость эксплуатируется только локально, организация атаки достаточно сложна и требует наличия дополнительных привилегий в системе. Если в NVD уровень опасности оценен в 9.3 (CVSS v2) и 8.1 (CVSS v2) баллов, то по рейтингу SUSE опасность оценена в 6.4 балла из 10. Представители Ubuntu также оценили опасность проблемы как умеренную. При этом в соответствии со спецификацией CVSS v3.0 проблеме присвоен высокий уровень сложности атаки и возможность эксплуатации выставлена всего в 2.2 балла из 10. Судя по отчёту от компании Cisco уязвимость эксплуатируется удалённо через отправку TCP-пакетов на рабочие сетевые сервисы RDS и уже имеется прототип эксплоита. Насколько эта информация соответствует действительности пока неясно. Возможно, в отчёте лишь художественно оформлены предположения NVD. По сведениям VulDB эксплоит ещё не создан и проблема эксплуатируется только локально. Проблема проявляется в ядрах до 5.0.8 и блокирована мартовским исправлением, включённым в состав ядра 5.0.8. В большинстве дистрибутивов проблема остаётся неустранённой (Debian, RHEL, Ubuntu, SUSE, Arch Linux). Исправление выпущено для SLE12 SP3, openSUSE 42.3 и Fedora. В качестве обходного метода защиты упоминается запрет загрузки модуля ядра rds.ko ("blacklist rds" в etc/modprobe.d/blacklist.conf) или блокировка запросов по протоколу RDS на межсетевом экране.