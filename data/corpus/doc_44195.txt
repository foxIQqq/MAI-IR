В RubyGems устранена уязвимость, позволявшая подменять файлы в репозитории

В Rubygems.org, популярном репозиторий модулей для приложений на языке Ruby, выявлена серьёзная проблема безопасности, позволявшая атакующим заменить некоторые gem-файлы на серверах проекта. Для исключения наличия в репозитории подставных файлов была проведена проверка всех файлов, загруженных после 8 февраля 2015 года. Проверка не выявила вредоносной активности. Проблема затрагивает пакеты, в имени которых присутствует символ дефиса (например, "test-unit"). Неавторизированный пользователь мог заменить подобные gem-файлы на собственные варианты. Суть проблемы сводится к тому, что имена файлов разбирались как "имя_пакета-версия", что приводило к проблемам при наличии дефиса в имени пакета. 2 апреля разработчики RubyGems внесли исправление блокирующее работу присланного им эксплоита, после чего выявили ещё одну уязвимость, которая была устранена 4 апреля. Так как подменённые файлы не соответствуют размещённой для оригинальных пакетов контрольной сумме SHA256, разработчики смогли исключить наличие скрытой подмены. Кроме того, подменённые файлы не могли быть установлены командой "gem install". Тем не менее, сохранение контрольной суммы SHA256 было введено в практику только 8 февраля 2015 года, т.е. автоматизированно можно проверить только целостность пакетов, размещённых после этой даты. При том, что в качестве даты появления первой узвимости, затрагивающей пакеты с дефисом в имени, называется 11 июня 2014 года. Для более старых пакетов авторам предлагается изучить их целостность самостоятельно, а пользователям применять такие пакеты с большой осторожностью. Вторая уязвимость, проявляющаяся в пакетах с несколькими версиями объектов S3, присутствует с момента основания RubyGems.org. Разработчики провели анализ более 750 подобных пакетов и сопоставили дату их модификации на сервере c датой создания записи с БД. Для 6 пакетов даты отличались более чем на 5 секунд. Для данных пакетов была выполнена ручная проверка при помощи утилиты diff, которая не выявила проблем.