Уязвимость, компрометирующая шифрование в различных реализациях Bluetooth

Группа Bluetooth SIG объявила об обновлении спецификаций, в связи с выявлением уязвимости (CVE-2018-5383), затрагивающей различные реализации технологии беспроводной связи Bluetooth и позволяющей полностью контролировать обмен данных между устройствами, несмотря на применение шифрования. Проблема вызвана отсутствием проверки параметров эллиптической кривой, используемых для генерации открытых ключей в процессе обмена ключами с использованием алгоритма Диффи—Хеллмана (ECDH), что позволяет постороннему атакующему, находящемуся в радиусе приема сигнала, осуществить подстановку некорректного открытого ключа в процессе сопряжения Bluetooth-устройств и с высокой вероятностью определить сессионный ключ, применяемый для шифрования канала связи. Получив ключ атакующий может перехватывать, расшифровывать и вносить изменения в Bluetooth-трафик между двумя уязвимыми устройствами (если уязвимо лишь одно из связываемых устройств, атака не может быть проведена). Уязвимость присутствует в прошивках и драйверах от различных производителей, включая Apple, Broadcom, QUALCOMM и Intel (в том числе уязвимы драйверы для Linux). Причиной появления уязвимости является наличие в спецификации Bluetooth лишь необязательных рекомендаций по проверке открытых ключей при сопряжении устройств в режимах Bluetooth Secure Simple Pairing и Bluetooth LE Secure Connections. В настоящее время группа Bluetooth SIG уже внесла исправления в спецификацию и перевела процедуру проверки любых открытых ключей в разряд обязательных, а также добавила в сертификационные тесты проверки соблюдения нового требования.