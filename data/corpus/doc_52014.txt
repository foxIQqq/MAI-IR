Выпуск системы фильтрации спама SpamAssassin 3.4.3

После года разработки доступен релиз платформы для фильтрации спама - SpamAssassin 3.4.3. В SpamAssassin реализован комплексный подход в принятии решения о блокировании: сообщение подвергается ряду проверок (контекстный анализ, черные и белые списки DNSBL, обучаемые байесовские классификаторы, проверка по сигнатурам, аутентификация отправителя по SPF и DKIM и т.п.). После оценки сообщения разными методами, накапливается определенный весовой коэффициент. Если вычисленный коэффициент превышает определенный порог - сообщение блокируется или помечается как спам. Поддерживаются средства автоматического обновления правил фильтрации. Пакет может использоваться как на клиентских, так и на серверных системах. Код SpamAssassin написан на языке Perl и распространяется под лицензией Apache. Особенности нового выпуска: Добавлен новый плагин OLEVBMacro, предназначенный для выявления OLE-макросов и VB-кода внутри документов; Повышена скорость и безопасность сканирования больших писем при наличии настроек body_part_scan_size и rawbody_part_scan_size settings; В правила обработки тела письма (body) добавлена поддержка флага "nosubject" для прекращения поиска заголовка Subject как части текста в теле письма; Из соображений безопасности объявлена устаревшей опция 'sa-update --allowplugins'; В настройки добавлено новое ключевое слово "subjprefix" для добавления префикса к теме письма при срабатывании правила. В шаблоны добавлен тег "_SUBJPREFIX_", отражающий значение настройки "subjprefix"; В плагин DNSEval добавлена опция rbl_headers для определения заголовков, к которым нужно применять проверку в списках RBL; Добавлена функция check_rbl_ns_from для проверки DNS-сервера в списке RBL. Добавлена функция check_rbl_rcvd для проверки доменов или IP-адресов из всех заголовков Received в RBL; В функцию check_hashbl_emails добавлены опции для определения заголовков, содержимое которой нужно проверять в RBL или ACL; Добавлена функция check_hashbl_bodyre для поиска в теле письма с использованием регулярного выражения и проверки найденных совпадений в RBL; Добавлена функция check_hashbl_uris для выявления URL в теле письма и их проверке в RBL; Устранена уязвимость (CVE-2018-11805), позволяющая выполнить системные команды из файлов CF (конфигурационные файлы SpamAssassin) без вывода информации об их запуске; Устранена уязвимость (CVE-2019-12420), которая может использоваться для вызова отказа в обслуживании при обработке письма со специально оформленной секцией Multipart. Разработчики SpamAssassin также объявили о подготовке ветки 4.0, в которой будет реализована полноценная встроенная обработка UTF-8. Первого марта 2020 года также будет прекращена публикация правил с сигнатурами на базе алгоритма SHA-1 (в выпуске 3.4.2 на смену SHA-1 пришли хэш-функции SHA-256 и SHA-512).