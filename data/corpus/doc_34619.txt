Проект по задействованию LTO-оптимизации при сборке ядра Linux

Разработчики из компании Intel представили набор патчей с результатами работы по адаптации ядра Linux для сборки с использованием режима оптимизации во время динамического связывания (LTO - Link Time Optimization). LTO-оптимизации отличаются учётом состояния всех файлов, участвующих в процессе сборки, в то время, как традиционные режимы оптимизации оптимизируют каждый файл по отдельности и не учитывают условия вызова функций, определённых в других файлах. Например, при LTO для функций из других файлов возможно inlinе-развёртывание, в исполняемый файл не включается неиспользуемый код, осуществляется проверка типов для всей программы, производится общая оптимизация на уровне проекта в целом. Подготовленные патчи включают в себя устранения проблем, всплывших в результате более агрессивной оптимизации, а также содержат ряд обходных путей для исключения влияния известных проблем в GCC 4.7. В результате использования патчей при сборке ядра 3.6 при помощи GCC 4.7 удалось добиться заметного повышения производительности результирующей сборки. Ускорение наблюдается практически во всех тестах, за исключением нескольких незначительных регрессий, которые планируется устранить в ближайшее время. Ценой использования LTO является замедление процесса сборки в 2-4 раза и необходимость наличия в системе от 4 до 9 Гб ОЗУ в зависимости от собираемой конфигурации ядра. Ожидается, что в будущих версиях GCC проблемы с производительностью будут решены и скорость сборки в режиме LTO будет существенно увеличена.