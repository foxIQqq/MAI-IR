Контроллеры электронных замков HID оказались незащищены от тривиальных уязвимостей

В контроллерах систем управления доступом HID VertX и Edge, используемых во многих аэропортах, больницах, госучреждениях и предприятиях для организации доступа в помещения по картам, отпечаткам пальцев или NFC-аутентификации со смартфона, выявлены серьёзные недоработки в безопасности, позволяющие удалённо получить полный контроль над системой. Уязвимость позволяет любому злоумышленнику выполнить свой код с правами root, отправив на открытый сетевой порт 4070 специально оформленный UDP-пакет, без проведения какой-либо аутентификации. Уязвимость связана с передачей непроверенного пользовательского ввода внешней утилите через функцию system(), что позволяет выполнить любую команду shell, указав её внутри введённых параметров, например,"123`id`". Сервис принимает широковещательные пакеты, что можно использовать для одновременного открытия всех дверей в учреждении. Платформы VertX и Edge поддерживают не только мониторинг и настройку доступа через сеть, но и снабжены сервисом discoveryd, упрощающем подключение новых устройств к системе. Кроме функций идентификации устройства, discoveryd также применяется для инициирования мигания индикатора на замке, для которого используется передаваемая через неаутентифицируемый UDP-пакет команда command_blink_on. Команда передаётся с числовым параметром, определяющим число миганий индикатора. При получении команды контроллер с правами root выполняет утилиту /mnt/apps/bin/blink передав полученный параметр в качестве аргумента в вызове system(), без какой-либо проверки полученного значения.