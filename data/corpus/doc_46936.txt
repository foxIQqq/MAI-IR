В Tor Browser устранена уязвимость, допускавшая прямое соединение в обход Tor

Доступен корректирующий релиз специализированного браузера Tor Browser 7.0.3, ориентированного на обеспечение анонимности, безопасности и приватности. Браузер построен на кодовой базе Firefox и отличается тем, что весь трафик перенаправляется только через сеть Tor. В выпуске устранена опасная уязвимость, позволяющая при открытии специально оформленного URL, напрямую обратиться к внешнему ресурсу с реального IP-адреса текущей системы. Проблема затрагивает только Linux-дистрибутивы, в которых присутствует сервис GVfs (GNOME Virtual file system) и используется библиотека GIO (GNOME Input/Output). Код поддержки GVfs/GIO в Firefox допускает запуск системного обработчика URL (например, smb://, sftp:// и т.п.), при помощи которого может быть осуществлено обращение к ресурсам в обход настроек прокси, что даёт возможность через GIO совершить прямое соединение на внешний хост и деанонимизировать пользователя. Проблема не проявляется в дистрибутиве Tails, в сборке sandboxed-tor-browser (Tor Browser запускается в изолированном окружении) и в дистрибутиве Whonix (выход в сеть из производится только через шлюз Whonix-Gateway, что изолирует рабочее окружение от прямого взаимодействия с внешним миром и допускает использование только фиктивных сетевых адресов). Например, при открытии ссылки "smb://8.8.8.8" или "sftp://8.8.8.8/" будет выполнено обращение к хосту 8.8.8.8 по сетевым портам 139 и 22: $ sudo tcpdump -n -i wlan0 host 8.8.8.8 14:06:12.577697 IP 192.168.1.11.39142 > 8.8.8.8.139: Flags [S], seq 1960788434, win 29200, options [mss 1460,sackOK,TS val 81835484 ecr 0,nop,wscale 7], length 0 14:06:13.575642 IP 192.168.1.11.39142 > 8.8.8.8.139: Flags [S], seq 1960788434, win 29200, options [mss 1460,sackOK,TS val 81835734 ecr 0,nop,wscale 7], length 0 14:07:12.291002 IP 192.168.1.11.47928 > 8.8.8.8.22: Flags [S], seq 3208825553, win 29200, options [mss 1460,sackOK,TS val 81850412 ecr 0,nop,wscale 7], length 0 14:07:13.287567 IP 192.168.1.11.47928 > 8.8.8.8.22: Flags [S], seq 3208825553, win 29200, options [mss 1460,sackOK,TS val 81850662 ecr 0,nop,wscale 7], length 0