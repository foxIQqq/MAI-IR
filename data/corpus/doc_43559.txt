Определён универсальный пароль для входа на межсетевые экраны Juniper ScreenOS

Разработчики пакета Metasploit опубликовали результаты обратного инжиниринга бэкдора, на днях выявленного в межсетевых экранах Juniper ScreenOS. Так как компания Juniper привела лишь общие угрозы, которые несёт в себе бэкдор, многие энтузиасты подключились к изучению различий между поражёнными бэкдором прошивками и устраняющими проблемы обновлениями. Поверхностное сканирование сети показало, что в сети находятся несколько десятков тысяч потенциально уязвимых межсетевых экранов с открытыми вовне сервисами ssh или telnet. Всем администраторам межсетевых экранов Juniper рекомендуется срочно обновить прошивку, так как бэкдором теперь могут воспользоваться не только его создатели, но и любой желающий. Часть бэкдора, обеспечивающая удалённый вход в систему с правами администратора, оказалась основана на использовании универсального пароля, который был закамуфлирован под код вывода отладочных данных. В частности, используя пароль "<<< %s(un='%s') = %u" в сочетании любым корректным именем пользователя (например, system) можно попасть в привилегированный shell устройств на базе Juniper ScreenOS. Часть бэкдора, обеспечивающая возможность расшифровки VPN, может быть основана на использовании специально подобранного набора констант в генераторе псевдослучайных чисел EC PRNG, которые позволяли создателям данных констант восстановить значение случайного числа и восстановить ключи шифрования для установленного из ScreenOS VPN-соединения. Другой вариант получения доступа к VPN озвучен Мэтью Грином (Matthew Green), известным исследователем систем шифрования. Мэтью считает, что для восстановления ключей шифрования VPN достаточно утечки 30 байтов из raw-вывода штатного генератора случайных чисел Dual EC, на основании которых можно предсказать все дальнейшие генерируемые последовательности.