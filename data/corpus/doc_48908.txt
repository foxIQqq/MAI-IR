В браузерном дополнении Stylish выявлен код для отправки истории посещений

В популярном браузерном дополнении Stylish, которое установлено на системах около 1.9 млн пользователей Chrome и 300 тысяч пользователей Firefox, выявлен код, который осуществляет отправку сведений об истории посещений. В прошлом году дополнение было продано компании SimilarWeb, специализирующейся на web-аналитике, и новый владелец добавил в дополнение код для отправки телеметрии. Изучение этого кода показало, что кроме заявленной общей обезличенной статистики на внешний сервер передаются полные URL страниц, которые посещает пользователь. Примечательно, что разработчик пытался скрыть данную особенность и передавал статистику на сервер "api.userstyles.org/tics/stats" в виде закодированного бинарного блоба. Один из пользователей заинтересовался подобной особенностью, декодировал и проанализировал состав передаваемых данных (для скрытия применялось два вложенных цикла кодирования методом base64). Вопреки заявлениям, что передается только анонимная статистика о числе открытых страниц, вовне отправлялись конкретные URL с привязкой к IP-адресу, уникальному идентификатору пользователя и учётной записи в каталоге шаблонов оформления userstyles.org. В том числе передавались URL с присутствующими среди параметров токенами аутентификации и сессионными идентификататорами (например, "mysocialnetwork.com/inbox?login_token=fsdj90d..."), что потенциально может применяться для получение контроля за учётными данными пользователя. Даже если компания SimilarWeb не заинтересована в проведении атак, в случае компрометации её инфраструктуры злоумышленник, например, может отследить запросы с кодом изменения пароля ("mysocialnetwork.com/password-reset?reset_token=a5dJ3...") и завершить процесс сброса пароля раньше реального пользователя. На серверы SimilarWeb также передаются различные одноразовые уникальные URL для просмотра данных ограниченного доступа и ссылки вида "linkedin.com/in/robertjheaton/edit", по которым можно косвенно судить о статусе пользователя. После информирования о нарушении правил размещения дополнения в каталоге компания Google удалила дополнение из Chrome Web Store. Разработчики Mozilla также удалили Stylish из своего каталога дополнений и поместили дополнение в чёрный список, что приведёт к его блокировке на системах пользователей после очередного обновления браузера. Stylish позволяет на свой вкус изменять оформление любых сайтов, в том числе энтузиастами подготовлено несколько скинов с вариантами тёмного оформления opennet.ru. В качестве альтернативы для изменения стиля страниц существующих сайтов предлагается использовать дополнение Stylus (Firefox, Сhrome), в рамках которого развивается независимое ответвление от Stylish. Проект Stylus был создан вскоре после перехода Stylish в руки нового владельца и его заявления о желании встроить отправку телеметрии (выполнен форк последнего выпуска, подготовленного первоначальным автором проекта).