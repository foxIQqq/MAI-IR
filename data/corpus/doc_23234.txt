Атака на ftpd из состава FreeBSD

Некорректная обработка некоторых системных файлов при использовании chroot-режима в ftpd из состава FreeBSD может быть использована для обхода некоторых системных ограничений. Доступен пример проведения атаки, которая сработала во FreeBSD 7.2, при условии разрешения сохранения coredump-файлов от suid-программ в текущую директорию (по умолчанию запрещено, kern.sugid_coredump=0). Атакующий, имеющий доступ в систему с chroot ограничением, может загрузить файлы ".login_conf" и ".login_conf.db", содержащие установку лимита на число открытых файлов "openfiles=5". Далее попытка в новой сессии открыть какой-то файл, приведет к краху ftpd с сохранением coredump-файла ftpd.core, в котором можно найти неочищенные области памяти с остатком хэшей паролей.