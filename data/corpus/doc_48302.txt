Компания AMD подтвердила наличие уязвимостей в своих чипах

Компания AMD подтвердила наличие проблем с безопасностью в процессорах Ryzen, EPYC, Ryzen Pro и Ryzen Mobile, о которых ранее заявила компания CTS Labs. Проблемы не связаны с ошибками в архитектуре процессоров AMD "Zen" и вызваны исключительно недоработками в прошивках, применяемых в модуле управления безопасностью PSP (Platform Security Processor) и чипсете. AMD планирует устранить выявленные уязвимости в ближайшем обновлении прошивок. Опасность выявленных проблем заметно меньше, чем было преподнесено в заявлении CTS Labs, которое больше напоминало PR-акцию, что послужило причиной недоверия со стороны многих экспертов. Для эксплуатации всех уязвимостей необходимо наличие доступа к системе с правами администратора, а одна наиболее опасная проблема требует перепрошивки BIOS. Выявленные уязвимости представляют интерес в основном для скрытия своего присутствия после успешного проведения атаки на систему (в том числе сохранение вредоносного ПО в области PSP, остающейся неизменной после переустановки ОС и BIOS), обхода проверок по цифровой подписи (в том числе обход Secure Boot и Secure Encrypted Virtualization) и обхода TPM-модулей. При этом внесённые в ходе атаки изменения сохраняются между перезагрузками только для уязвимости, требующей перепрошивки BIOS с последующим перезапуском, а для остальных уязвимостей не сохраняются между перезагрузками. Выявленные уязвимости: MasterKey - затрагивает процессоры EPYC и Ryzen, и позволяет обойти проверки, выполняемые на уровне отдельного защищённого процессора PSP (AMD Security Processor), и изменить содержимое связанной с ним Flash-памяти. Например, можно отключить TPM-модули (Trusted Platform Module) и внести изменение в прошивку, обеспечив скрытое от основной системы выполнение кода. Эксплуатация уязвимости производится путём перепрошивки BIOS в обход HVM (AMD Hardware Validated Boot) и требует перезагрузки системы. Результат атаки сохраняется между перезагрузками. Ryzenfall и Fallout - затрагивают процессоры Ryzen, EPYC, Ryzen Pro и Ryzen Mobile, и позволяют атакующему внедрить вредоносный код в аппаратно изолированное окружение SMM (x86) или PSP (Platform Security Processor). В результате атаки можно получить доступ к закрытым областям памяти, таким как Secure Management RAM и AMD Secure Processor Fenced DRAM. Внедрённые изменения не сохраняются между перезагрузками. Chimera - позволяет выполнить код на уровне чипсета Promontory, применяемого в некоторых рабочих станциях на базе процессоров Ryzen и Ryzen Pro (проблеме не подвержены платформы AMD EPYC, Ryzen Mobile FP5 и Ryzen Embedded). Выполнение кода на уровне чипсета даёт возможность получить прямой доступ ко всей физической памяти и контролировать прикреплённые к чипсету устройства, такие как SATA, USB, PCIe и сетевой адаптер, например можно организовать перехват передаваемых данных или обойти защиту памяти через манипуляции с DMA. Уязвимость также можно использовать для установки в чипсет трудновыявляемого вредоносного кода, но изменения не сохраняются между перезагрузками.