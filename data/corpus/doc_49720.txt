Выпущен патч, решающий проблему с blk-mq в ядре Linux 4.19, которая приводит к потере данных

Йенс Эксбо (Jens Axboe), мэйнтейнер подсистемы блочных устройств, подготовил патч, решающий проблему с файловой системой ext4 в ядре Linux 4.19, которая может привести к повреждению данных. Проблема проявляется при сборке ядра с опцией "CONFIG_SCSI_MQ_DEFAULT=y", которая выставляется по умолчанию начиная с версии 4.19. Необходимым условием также является работа без планировщика ввода-вывода (/sys/devices/virtual/block/*/queue/scheduler содержит значение "none"). Так как источник проблемы не специфичен для ext4 и присутствует в слое разделения очередей для блочных устройств ("blk-mq"), то теоретически проблема могла затрагивать и другие файловые системы, но в силу популярности проявление проблемы пока зафиксировано только для Ext4. Дополнение 1: Пользователи ZFS зафиксировали появление в логах предупреждений о нарушении контрольных сумм для разных дисков в RAID-Z, которые связываются с обсуждаемой ошибкой). Дополнение 2: Патч принят в состав находящейся в разработке ветки ядра 4.20. Уточнены условия проявления проблемы: помимо отсутствия планировщика ввода/вывода требуется регулярное возникновения ситуаций нехватки ресурсов при вводе/выводе и множественные вызовы драйвером queue_rq() при обработке запроса.