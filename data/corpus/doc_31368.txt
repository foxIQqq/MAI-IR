Пример анализа потенциально серьезной уязвимости в OpenSSH

В списке рассылки Full Disclosure опубликован разбор достаточно интересной уязвимости в OpenSSH, найденной в реализации алгоритма аутентификации через вызов модулей GSSAPI. Сама по себе уязвимости малопригодна для осуществления атаки, так как может быть использована для осуществления DoS-атаки (исчерпание доступной процессу памяти) на стадии после совершения аутентификации, т.е. эксплуатировать проблему можно только имея работающий аккаунт в системе. Тем не менее интерес вызывает то, что несмотря на проявление проблемы в большинстве современных Linux-дистрибутивов, которые используют метод аутентификации "gssapi-with-mic", ошибка была найдена еще в 2008 году и обнародована только сейчас. По словам нашедшего ошибку исследователя, проблема была так долго не обнародована так как было предположение, что ошибку можно использовать на стадии до совершения аутентификации, т.е. оставалась надежда на возможность эксплуатации без наличия рабочего аккаунта. После детального изучения вопроса был сделан вывод, что проблема проявляется только после выполнения стадии аутентификации, что сводит на нет опасность уязвимости. Исследователь отмечает, что если бы в связанном с GSSAPI коде OpenSSH было на один вызов меньше, то уязвимость можно было использовать до начала аутентификации. Суть проблемы сводится к возможности организации передачи произвольного значения аргумента при вызове функции xmalloc(), осуществляющей выделение памяти. Передав заведомо большое значение можно запросить большой блок памяти, ограниченный выставленным для процесса лимитом. Выполнив параллельно несколько подобных атак на одном сервере можно добиться исчерпания свободной памяти в системе.