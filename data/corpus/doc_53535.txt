Удалённая уязвимость в серверных платах Intel с BMC Emulex Pilot 3

Компания Intel сообщила об устранении 22 уязвимостей в прошивках своих серверных материнских плат, серверных систем и вычислительных модулей. Три уязвимости, одной из которых присвоен критический уровень, (CVE-2020-8708 - CVSS 9.6, CVE-2020-8707 - CVSS 8.3, CVE-2020-8706 - CVSS 4.7) проявляется в прошивке BMC-контроллера Emulex Pilot 3, применяемого в продуктах Intel. Уязвимости позволяют без аутентификации получить доступ к консоли удалённого управления (KVM), обойти аутентификацию при эмуляции USB-устройств хранения и вызвать удалённое переполнение буфера в применяемом в BMC ядре Linux. Уязвимость CVE-2020-8708 даёт возможность неаутентифицированному злоумышленнику, имеющему доступ к общему с уязвимым сервером сегменту локальной сети, получить доступ к управляющему окружению BMC. Отмечается, что техника эксплуатации уязвимости очень проста и надёжна, так как проблема вызвана архитектурной ошибкой. Более того, по словам выявившего уязвимость исследователя работать с BMC через эксплоит гораздо удобнее, чем при помощи штатного Java-клиента. Среди подверженного проблеме оборудования упоминаются семейства серверных систем Intel R1000WT, R2000WT, R1000SP, LSVRP, LR1304SP, R1000WF и R2000WF, материнские платы S2600WT, S2600CW, S2600KP, S2600TP, S1200SP, S2600WF, S2600ST и S2600BP, а также вычислительные модули HNS2600KP, HNS2600TP и HNS2600BP. Уязвимости устранены в обновлении прошивки 1.59. По неофициальным данным прошивка для BMC Emulex Pilot 3 написана в компании AMI, поэтому не исключается проявление уязвимостей и на системах других производителей. Проблемы присутствуют во внешних патчах к ядру Linux и работающем в пространстве пользователя управляющем процессе, код которых характеризуется выявившим проблему исследователем как худший код, c которым ему приходилось сталкиваться. Напомним, что BMC представляет собой устанавливаемый в серверах специализированный контроллер, имеющий свой CPU, память, хранилище и интерфейсы опроса датчиков, который предоставляет низкоуровневый интерфейс для мониторинга и управления серверным оборудованием. При помощи BMC независимо от работающей на сервере операционной системы можно отслеживать состояние датчиков, управлять питанием, прошивками и дисками, организовать удалённую загрузку по сети, обеспечить работу консоли удалённого доступа и т.п.