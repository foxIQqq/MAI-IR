Обновление свободного антивирусного пакета ClamAV 0.100.3 и 0.101.2 с устранением уязвимостей

Компания Cisco представила корректирующие выпуски свободного антивирусного пакета ClamAV 0.100.3 и 0.101.2, в которых устранено несколько уязвимостей: CVE-2019-1788 - возможность записи в область памяти вне выделенного буфера при сканировании файлов в формате OLE2 (например, документы Microsoft Office 97-2003); CVE-2019-1785 - возможность записи данных в область ФС вне каталога, используемого при распаковке, при сканировании специально оформленных RAR-архивов; CVE-2019-1786, CVE-2019-1787, CVE-2019-1789 - возможность чтения из памяти за границей буфера при сканировании специально оформленных PDF-документов и исполняемых файлов в формате PE (EXE, DLL); CVE-2019-1798 - обращение к уже освобождённому блоку памяти (use-after-free) при сканировании специально оформленных вложенных RAR-архивов; Кроме того в новых выпусках добавлено несколько исправлений и мер для усиления защиты: Добавлен режим непривилегированного сканирования CL_SCAN_GENERAL_UNPRIVILEGED, при которой движок запускается без прав чтения файлов. В код нормализации HTML, распаковки UPX, ARJ, CPIO, Xz и LZW, парсинга OLE2 и преобразования UTF-16 в ASCII добавлены дополнительные проверки для исключения возникновения неопределённого поведения. В распаковщик UPX добавлены проверки для блокирования целочисленных переполнений. Устранены утечки памяти в парсерах OLE2 и PDF, а также утечка файловых дескрипторов в коде нормализации HTML. Прекращено использование проблемной функции преобразования файловых дескрипторов в файловые пути. Реализована возможность создания временных файлов при распаковке архивов RAR без прямого доступа процесса к этим файлам по файловому пути.