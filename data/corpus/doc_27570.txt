Релиз OpenBSD 4.8 уходит в печать

Тираж OpenBSD 4.8 готовится к уходу в печать. Уже открыт предзаказ оригинальных дисков; как обычно, те, кто им воспользуется, получат диски с уникальным контентом, причём раньше официального релиза. Сам релиз планируется, как обычно, 1-го ноября. Параллельно сейчас идёт сборка пакетов со сторонним ПО для тех архитектур, которые не входят в состав содержимого официальных дисков. Из числа последних внесённых в релиз изменений: Стабильное восстановление из спящего и ждущего режимов для различных видеокарт (в том числе при работе в X.org) и сетевых плат. В списках рассылках уже появляются положительные комментарии о высокой стабильности suspend/resume, зачастую более высокой, чем у Windows и MacOS X (пример). Чуть улучшена эвристика определения наличия PS/2-клавиатур. Небольшие улучшения в стабильности NTFS-драйвера. Исправлена ошибка взаимодействия relayd(8) с CARP, связанный с ошибкой в парсере конфигурации (значения по умолчанию для таблиц непреднамеренно наследовались от родительских таблиц). Другие изменения, уже вошедшие в ветку 4.8-CURRENT (будущая OpenBSD 4.9, выход которой планируется 1-го мая 2011 года): nsd, импортированный в начале этого года авторитативный простой и высокопроизводительный сервер DNS, обновлён и включён в сборку базовой системы. В планах разработчиков стоит импорт DNS-резолвера Unbound. Исправлен ряд проблем в ospf6d, включая некорректную обработку пути по умолчанию (default route). Добавлена поддержка чипа LSISAS2004 в mpii(4). Новый флаг для семейства функций vis(3)/unvis(3): VIS_ALL. Он указывает, что преобразованию должны подвергаться все символы, включая те, для которых оно не требуется. Ряд дальнейших улучшений в поддержке (выхода из) ждущего режима и относительно редких разновидностей azalia-кодеков. В частности, начата работа над поддержкой ждущего режима для платформы loongson Исправлена небольшая утечка памяти в OpenRCS/OpenCVS. Вместо machdep.console_device введён новый sysctl-параметр: kern.consdev. Он уже используется X.org для вывода диагностических сообщений на реально используемое в качестве системной консоли устройство, без необходимости использования сложной эвристики. Исправлен ряд проблем вида use-after-free и неинициализированных переменных в некоторых драйверах, входящих в SCSI-стек. Часть проблем признана серьёзной и для них выпущены патчи под OpenBSD 4.7, в которой эти проблемы и появились. Небольшие улучшения в надёжности работы uaudio(4) и aucat(1). Наложен патч на GCC 4, исправляющий проблемы с выравниванием массивов на архитектурах, где оно важно. Хотя формально GCC 4 ведёт себя в рамках стандарта языка C, фактически программисты часто полагаются на то, что массивы буду выровненными, даже если состоят из элементов меньшего, чем граница выравнивания, размера. Новости развития OpenSSH: Усилена защита против внедрённых в получаемую от удалённой стороны строку нуль-символов ('\0'). Добавлен механизм распределния ключей на основе эллиптических кривых (RFC 5656). На данный момент реализованы только обязательные части стандарта. В частности, за бортом (пока что?) осталось точечное сжатие (point compression). (подробности) Исправлена проблема с одновременным использованием опций ControlPersist=yes и ControlMaster=yes. Заметное изменение в портах: версия Python по умолчанию изменена с 2.5 на 2.6. Разумеется, этому предшествовало долгое тестирование, некоторые разработчики проводили его в течение года. Нынешний переход должен быть, по идее, менее болезненным, чем с 2.4 на 2.5. Однако всё равно возможны проблемы с кодом вне портов, равно как и в экзотических конфигурациях, поэтому тестирование активно приветствуется. Важные моменты: Следует не забывать, что обновлять Python и зависящие от него программы следует одновременно, во избежание проблем с библиотеками. Если вы пользуетесь snapshot'ами для обновления системы, вы можете проверить используемую версию Python по, например, пакету scapy: если он имеет версию 2.0.1p0 или новее, то он собран с Python 2.6. Если вы создавали симлинк /usr/local/bin/python, то не забудьте его так же обновить. Программы из портов должны использовать конкретную версию (/usr/local/bin/python2.6), поэтому с ними проблем быть не должно. Административные новости: изменена политика обсуждения патчей. Вместо закрытого списка рассылки обсуждение практически всех патчей (кроме совсем сырых и некоторых связанных с безопасностью) теперь проводится публично на tech@openbsd.org. Разработчики надеются, что это увеличит количество тестеров и, как следствие, качество идущего в коммиты кода; а так же просят не реагировать бурно на специфический «внутренний», понятный только разработчикам и связанным лицам, юмор в комментариях к этим патчам и их обсуждении. Также сейчас тестируется патч, реализующий поддержку Unicode в curses(3). Желающие поучаствовать приветствуются. Дополнение 09.09.2010: Доступен предзаказ дисков OpenBSD 4.8 и новая песня (OGG, MP3).