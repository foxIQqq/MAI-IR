Выпуск гипервизора Xen 4.14

После восьми месяцев разработки опубликован релиз свободного гипервизора Xen 4.14. В разработке нового выпуска приняли участие такие компании, как Alibaba, Amazon, AMD, Arm, Bitdefender, Citrix, EPAM Systems, Huawei и Intel. Выпуск обновлений для ветки Xen 4.14 продлится до 24 января 2022 года, а публикация исправлений уязвимостей до 24 июля 2023 года. Ключевые изменения в Xen 4.14: Добавлена поддержка новой модели устройств Linux stubdomain, позволяющей организовать выполнение под отдельным непривилегированным пользователем, отделив компоненты для эмуляции устройств от Dom0. Ранее в режиме stubdomain можно было использовать только модель устройств "qemu-traditional", что ограничивало спектр эмулируемого оборудования. Новая модель Linux stubomains была разработана проектом QUBES OS и поддерживает использование драйверов эмуляции из самых свежих выпусков QEMU, а также доступных в QEMU сопутствующих возможностей для гостевых систем. Для систем с поддержкой Intel EPT реализована поддержка создания легковесных ответвлений (форков) виртуальных машин для проведения быстрой интроспекции, например, для анализа вредоносного ПО, или fuzzing-тестирования. В подобных форках применяется совместное использование памяти и не выполняется клонирование модели устройств. В систему live-патчей добавлена привязка к идентификаторам сборок гипервизора и учёт порядка применения патчей для исключения наложения патчей не для той сборки или не в том порядке. Добавлена поддержка поддержка расширений CET (Intel Control-flow Enforcement Technology) для защиты от выполнения эксплоитов, построенных с использованием приёмов возвратно-ориентированного программирования (ROP, Return-Oriented Programming). Добавлена настройка CONFIG_PV32 для отключения в гипервизоре поддержки 32-разрядных паравиртуализированных (PV) гостевых систем, сохраняя при этом поддержку 64-разрядных. Добавлена поддержка Hypervisor FS, псвевдо-ФС в стиле sysfs для структурированного доступа к внутренним данным и настройкам гипервизора, не требующего разбора логов или написания гипервызовов. Предоставлена возможность запуска Xen в роли гостевой системы под управлением гипервизора Hyper-V, используемого в облачной платформе Microsoft Azure. Запуск Xen внутри Hyper-V позволяет использовать привычный стек виртуализации в облачных окружениях Azure и даёт возможность перемещать виртуальные машины между разными облачными системами. Добавлена возможность генерации случайного идентификатора гостевой системы (ранее идентификаторы генерировались последовательно). Идентификаторы также теперь могут сохраняться между операциями сохранения, восстановления и миграции состояния VM. Обеспечена автоматическая генерация биндингов для языка Go на основе структур libxl. Для Windows 7, 8.x и 10 добавлена поддержка KDD, утилиты для взаимодействия с отладчиком WinDbg (Windows Debugger), что позволяет отлаживать окружения с Windows без включения отладки в гостевой ОС. Добавлена поддержка всех вариантов платы Raspberry Pi 4, поставляемых с 4GB и 8GB ОЗУ. Добавлена поддержка процессоров AMD EPYC с кодовым именем "Milan". Увеличена производительность вложенной виртуализации, при которой Xen запускается внутри гостевых систем на базе Xen или Viridian. В режиме эмуляции реализована поддержка инструкций AVX512_BF16. Сборка гипервизора переведена на использование Kbuild.