Представлена атака, использующая уязвимость в 4G-чипе смартфонов Huawei

Следом за уязвимостью в WiFi-чипах Broadcom, используемых во многих популярных моделях смартфонов, исследователи безопасности из компании Comsecuris продемонстрировали на конференции Infiltrate Conference возможность совершения атаки на мобильные устройства пользователей через эксплуатацию уязвимости в baseband-процессорах, обеспечивающих работу GSM-стека. Уязвимость затрагивает baseband-процессоры HiSilicon Balong с интегрированным модемом 4G LTE, развиваемые компанией Hisilicon Technologies, которая является подразделением Huawei Technologies. Подобные процессоры используются в ряде топовых смартфонов Huawei Honor, включая P10, Mate 9, Honor 9, 7, 5c и 6, а также в модулях связи некоторых моделей ноутбуков. Несмотря на то, что baseband-процессор является независимым звеном и отделён от CPU, обслуживающего основное системное окружение, получение контроля за данным компонентом позволяет атакующему получить полный доступ к телефонии, включая возможность отслеживать коммуникации через мобильную сеть, совершать звонки и отправлять/перехватывать SMS. Изучение прошивки, которую удалось найти в одном из архивов с компонентами для ядра Linux, показало, что в чипсете связи используется ОС VxWorks и присутствует простая командная оболочка C-Shell. Несмотря на ограниченную функциональность, из окружения C-Shell можно модифицировать и просматривать содержимое памяти, получать информацию о запущенных задачах, запускать свои задачи и загружать модули ядра. Исследователь нашёл способ запуска кода на стороне baseband-процессора, который мог создавать соединения в сотовой сети, невидимые из основной Android-системы. Следующим шагом стало выявление уязвимости в LTE-стеке, которая бы позволила выполнить код в окружении baseband-процессора и совершить атаку без физического доступа к устройству. С одной стороны уязвимость позволяет провести атаку незаметно от пользователя в любых общественных местах, но с другой стороны риск массовых атак снижается достаточно большой трудоёмкостью и сложностью атаки. В частности, предложенный сценарий атаки, который не требует физического доступа к устройству, подразумевает создание фиктивной базовой станции, например, при помощи свободного пакета OpenLTE, и подставного сетевого оператора. Далее в эфир отправляются специально оформленные пакеты, которые при обработке на подключившемся к фиктивной сети уязвимом устройстве приводят к записи за пределы выделенного буфера в LTE-стеке. В докладе представлена только демонстрация и информация о неопасных уязвимостях, а детали наиболее опасных проблем пока держатся в тайне, до тех пор пока Huawei не исправит выявленные проблемы.