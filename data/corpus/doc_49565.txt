Уязвимость, предоставляющая доступ к данным на самошифруемых SSD-накопителях

Группа исследователей из Университета Неймегена (Нидерланды) в ходе проведения обратного инжиниринга прошивок некоторых моделей самошифруемых SSD-накопителей выявила фундаментальную недоработку, позволяющую получить доступ к зашифрованным данным. Пользователям рекомендовано не доверять встроенным в SSD-накопители аппаратным механизмам шифрования, а использовать полностью программные реализации, такие как VeraCrypt. Суть проблемы в некорректной организации шифрования, позволяющей расшифровать данные без знания заданного пользователем пароля. Оказалось, что реализуемые в накопителях схемы шифрования не соответствуют стандарту TCG Opal и задаваемый пользователем пароль никак не используется для генерации или защиты DEK-ключа (Data Encryption Key), непосредственного применяемого для шифрования. Несмотря на то, что задаваемый пользователем пароль позиционируется как пароль для шифрования, прошивка накопителя использует его лишь для авторизации доступа. Даже если для разных разделов пользователем заданы разные пароли, фактически для шифрования на уровне прошивки применяется один общий DEK-ключ. Для защиты основного ключа шифрования на деле используется мастер-пароль, который предопределён в прошивке и доступен для извлечения. Более того, в некоторых изученных устройствах мастер-пароль представляет собой просто пустую строку (32 нулевых байта). Подключившись к отладочному порту при помощи программатора можно через изменение специального флага в прошивке, извлечение DEK-ключа или модификации прошивки для отключения процедуры проверки пароля получить доступ к зашифрованным данным без знания пароля, заданного пользователем. Наличие проблемы подтверждено в накопителях Samsung T3, T5, 840 EVO и 850 EVO, а также в накопителях Crucial (Micron) MX100, MX200 и MX300. Возможно проблеме подвержены и другие модели, так как анализ ограничился лишь имеющимися у исследователей устройствами. Производители Samsung и Crucial были уведомлены о проблеме в апреле и уже успели выпустить обновления прошивок для проблемных SSD-накопителей.