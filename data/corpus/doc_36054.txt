Релиз офисного пакета LibreOffice 4.0

Организация Document Foundation объявила о выпуске офисного пакета LibreOffice 4.0. Это пятый значительный выпуск проекта после ответвления от кодовой базы OpenOffice.org. Существенная смена нумерации (4.0 вместо 3.7) обусловлена кардинальными изменениями внутренней структуры пакета, окончательно отдалившими проект от изначальной кодовой базы OpenOffice.org и ознаменовавшими расхождение путей с проектом Apache OpenOffice. Релиз LibreOffice 4.0 рассматривается как символичный этап в развитии сообщества, продемонстрировавшего свою способность выбора собственного пути развития. За 30 месяцев существования LibreOffice, в проекте приняло участие около 500 разработчиков, которые внесли более 50 тысяч изменений, из которых 10 тысяч было внесено в процессе подготовки LibreOffice 4.0. В новом выпуске проведена самая значительная чистка API со времён OpenOffice.org 1.x. API стал более мощным и простым в использовании, но ценой этого стало нарушение совместимости с прошлой кодовой базой. Другим важным внутренним изменением стал переход на использование нового графического стека, применение новых методов организации работы интерфейса и задействование нового формата оформления виджетов и диалогов, редактируемого в Glade (формат .ui). В базовую часть LibreOffice встроен интерпретатор Python. Добавлена поддержка протокола CMIS, позволяющего обеспечить интеграцию с такими системами управления контентом, как Alfresco, IBM FileNet P8 и Microsoft Sharepoint 2010. Улучшена поддержка форматов DOCX и RTF, обеспечен импорт файлов из Microsoft Publisher и Visio 2013. Добавлена возможность сохранения произвольных диаграмм в форме PNG/JPG изображений. Готовые установочные пакеты подготовлены для различных дистрибутивов Linux, Windows и Mac OS X. Ветка 4.0 содержит большую порцию новшеств, но пока окончательно не стабилизирована, поэтому позиционируется как ознакомительный выпуск, пригодный для использования продвинутыми пользователями и энтузиастами. О готовности к промышленному использованию будет объявлено дополнительно, одновременно с выходом одного из корректирующих релизов (4.0.2 или 4.0.3). Из новшеств, добавленных в ветке LibreOffice 4.0, можно отметить: Поддержка использования легковесных визуальных тем Firefox для изменения внешнего вида LibreOffice (настройка осуществляется через Tools/Options/Personalization/Select Persona); Поставка нового мобильного приложения Impress Android Remote, позволяющего использовать телефон на базе платформы Android для удалённого управления показом презентации; В число базовых подсистем включены модуль импорта PDF, консоль управления презентацией Presenter Console и интерпретатор Python. Используемая для написания дополнений версия Python обновлена с 2.6 до 3.3; Улучшения текстового процессора Writer: Добавлена возможность привязки комментариев к областям в тексте (например, к отдельным словам и фразам); Возможность определения расширенных символов для разделения слов, влияющих на работу алгоритма подсчёта слов в тексте. Настройка доступна через диалог "Tools→Options→Writer→General→Word Count". По умолчанию в качестве дополнительных разделителей определены длинное и короткое тире, но можно определить и иные разделители; Поддержка импорта рукописных заметок из документов в формате DOCX и RTF (создание подобных заметок поддерживается в версиях MS Word для планшетных ПК); Поддержка импорта и экспорта математических выражений, сохранённых во внутреннем представлении формата RTF; Возможность определения параметров верхнего и нижнего колонтитулов (заголовка и футера) для заглавной страницы без задействования отдельного стиля страниц; В фильтр для формата RTF добавлена поддержка импорта файлов со старым синтаксисом задания рисованных объектов; Многочисленные улучшения в поддержке формата DOCX, в том числе улучшение импорта плавающих таблиц, поддержка OLE-объектов, вписанных в прямоугольные области. Поддержка задания параметров полей для встроенных в документ изображений с использованием разметки WordProcessing; Панель инструментов и интерпретатор для выполнения программ на языке Logo, отличающегося предоставлением простых возможностей по созданию векторной графики. Поддержка добавлена с целью обучения и использования результатов выполнения программ в качестве элементов оформления документов. Задействована легковесная реализация Лого на языке Python (используется встраиваемый в LibreOffice интерпретатор Python-PyUNO); Улучшения табличного процессора Calc: В диалоге импорта текста добавлено сохранение настроек параметров вставки текста в столбцы и копирования неотформатированного текста из буфера обмена; Добавлен элемент меню для редактирования интегрированного в таблицу контента во внешнем приложении; Возможность экспорта цветовых шкал и гистограмм в формат XLSX, в том числе с задействованием расширений Excel 2010+; Максимальный размер несжатых ODF-документов увеличен с 2 до 4 Гб; Реализация механизма поиска элементов по мере ввода во всплывающем диалоге автоматической фильтрации записей (autofilter); Проведена работа по увеличению скорости загрузки документов в форматах ODS и XLSX. Значительно увеличена производительность записи новых элементов в огромных таблицах при замене в результате автокорректировки; Добавлен диалог выбора источника XML-данных для быстрого импорта произвольного XML-контента; Улучшено качество визуализации, печати и PDF-экспорта диаграмм. Обеспечена возможность сохранения отдельных диаграмм в виде изображений в форматах PNG и JPG. Новые правила условного форматирования для определения дат и строк. Поддержка перекрытия условных форматов; Начальная реализация фильтра импорта таблиц из Gnumeric. Пока поддерживается только импорт значений, строк и формул; Поддержка импорта прокэшированных значений из файлов ODS и XLSX; Возможность отображения сохранённого в файлах ODS и XLSX прокэшированного варианта формул, без их пересчёта, что позволяет значительно ускорить открытие больших файлов и обеспечить точное соответствие результатов, наблюдаемых на другом ПК (без влияния особенностей расчёта на разных системах и в разных программах, например, когда файл редактировался в Excel). Управление данным режимом загрузки осуществляется через опцию "Tools ▸ Options ▸ LibreOffice Calc ▸ Formula ▸ Recalculation"; На диаграммах обеспечено автоматическое вращение меток осей, если они перекрываются; При работе со сводными таблицами (Pivot Tables) появилась возможность множественного выбора в поле страницы; Расширение движка для обработки формул: Реализация функции XOR, определённой в спецификации ODF OpenFormula Новый параметр конфигурации, управляющий обработкой пустых строк при их использовании в арифметических выражениях (трактовать такие строки как ноль или нет); Новое дополнение для расчётов стоимости, предоставляющее ряд функции для определения цен - OPT_BARRIER(...) и OPT_TOUCH(...). Пример использования; Переработанная реализация функции RAND() с улучшенным алгоритмом генерации случайных чисел; Новые функции: AVERAGEIF, SUMIFS, AVERAGEIFS, COUNTIFS, IFERROR и IFNA; Улучшения системы для создания презентаций Impress и векторного редактора Draw: В Impress обеспечено запоминание состояния боковой панели; Добавлен элемент меню для редактирования изображений во внешнем приложении; Улучшено качество предварительного просмотра страниц; Значительно увеличена производительность записи и чтения слайдов и рисунков, содержащих большое число составных частей; В Draw добавлена поддержка скруглённых концов стрелок, преобразований сдвига для GraphicObjects и OLE, поддержка сводных изображений с наложением SVG поверх битмапа, добавлена панель для рисования кругов и овалов; На платформе Linux значительно ускорены операции предварительного просмотра мультимедиа контента и встроенного видео; Улучшения базовых подсистем: Для всех отличных от Windows платформ в состав добавлена новая реализация mork-драйвера для доступа к адресной книге почтового клиента Thunderbird, позволяющего организовать интеграцию с Thunderbird из коробки в таких дистрибутивах как Debian и Ubuntu; Добавлена поддержка протокола CMIS, позволяющего организовать доступ к документам, хранимым в таких системах управления контентом, как Alfresco, IBM FileNet P8, Microsoft Sharepoint 2010, Nuxeo, OpenText, SAP NetWeaver Cloud Service; В инфраструктуре сборки многие модули портированы на использование gbuild; На платформе Linux обеспечена поддержка мультимедиа фреймворка GStreamer 1.0, проведён рефакторинг ранее добавленного кода поддержки GStreamer; Сокращён объем используемого кода на Java, мастеры работы с факсами и письмами переписаны на Python; Задействован новый более высокопроизводительный и компактный движок ICU для регулярных выражений, что решило многие проблемы при поиске и замене; В состав включён установщик session-installer для установки на лету недостающих компонентов LibreOffice; В поставку добавлены новые семейства открытых шрифтов Open Sans (Ascender), PT Serif (ParaType), Source Code Pro и Source Sans Pro (Adobe); Улучшение работы фильтров: Увеличена совместимость с ODF-документами, созданными в сторонних офисных пакетах; Прекращена поддержка устаревших форматов StarOffice 1.0-5.0. Поддержка основанных на XML форматов .sxw и .sxi сохранена. Прекращена поддержка экспорта документов Word и Excel 6.0/95; Значительно увеличена скорость загрузки файлов ODS, RTF и XLSX, существенно сокращено время чтения и записи слайдов и рисунков с большим числом элементов; Добавлен фильтр для корректного импорта публикаций в формате пакета Microsoft Publisher; Расширена поддержка формата Visio. В настоящее время поддерживаются все редакции формата, от Visio 1.0 до Microsoft Visio 2013; Улучшение графического интерфейса: Представлена новая техника компоновки виджетов и элементов диалоговых окон. Для редактирования элементов интерфейса может использоваться Glade, при этом изменение виджетов теперь не требует пересборки Libreoffice; Добавлена поддержка просмотра параметров, изменения размера и перепаковки графических изображений. Для изображений возможно как сжатие без потерь (PNG), так и с потерями (JPEG). Для изменения параметров изображений в контекстное меню добавлен пункт Compress Graphics, который отображается в Draw, Impress и Calc; В Writer, Draw и Impress унифицирована опция для сохранения изображений; Увеличено качество отображения изображений в документах; Добавлен диалог для фильтра сглаживания и размытия изображений, позволяющий задать радиус размытия; Поддержка выделения и копирования текста из произвольных диалогов и уведомлений; В находящийся на панели инструментов комбинированный блок для применения стилей добавлена поддержка режима предварительного просмотра выбранного стиля перед его окончательным применением. Поддержка глобального меню при работе LibreOffice в пользовательском окружении Unity. Новый режим позволяет отобразить меню не в локальном окне приложения, а на общей системной панели; Новый менеджер работы с шаблонами. Новый интерфейс управления шаблонами теперь позволяет использовать не только шаблоны LibreOffice, но и шаблоны из других офисных пакетов.