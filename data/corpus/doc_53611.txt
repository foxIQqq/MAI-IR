Уязвимость в OpenZFS, нарушающая обработку прав доступа во FreeBSD

В добавленном в OpenZFS коде для поддержки ОС FreeBSD выявлена критическая уязвимость (CVE-2020-24717), приводящая к нарушению обработки прав доступа. Суть проблемы в том, что права, устанавливаемые для группы, обрабатывались как права для владельца файла. Проблема устранена в обновлении OpenZFS 2.0.0-rc1. Исправление внесено до перевода кодовой базы FreeBSD HEAD на OpenZFS. Проблема была вызвана тем, что все элементы списка управления доступом, установленные для владельца группы (group@) и обычных групп (group:<имя>), делегировались для текущего пользователя. Например, режим доступа 0770 (запись разрешена только для членов группы) обрабатывался как 0777 (запись разрешена для всех пользователей). Похожая ситуация наблюдалась с ACL, например, нижеприведённый ACL становился эквивалентен правам 0777, так как проверка члена группы для builtin_administrators возвращает значение True. # owner: root # group: wheel group:builtin_administrators:rwxpDdaARWcCos:-------:allow Также в порте OpenZFS для FreeBSD выявлена ещё одна проблема с предоставлением прав на переход в каталог (cd), независимо от состояния флага прав на исполнение для каталогов. Вход в каталог был возможен в том числе при явном запрете через ACL ("deny - execute")