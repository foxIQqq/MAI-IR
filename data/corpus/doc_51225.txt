Обновление свободного антивирусного пакета ClamAV 0.101.3

Компания Cisco представила корректирующий выпуск свободного антивирусного пакета ClamAV 0.101.3, в котором устранена уязвимость, позволяющая инициировать отказ в обслуживании через передачу во вложении специально оформленного zip-архива. Проблема является вариантом нерекурсивной "zip-бомбы", распаковка которой требует очень большого времени и ресурсов. Суть метода в размещении в архиве данных, позволяющих добиться максимальной для формата zip степени сжатия - около 28 млн раз. Например, специально подготовленный zip-файл размером 10 Мб приведёт к распаковке около 281 Тб данных, а 46 Мб - 4.5 Пб. Кроме того в новом выпуске обновлена встроенная библиотека libmspack, в которой устранено переполнение буфера (CVE-2019-1010305), приводящее к утечке данных при открытии специально оформленного chm-файла. В то же время представлена бета-версия новой ветки ClamAV 0.102, в которой функциональность прозрачной проверки открываемых файлов (on-access scanning, проверка в момент открытия файла) перенесена из clamd в отдельный процесс clamonacc, реализованный по аналогии с clamdscan и clamav-milter. Указанное изменение позволило организовать работу clamd под обычным пользователем без необходимости получения root-привилегий. В новой ветке также добавлена поддержка архивов egg (ESTsoft) и значительно переработана программа freshclam, в которой появилась поддержка HTTPS и возможность работы с зеркалами, обрабатывающими запросы на сетевых портах, отличных от 80.