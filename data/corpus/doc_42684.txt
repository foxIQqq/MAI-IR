Уязвимость в утилите BSD patch и TCP-стеке FreeBSD

В утилите BSD patch, поставляемой в составе FreeBSD 10, выявлена критическая уязвимость, позволяющая организовать выполнение произвольных shell-команд, при обработке определённым образом сформированного patch-файла. Проблема проявляется только в ветке FreeBSD 10.x, в которой начал поставляться вариант утилиты patch под лицензией BSD. Причиной уязвимости является ошибка в разборе интегрируемых в patch-файлы команд систем управления версиями SCCS и RCS, к которым осуществляется обращение до применения патча, в случае если оригинальный файл отсутствует. Кроме того, во всех поддерживаемых версиях FreeBSD устранена уязвимость в TCP-стеке, которую можно использовать для инициирования DoS-атаки через исчерпание доступных ресурсов. Уязвимость вызвана некорректным распределением лимитов при выделении структур mbuf для виртуальных экземпляров сетевого стека (VNET) и проявляется на системах с большим числом VNET (более 16).