Уязвимость в гипервизоре bhyve, позволяющая получить доступ к хост-системе

Разработчики FreeBSD сообщили об устранении уязвимости (CVE-2018-17160) в гипервизоре bhyve, которая позволяла получить контроль над хост-системой из гостевого окружения. Эксплуатация уязвимости производится через манипуляции с образом прошивки на стороне гостевой системы и потенциально может привести к выполнению кода в контексте хост-системы с правами root. Уязвимость затрагивает все поддерживаемые ветки FreeBSD (stable/11). Проблема вызвана некорректной проверкой допустимых границ при помещении данных в буфер и присутствует в реализации фонового процесса bhyve, обеспечивающего эмуляцию виртуализированных устройств для гостевых окружений. В качестве обходного пути для блокирования уязвимости можно использовать для загрузки гостевых систем bhyveload или grub2-bhyve, которые не активируют для гостевых систем код "device model", позволяющий манипулировать загрузкой прошивок.