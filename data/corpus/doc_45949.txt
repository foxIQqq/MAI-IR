В маршрутизаторах Netgear выявлена уязвимость, позволяющая узнать пароль входа

В беспроводных маршрутизаторах Netgear выявлена очередная критическая уязвимость (CVE-2017-5521), позволяющая без аутентификации узнать пароль входа с правами администратора, отправив специальный запрос к скрипту passwordrecovered.cgi. Проблема вызвана тем, что при определённых условиях скрипт выдаёт информацию о пароле, независимо от прохождения аутентификации и заданных в запросе параметров. Компания Netgear подтвердила наличие уязвимости в более 30 моделей своих устройств и уже выпустила обновление прошивки для 18 моделей. Уязвимость может быть атакована из локальной сети, а при включении интерфейса удалённого управления и через интернет. Компания Netgear заявляет о том, что web-интерфейс по умолчанию отключен для внешней сети, но выявивший уязвимость исследователь утверждает, что по его данным в глобальной сети имеется доступ к сотням тысяч уязвимых устройств (вероятно, web-интерфейс включают провайдеры, предустанавливающие оборудование клиентам). Проблема проявляется только при выключенной функции восстановления пароля (по умолчанию отключена и требует задания контрольных вопросов и ответов), поэтому в качестве обходной меры борьбы с уязвимостью рекомендует в web-интерфейсе включить поддержку восстановления пароля. Для проверки наличия уязвимости опубликован прототип эксплоита. По сути достаточно отправить запрос "http://router/passwordrecovered.cgi?id=TOKEN". Значение TOKEN можно узнать на странице аутентификации после неправильного ввода пароля ("http://router/..../unauth.cgi?id=TOKEN"). Если в настройках включена функция восстановления пароля при обращении к passwordrecovered.cgi будет выведены форма с вопросами для восстановления пароля, а если не включена будет сразу показан пароль. Интересно, что компания Netgear была уведомлена об уязвимости ещё 4 июня 2016 года, но обновления пока выпущены только примерно для половины уязвимых устройств.