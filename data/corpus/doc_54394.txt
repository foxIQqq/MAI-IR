Обновление sudo 1.9.5 с устранением уязвимостей

Доступен новый выпуск утилиты sudo 1.9.5, используемой для организации выполнения команд от имени других пользователей. В новой версии устранено шесть проблем с безопасностью, из которых выделяются две уязвимости: CVE-2021-23240 - уязвимость в утилите sudoedit, применяемой для предоставления доступа к редактированию файлов, принадлежащих другим пользователям (в отличие от запуска редактора через sudo, утилита sudoedit запускает редактор без повышения привилегий и позволяет отредактировать копию файла с правами текущего пользователя, а потом заменить целевой файл и вернуть исходные параметры доступа). Уязвимость проявляется на системах с поддержкой SELinux RBAC и позволяет сменить владельца произвольного файла в системе на пользователя, которому принадлежит целевой файл, открытый для редактирования. Проблема вызвана состоянием гонки - пользователь может подменить доступный для редактирования временный файл на символическую ссылку в момент, когда редактирование завершено, но прежние права на целевой файл ещё не возвращены, после чего владелец будет изменён для файла, на который указывает символическая ссылка. В качестве обходного метода защиты достаточно включения режима /proc/sys/fs/protected_symlinks = 1. CVE-2021-23239 - утечка информации при использовании утилиты sudoedit. Через манипуляцию c символическими ссылками можно определить существование каталогов в иерархии, к которой пользователь не имеет доступа.