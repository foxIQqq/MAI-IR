Манипуляции с BMC позволяют контролировать серверы IBM Cloud после смены арендатора

В серверах IBM Cloud выявлена проблема с безопасностью, позволяющая злоумышленнику заменить прошивку BMC-контроллера (Baseboard Management Controller). В контексте предоставления серверов IBM Cloud во временную аренду злоумышленник может оставить бэкдор или закладку в прошивке BMC и сохранить контроль за сервером после его освобождения, очистки и смены арендатора. Услуга "IBM Cloud Bare Metal" подразумевает предоставление в краткосрочную аренду полноценных серверов с полным доступом к аппаратному обеспечению. Поддерживается как почасовая, так и помесячная аренда. Т.е. атакующий может арендовать сервер на час, заменить прошивку BMC и получить доступ к системам последующих арендаторов. Возможность атаки продемонстрирована на используемых в IBM Cloud серверах IBM SoftLayer, построенных на основе плат Supermicro. Утверждается, что выявленная проблема с сохранением доступа через модификацию прошивок не специфична для IBM Cloud и также может проявляться в других аналогичных облачных сервисах. Для программной смены прошивки в BMC на платформе Supermicro использовалась особенность данных плат, из-за которой перед установкой новой прошивки не применялась проверка целостности образа прошивки по цифровой подписи. Кроме того, для замены прошивки могли быть использованы известные уязвимости, позволяющие запустить код в контексте BMC или установить обновление прошивки в обход проверки цифровой подписи производителя. Более того, в процессе экспериментальной атаки выяснилось, что можно обойтись и без смены прошивки, так как после смены арендатора не очищались логи BMC и сохранялся прежний пароль доступа к BMC-интерфейсу. Для блокирования проблемы компания IBM ввела в практику не только очистку дисков перед передачей сервера новому арендатору, но и перезаливку прошивки BMC, очистку всех логов и генерацию индивидуального пароля доступа к BMC для каждого клиента. Напомним, что BMC представляет собой устанавливаемый в серверах специализированный контроллер, имеющий свой CPU, память, хранилище и интерфейсы опроса датчиков, который предоставляет низкоуровневый интерфейс для мониторинга и управления серверным оборудованием. При помощи BMC независимо от работающей на сервере операционной системы можно отслеживать состояние датчиков, управлять питанием, прошивками и дисками, организовать удалённую загрузку по сети, обеспечить работу консоли удалённого доступа и т.п.