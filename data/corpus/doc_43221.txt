Выпуск серверной JavaScript-платформы Node.js 5.0

Состоялся релиз Node.js 5.0, новой стабильной ветки платформы для выполнения высокопроизводительных сетевых приложений на языке JavaScript. Ветка 5.0 включает порцию новых возможностей и будет развиваться параллельно c веткой Node.js 4.x, которая отнесена к категории стабильных LTS-выпусков с длительным сроком поддержки (30 месяцев). Время поддержки Node.js 5.x составит 8 месяцев. В дальнейшем, в апреле 2016 года планируется выпустить Node.js 6.0, который получит статус LTS. Выпуск Node.js 5.0 рекомендуется тем, кто желает оперативно получить доступ к новой функциональности, имеет возможность безболезненно провести обновление и готов разбираться с возможными негативными последствиями из-за нарушений обратной совместимости. LTS-ветки предлагаются для сложных промышленных внедрений, крупных предприятий и тех, для кого стабильность имеет первоочередное значение. Из новшеств Node.js 5.0 можно отметить переход на новый выпуск движка V8 4.6.85.25, что требует пересборки установленных сторонних дополнений. Пакетный менеджер npm обновлён до выпуска 3.3.6. Внесены нарушающие совместимость изменения в объекты buffer (удалены типы кодировок 'raw' и 'raws') и console (изменён формат вывода console.time), прекращена поддержка вызовов require.paths, util.p(), util.inherits() и require.registerExtension(), ужесточены требования к именам методов и заголовков HTTP, прекращена поддержка модуля _linklist. В модуль tls добавлена поддержка ALPN, минимальный размер ключа DH для tls.connect() увеличен до 1024 бит. Добавлена возможность передачи файловых дескрипторов в вызовы fs.readFile*(), fs.writeFile*() и fs.appendFile*(). Платформа Node.js может быть использована как для серверного сопровождения работы Web-приложений, так и для создания обычных клиентских и серверных сетевых программ. Для расширения функциональности приложений для Node.js подготовлена большая коллекция модулей, в которой можно найти модули с реализацией серверов и клиентов HTTP, SMTP, XMPP, DNS, FTP, IMAP, POP3, модули для интеграции с различными web-фреймворками, обработчики WebSocket и Ajax, коннекторы к СУБД (MySQL, PostgreSQL, SQLite, MongoDB), шаблонизаторы, CSS-движки, реализации криптоалгоритмов и систем авторизации (OAuth), XML-парсеры. Для обеспечения обработки большого числа параллельных запросов Node.js задействует асинхронную модель запуска кода, основанную на обработке событий в неблокирующем режиме и определении callback-обработчиков. В качестве способов мультиплексирования соединений поддерживаются такие методы, как epoll, kqueue, /dev/poll и select. Для мультиплексирования соединений используется библиотека libuv, которая является надстройкой над libev в системах Unix и над IOCP в Windows. Для создания пула потоков (thread pool) задействована библиотека libeio, для выполнения DNS-запросов в неблокирующем режиме интегрирован c-ares. Все системные вызовы, вызывающие блокирование, выполняются внутри пула потоков и затем, как и обработчики сигналов, передают результат своей работы обратно через неименованный канал (pipe). Выполнение JavaScript-кода обеспечивается через задействование разработанного компанией Google движка V8. По своей сути Node.js похож на фреймворки Perl AnyEvent, Ruby Event Machine, Python Twisted и реализацию событий в Tcl, но цикл обработки событий (event loop) в Node.js скрыт от разработчика и напоминает обработку событий в web-приложении, работающем в браузере. При написании приложений для node.js необходимо учитывать специфику событийно-ориентированного программирования, например, вместо выполнения "var result = db.query("select..");" с ожиданием завершения работы и последующей обработкой результатов, в Node.js использует принцип асинхронного выполнения, т.е. код трансформируется в "db.query("select..", function (result) {обработка результата});", при котором управление мгновенно перейдёт к дальнейшему коду, а результат запроса будет обработан по мере поступления данных. Ни одна функция в Node.js не должна напрямую выполнять операции ввода/вывода - для получения данных с диска, от другого процесса или из сети требуется установка callback-обработчика.