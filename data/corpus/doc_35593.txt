DoS атака против файловой системы Btrfs

Опубликована техника DoS-атаки на файловую систему Btrfs, манипулирующая коллизиями хэшей имён файлов. При создании примерно 500 файлов со случайными именами, их удаление происходит почти мгновенно. Но если выбрать имена файлов, вызывающих коллизии при их хэшировании, при удалении система начинает тратить чрезмерные ресурсы. Например, создав 500 файлов с именами, которые сводятся к 55 хэш-значениям crc32c (метод хэширования элементов в индексе содержимого директории Btrfs), их удаление заняло настолько много времени, что в ходе эксперимента пришлось принудительно завершить процесс после того как его выполнение заняло 220 минут. При попытке создать файлы, имена которых соответствуют одному хэшу, таких файлов удалось создать не более 61, после чего процесс c ошибкой завершал своё выполнение. Подобную особенность злоумышленник может использовать для блокирования создания определённых имён файлов в общедоступных директориях. Патч с устранением указанных проблем планируется добавить в состав ядра Linux 3.8.