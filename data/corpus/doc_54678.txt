Уязвимость в wpa_supplicant, не исключающая удалённое выполнение кода

В пакете wpa_supplicant, используемом для организации подключения к беспроводной сети во многих дистрибутивах GNU/Linux, NetBSD и Android, выявлена уязвимость (CVE-2021-27803), которая потенциально может быть использована для выполнения кода злоумышленника при обработке специально оформленных управляющих кадров Wi-Fi Direct (Wi-Fi P2P). Для проведения атаки злоумышленник должен находиться в пределах досягаемости беспроводной сети, чтобы отправить жертве специально оформленный набор кадров. Проблема вызвана ошибкой в обработчике Wi-Fi P2P, из-за которой обработка некорректно оформленного кадра PDR (Provision Discovery Request) может привести к состоянию, при котором запись о старом P2P-пире будет удалена и информация будет записана в уже освобождённый блок памяти (use-after-free). Проблеме подвержены выпуски wpa_supplicant с 1.0 по 2.9, собранные с опцией CONFIG_P2P. Уязвимость будет устранена в выпуске wpa_supplicant 2.10. В дистрибутивах обновление с исправлением опубликовано для Fedora Linux. Статус публикации обновлений другими дистрибутивами можно проследить на страницах: Debian, Ubuntu, RHEL, SUSE, Arch Linux. В качестве обходного пути блокирования уязвимости достаточно отключить поддержку P2P, указав в настройках "p2p_disabled=1" или выполнив в CLI-интерфейсе команду "P2P_SET disabled 1".