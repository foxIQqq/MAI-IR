Уязвимость в GNU Screen 4.5.0

В недавно вышедшей версии GNU screen 4.5.0 обнаружена уязвимость (CVE-2017-5618), позволяющая переписать произвольными данными или создать файл с привилегиями root, в случае установки screen с флагом suid root. В большинстве дистрибутивов, например в Debian, Ubuntu, RHEL/CentOS, SUSE/openSUSE, утилита screen не имеет бита setuid, однако имеет setgid для группы utmp. Это уменьшает опасность, однако оставляет возможность перезаписи файлов /var/log/{btmp,wtmp,lastlog}*. Уязвимость была внесена при добавлении новой опции "-L", позволяющей указать файл для записи журнала. Открытие файла производится на стадии до понижения привилегий, и если исполняемый файл screen принадлежит пользователю root и имеет setuid-бит, любой пользователь получает возможность перезаписи файла с правами root. Эксплуатация уязвимости сводится к запуску screen с указанием нужного файла в опции "-L".