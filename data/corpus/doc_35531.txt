Компания NVIDIA представила код для альтернативной организации поддержки PRIME

Аарон Плэттнер (Aaron Plattner), один из ведущих разработчиков проприетарных драйверов NVIDIA, опубликовал набор патчей с попыткой абстрагирования использования в драйверах функций технологии PRIME, позволяющей организовать совместное обращение разных драйверов к общему буферу, что необходимо для реализации возможности горячего переключения вывода между разными видеокартами. Код оформлен в виде небольших опциональных функций-хелперов, которые позволяют использовать абстрактный набор простых вызовов (drm_gem_prime_import и drm_gem_prime_export), независимых от низкоуровневой реализации поддержки PRIME (пока доступна только реализация поверх DMA-BUF). Поддержка хелперов обеспечена для drm-модулей nouveau, radeon и exynos. Указанные вызовы помогут организовать взаимодействие свободных драйверов с проприетарным драйвером NVIDIA без прямого обращения к API DMA-BUF, что позволит избежать нарушения лицензии GPL (стандартные функции DMA-BUF отнесены в ядре Linux к категории внутренних интерфейсов, которые экспортируются в группе EXPORT_SYMBOL_GPL, ограничивающей возможность использования только для модулей ядра, распространяемых под лицензией GPL).