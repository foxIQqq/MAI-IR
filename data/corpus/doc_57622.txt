В ядре Linux выявлены эксплуатируемые уязвимости в POSIX CPU timer, cls_route и nf_tables

В ядре Linux выявлено несколько уязвимостей, вызванных обращением к уже освобождённым областям памяти и позволяющих локальному пользователю повысить свои привилегии в системе. Для всех рассматриваемых проблем созданы рабочие прототипы эксплоитов, которые будут опубликованы через неделю после публикации информации об уязвимостях. Патчи с устранением проблем отправлены разработчикам ядра Linux. CVE-2022-2588 - уязвимость в реализации фильтра cls_route, вызванная ошибкой, из-за которой при обработке нулевого дескриптора старый фильтр не удалялся из хэш-таблицы до очистки памяти. Уязвимость присутствует по крайней мере начиная с выпуска 2.6.12-rc2 (2.6.12-rc2 — первый выпуск в Git. Большая часть кода, которую git blame помечает как добавленную в этом выпуске, в действительности, является «доисторической», т.е. добавленной во времена BitKeeper или раньше). Для проведения атаки требуется наличие прав CAP_NET_ADMIN, которые можно получить при наличии доступа к созданию сетевых пространств имён (network namespace) или пространств имён идентификаторов пользователя (user namespace). В качестве обходного пути защиты можно отключить модуль cls_route через добавление в modprobe.conf строки 'install cls_route /bin/true'. CVE-2022-2586 - уязвимость в подсистеме netfilter в модуле nf_tables, обеспечивающем работу пакетного фильтра nftables. Проблема вызвана тем, что объект nft может ссылаться на set-список в другой таблице, что приводит к обращению к освобождённой области памяти после удаления данной таблицы. Уязвимость присутствует начиная с выпуска 3.16-rc1. Для проведения атаки требуется наличие прав CAP_NET_ADMIN, которые можно получить при наличии доступа к созданию сетевых пространств имён (network namespace) или пространств имён идентификаторов пользователя (user namespace). CVE-2022-2585 - уязвимость в POSIX CPU timer, вызванная тем, что при вызове из нелидирующей нити структура таймера остаётся в списке, несмотря на очистку выделенной для хранения памяти. Уязвимость присутствует начиная с выпуска 3.16-rc1.