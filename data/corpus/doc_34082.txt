Опасные уязвимости в Xen и FreeBSD, проявляющиеся на 64-разрядных CPU Intel

В гипервизоре Xen найдена критическая уязвимость позволяющая пользователю гостевой системы организовать выполнение кода на стороне управляющей хост-системы. Проблеме подвержены 64-разрядные хост-системы на базе процессоров Intel. Эксплуатация уязвимости возможна только из паравиртуализированных гостевых систем, базирующихся на 64-разрядном ядре. После успешной эксплуатации привилегированный пользователь гостевой системы, а в некоторых конфигурациях и непривилегированный пользователь гостевой ОС, может получить контроль над хост-системой. Проблема связана с возможностью создания условий для генерации исключения в неподходящем состоянии процессора в процессе возврата из системного вызова (SYSRET). Системы с процессорами AMD вышеотмеченной уязвимости не подвержены, тем не менее, системы с некоторыми старыми моделями 64-разрядных CPU AMD Athlon 64 и AMD Opteron, в которых не устранена 121 ошибка в микрокоде, могут быть использованы для инициирования отказа в обслуживании (блокирование работы хост-системы). Кроме того, в Xen устранена ещё одна уязвимость, дающая возможность пользователю 32- или 64-разрядной паравиртуализированной гостевой системы инициировать крах данного гостевого окружения. Исправления для всех трёх упомянутых уязвимостей пока доступны в виде патчей. Проследить за выходом обновлений популярных дистрибутивов можно на данных страницах: Ubuntu, Mandriva, Gentoo, openSUSE, CentOS, Scientific Linux, Fedora, RHEL и Debian. Во всех поддерживаемых версиях FreeBSD устранена идентичная по своей сути уязвимость, позволяющая локальному пользователю выполнить свой код с привилегиями ядра системы. Проблема проявляется только в сборке FreeBSD/amd64 на 64-разрядных процессорах Intel. FreeBSD/amd64 на системах с процессорами AMD, 32-разрядная сборка FreeBSD/i386, а также сборки FreeBSD для других процессорных архитектур уязвимости не подвержены. Одновременно выпущено уведомление об исправлении уязвимости во входящем в базовую поставку FreeBSD DNS-сервере BIND. Проблема проявляется при обработке полей rdata нулевой длины и выражается в крахе процесса или утечке областей памяти сервера. Кроме того, сообщается об устранении серьёзной ошибки в IPv6-стеке FreeBSD, которая может привести к краху ядра при большой сетевой нагрузке. Стек IPv4 данной проблеме не подвержен.