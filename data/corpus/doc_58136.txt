Уязвимость в реализации протокола MCTP для Linux, позволяющая повысить свои привилегии

В ядре Linux выявлена уязвимость (CVE-2022-3977), которая потенциально может использоваться локальным пользователем для повышения своих привилегии в системе. Уязвимость проявляется начиная с ядра 5.18 и устранена в ветке 6.1. Появление исправления в дистрибутивах можно проследить на страницах: Debian, Ubuntu, Gentoo, RHEL, SUSE, Arch. Уязвимость присутствует в реализации протокола MCTP (Management Component Transport Protocol), применяемого для взаимодействия управляющих контроллеров и связанных с ними устройств. Уязвимость вызвана состоянием гонки в функции mctp_sk_unhash(), которое приводит к обращению к уже освобождённой области памяти (use-after-free) при отправке ioctl-запроса DROPTAG одновременно с закрытием сокета.