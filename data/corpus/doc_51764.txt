10 уязвимостей в гипервизоре Xen

Опубликованы сведения о 10 уязвимостях в гипервизоре Xen, из которых пять (CVE-2019-17341, CVE-2019-17342, CVE-2019-17340, CVE-2019-17346, CVE-2019-17343) потенциально позволяют выйти за пределы текущего гостевого окружения и повысить свои привилегии, одна уязвимость (CVE-2019-17347) даёт возможность непривилегированному процессу получить контроль над процессами других пользователей в той же гостевой системе, оставшиеся четыре (CVE-2019-17344, CVE-2019-17345, CVE-2019-17348, CVE-2019-17351) уязвимости позволяют вызвать отказ в обслуживании (крах хост-окружения). Проблемы устранены в выпусках Xen 4.12.1, 4.11.2 и 4.10.4. CVE-2019-17341 - возможность из подконтрольной атакующему гостевой системы получить доступ на уровне гипервизора. Проблема проявляется только на системах x86 и может быть совершена из гостевых систем, работающих в режиме паравиртуализации (PV), при пробросе в работающую гостевую систему нового PCI-устройства. В гостевых системах, работающих в режимах HVM и PVH, уязвимость не проявляется; CVE-2019-17340 - утечка памяти, потенциально позволяющая повысить свои привилегии или получить доступ к данным других гостевых систем. Проблема проявляется только на хостах с более чем 16 Тб ОЗУ в 64-разрядных системах и 168 Гб в 32-разрядных. Уязвимость может быть эксплуатирована только из гостевых систем в режиме PV (в режимах HVM и PVH при работе через libxl уязвимость не проявляется); CVE-2019-17346 - уязвимость при использовании PCID (Process Context Identifiers) для повышения производительности защиты от атак Meltdown позволяет получить доступ к данным других гостевых систем и потенциально повысить свои привилегии. Уязвимость может быть эксплуатирована только из гостевых систем в режиме PV на системах x86 (проблема не проявляется в режимах HVM и PVH, а также в конфигурациях, в которых нет гостевых систем со включенным PCID (PCID активируется по умолчанию)); CVE-2019-17342 - проблема в реализации гипервызова XENMEM_exchange позволяет повысить свои привилегии в окружениях с только одной гостевой системой. Уязвимость может быть эксплуатирована только из гостевых систем в режиме PV (в режимах HVM и PVH уязвимость не проявляется); CVE-2019-17343 - некорректный маппинг в IOMMU даёт возможность при наличии доступа из гостевой системы к физическому устройству использовать DMA для изменения собственной таблицы страниц памяти и получения доступа на уровне хоста. Уязвимость проявляется только в гостевых системах в режиме PV при наличии прав для проброса PCI-устройств.