Компания Collabora представила Wayland-драйвер для Wine

Компания Collabora представила рабочий прототип Wayland-драйвера, позволяющего избавить Wine от привязки к X11 и дать возможность играть в Windows-игры в окружениях на базе Wayland. Код драйвера предложен для обсуждения разработчиками Wine и рассмотрения возможности его включения в основной состав Wine. Драйвер позволяет отказаться от привязки к X11 в игровом Linux-окружении и перейти на использование графической подсистемы на базе протокола Wayland, который обеспечивает более высокую безопасность и производительность. На текущем этапе разработки драйвер позволяет запускать приложения, использующие GDI и OpenGL/DirectX, напрямую в композитном сервере Wayland, без применения прослойки XWayland. Поддерживаются такие операции, как изменения размеров и состояния окна, управление мышью, ввод с клавиатуры (без смены раскладки), вывод на один монитор, отображение меню и всплывающих подсказок. Драйвер также включает некоторые ухищрения для решения проблем с позиционированием окон - Win32-приложения, как и X11, используют общую плоскую модель координат, в то время как Wayland не позволяет приложениям управлять абсолютной позицией на экране. Драйвер симулирует плоское пространство через закрепление координат к одной поверхности Wayland. Драйвер Collabora пока не поддерживает Vulkan, но для данного API сообществом развивается другой драйвер - wine-wayland, сфокусированный на связке Wayland и Vulkan. Для работы драйвера wine-wayland требуется система с GPU, поддерживающим графический API Vulkan, а также пакет Mesa 20.1+, собранный с поддержкой Wayland и Vulkan, SDL и Faudio. Среди протестированных композитных менеджеров отмечены Weston и Sway. Но разработчик этого драйвера заявил, что это отдельный проект, который он не собирается предлагать добавлять в основной код Wine. Драйвер Collabora протестирован на Windows-сборках таких приложений, как Supertuxkart, 010Editor, Firefox, Stellarium, Battle For Wesnoth, GIMP и Unigine Valley. В драйвере wine-wayland подтверждена работа следующих игр: ABZU Dirt 3 Subnautica Rebel Galaxy Endless Space Age of Wonders 3 Stellaris EU4 Path of Exile Pathfinder Kingmaker Crusader Kings 2 Mutant Year Zero Tropico 6 Wasteland 2 Torchlight 1 Dungeons 3