Уязвимость в Xen, позволяющая получить доступ к ресурсам хост-системы

В системе виртуализации Xen найдена уязвимость, дающая возможность администратору гостевого окружения, имеющего доступ к графической консоли гостевой системы (VNC или SDL) , перейти в режим мониторинга QEMU, через который можно добраться до ресурсов хост-системы и других гостевых окружений. Используя данные ресурсы атакующий может теоретически получить повышенные привилегии на уровне хост-системы. Гостевые системы, работающие в режиме паравиртуализации без графической консоли, проблеме не подвержены. Настройка "monitor=no" или "monitor=0" не влияет на проявление уязвимости. Уязвимость проявляется при использовании xend/xm, libxl/xl и libvirt во всех версиях Xen, начиная с 4.0, за исключением конфигураций на базе Xen Cloud Platform. Для перехода в режим мониторинга QEMU достаточно нажать CTRL+ALT+2 (перебирая цифры с 2 до 6) до появления приглашения "QEMU version monitor". В качестве обходного варианта для защиты можно отключить консоль мониторинга QEMU через команды 'device_model_args=["-monitor","null"]' для xl в Xen 4.1 или 'monitor_path="null"' для xend, для libvirt проблема решается только патчем.