Выпуск Samba 4.18.0

Представлен релиз Samba 4.18.0, продолживший развитие ветки Samba 4 с полноценной реализацией контроллера домена и сервиса Active Directory, совместимого с реализацией Windows 2008 и способного обслуживать все поддерживаемые Microsoft версии Windows-клиентов, в том числе Windows 11. Samba 4 является многофункциональным серверным продуктом, предоставляющим также реализацию файлового сервера, сервиса печати и сервера идентификации (winbind). Ключевые изменения в Samba 4.18: Продолжена работа по устранению регрессий в производительности нагруженных SMB-серверов, появившихся в результате добавления защиты от уязвимостей, манипулирующих символическими ссылками. В дополнение к проведённой в прошлом выпуске работе по сокращению системных вызовов при проверке имени каталога и прекращению использования wakeup-событий при обработке конкурирующих операций, в версии 4.18 примерно в три раза снижены накладные расходы при обработке блокировок для конкурирующих операций с файловыми путями. В итоге производительность операций открытия и закрытия файлов доведена до уровня Samba 4.12. В утилите samba-tool реализован вывод более лаконичных и точных сообщений об ошибках. Вместо вывода трассировки вызовов с указанием позиции в коде, в которой возникла проблема, что не всегда позволяло сразу понять в чём дело, в новой версии вывод ограничен описанием причины ошибки (например, некорректное имя пользователя или пароль, неверное имя файла с БД LDB, отсутствие имени в DNS, недоступность сети, неверные аргументы командной строки и т.п.). При выявлении нераспознанной проблемы продолжает выводиться полная трассировка Python-стека, которую также можно получить при указании опции '-d3'. Данная информация может потребоваться для поиска причины проблемы в Web или добавления в отправляемое уведомление об ошибке. Во всех командах samba-tool обеспечена поддержка опции "--color=yes|no|auto" для управления подсветкой вывода. В режиме "--color=auto" выделение цветом используется только при выводе на терминал. Вместо 'yes' разрешено указание значений 'always' и 'force', вместо 'no' - 'never' и 'none', вместо 'auto' - 'tty' и 'if-tty'. Добавлена поддержка переменной окружения NO_COLOR для отключения подсветки вывода, в ситуациях когда используются ANSI-коды цветов или действует режим "--color=auto". В samba-tool добавлена новая команда "dsacl delete" для удаления записей в списках управления доступом (ACE, Access Сontrol Entry). В команду wbinfo добавлена опция "--change-secret-at=<DOMAIN CONTROLLER>" для указания контроллера домена для которого необходимо выполнить операцию смены пароля. В smb.conf добавлен новый параметр "acl_xattr:security_acl_name" для изменения имени расширенного атрибута (xattr), применяемого для хранения NT ACL. По умолчанию к файлам и каталогам прикрепляется атрибут security.NTACL, доступ к которому запрещён для обычных пользователей. При изменении имени атрибута хранения ACL, он не будет отдаваться через SMB, но станет локально доступен любым пользователям, что требует понимания возможного негативного влияния на безопасность. Добавлена поддержка синхронизации хэшей паролей между доменом Active Directory на базе Samba и облаком Azure Active Directory (Office365).