Компания Cisco выпустила свободный антивирусный пакет ClamAV 1.2.0

После четырёх месяцев разработки компания Cisco опубликовала выпуск свободного антивирусного пакета ClamAV 1.2.0. Проект перешёл в руки Cisco в 2013 году после покупки компании Sourcefire, развивающей ClamAV и Snort. Код проекта распространяется под лицензией GPLv2. Ветка 1.2.0 отнесена к категории обычных (не LTS), обновления к которым публикуются как минимум в течение 4 месяцев после выхода первого релиза следующей ветки. Возможность загрузки базы сигнатур для не-LTS веток также обеспечивается как минимум ещё 4 месяца после выпуска следующей ветки. Ключевые улучшения в ClamAV 1.2: Добавлена возможность извлечения данных из образов в формате UDF (Universal Disk Format). Поддерживаются UDF-файлы с метаданными BEA01 (Beginning Extended Area Descriptor). Добавлен параметр конфигурации CacheSize и опция командной строки "--cache-size" для настройки размера кэша проверенных файлов. Увеличение кэша может увеличить производительность сканирования, но приводит к повышению потребления оперативной памяти. Добавлен сервис systemd для периодического обновления базы вирусных сигнатур при помощи freshclam, без запуска данной утилиты в фоновом режиме. В сервисе поддерживается ведение лога, редактирование расписания запуска через команду "systemctl edit" и аудит состояния: sudo systemctl enable --now clamav-freshclam-once.timer sudo systemctl edit clamav-freshclam-once.timer sudo systemctl list-timers sudo systemctl status clamav-freshclam-once.timer sudo systemctl status clamav-freshclam-once.service journalctl -u clamav-freshclam-once.service Параметр MaxScanSize, ограничивающий максимальный размер проверяемых данных при сканировании файла или архива, теперь может принимать значение больше 4 ГБ. По умолчанию по-прежнему выставлен лимит в 2 ГБ (для вывода предупреждения в случае игнорирования файлов по размеру можно использовать опцию "--alert-exceeds-max" или настройку "AlertExceedsMax"). Во всех настройках, в которых указываются размеры файлов, добавлена возможность использования в значениях окончаний "G" и "g" для указания гигабайтов, например, можно выставить "MaxScanSize 10G" или запустить ClamScan c опцией "--max-scansize=10g". В приложении Freshclam добавлена возможность использования PEM-файла с клиентским сертификатом для аутентификации при подключении к непубличному зеркалу. Для подключения сертификата добавлены переменные окружения FRESHCLAM_CLIENT_CERT, FRESHCLAM_CLIENT_KEY и FRESHCLAM_CLIENT_KEY_PASSWD. Одновременно сформированы корректирующие версии прошлых веток ClamAV 1.1.2, 1.0.3 и 0.103.10, в которых обновлена библиотека "libclamunrar", основанная на коде проекта unrar от разработчиков архиватора WinRAR, в котором недавно была выявлена критическая уязвимость (CVE-2023-40477), позволяющая добиться выполнения кода при обработке специально оформленных rar-архивов. Уязвимость затрагивала проприетарный Windows-продукт WinRAR, но пока нет подтверждения, что она не касается библиотеки unrar, включающей код от тех же разработчиков.