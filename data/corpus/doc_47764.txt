Злоумышленники устроили MitM-атаку на компанию Fox-IT, захватив её домен

Специализирующаяся на компьютерной безопасности компания Fox-IT, развивающая проект OpenVPN-NL (вариант OpenVPN с усиленной защитой), раскрыла информацию о произошедшей в сентябре компрометации инфраструктуры. В течение примерно 10 часов атакующие полностью контролировали трафик к клиентскому порталу компании, включая обращения по HTTPS. В результате инцидента атакующие смогли получить доступ к учётной записи Fox-IT на сайте регистратора доменов и перевести обслуживание домена fox-it.com на свой DNS-сервер. Каким образом удалось получить доступ к интерфейсу регистратора остаётся неясным, так как представители Fox-IT уверяют, что использовали для доступа надёжный пароль, не подверженный словарному перебору. При этом они согласились, что по недосмотру на сайте регистратора не была включена двухфакторная аутентификация (домен был зарегистрирован 18 лет назад, а опция двухфакторной аутентификации появилась у регистратора относительно недавно). Получив контроль за доменом, атакующие на несколько минут перенаправили электронную почту на свой почтовый сервер (для подтверждения владения доменом) и оперативно получили новый SSL-сертификат для домена fox-it.com. Затем они направили домен clientportal.fox-it.com на свой сервер, на котором был организован перехват всего трафика. Для скрытия следов после перехвата запросы транслировались на оригинальный сервер, создавая у пользователей иллюзию, что они обращаются к легитимному сайту. В качестве мер для противостояния подобным атакам рекомендуется ввести в практику плановую смену паролей и включить двухфакторную аутентификацию у регистратора или перейти к регистратору, не допускающему смену параметров домена через web-интерфейс. Также рекомендуется наладить мониторинг изменений SSL-сертификатов через механизм Certificate Transparency, который базируется на ведении публичного лога всех выданных сертификатов, не позволяющего удостоверяющему центру сгенерировать сертификат без отражения в этом логе и дающего возможность владельцам и пользователям проводить аудит изменений.