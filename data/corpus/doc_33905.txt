Релиз сканера сетевой безопасности Nmap 6

После трёх лет разработки анонсирован выход новой ветки сканера сетевой безопасности - Nmap 6, предназначенного для проведения аудита сети и выявления активных сетевых сервисов. В процессе подготовки новой версии внесено около четырёх тысяч изменений, добавлено 289 новых NSE-скриптов, добавлено около 1500 сигнатур для определения операционных систем (общее число сигнатур 3572), число сигнатур для определения версий приложений доведено до 8165, обеспечена поддержка 862 протоколов. В новой версии расширены возможности движка NSE (Nmap Scripting Engine), обеспечена полная поддержка IPv6, улучшены средства для сканирования web-сервисов, увеличена скорость сканирования и добавлена утилита Nping. Среди наиболее важных новшеств Nmap 6: Расширены возможности движка Nmap Scripting Engine (NSE), предназначенного для обеспечения автоматизации различных действий с Nmap. Модульная структура NSE позволяет автоматизировать решение широкого спектра сетевых задач, от формирования запросов для получения информации о конфигурации сетевых приложений, до выявления наличия определённых уязвимостей и реализации расширенных техник обнаружения хостов. По сравнению с Nmap 5.0 число поставляемых NSE-скриптов увеличено с 59 до 348, а число NSE-библиотек - с 20 до 96. Добавлены скрипты для сбора информации с поддержкой 44 новых протоколов. Реализованы две новые фазы сканирования - выполнение действий перед началом сканирования и после завершения сканирования. Добавлена библиотека для проверки параметров аутентификации и 48 скриптов для перебора паролей, поддерживающих как распространённые протоколы (HTTP, FTP, MySQL, telnet, socks, pop3), так и редкие (VMauthd, RPcap, Redis, iSCSI). Для ускорения перебора паролей задействована база из 5000 наиболее популярных паролей. Создана новая категория скриптов для работы с широковещательным трафиком (broadcast). Возможности расширенного сканирования Web-сервисов, позволяющие в процессе проверки определить параметры web-сервера, особенности поддержки HTTP, информацию об SSL-сертификатах и данные о применяемых техниках кэширования. Добавлена возможность указания вместо IP или имени хоста URL-адреса для проведения проверки. Для автоматизации сканирования сайтов добавлено 48 новых NSE-скриптов, например, скрипт http-grep позволяет перебрать страницы на сайте и найти элементы удовлетворяющие заданной маске; Полная поддержка IPv6, в том числе возможность определения типа ОС по особенностям реализации стека IPv6, поддержка сканирования IPv6-портов raw-пакетами и множество NSE-скриптов с поддержкой связанных с IPv6 протоколов; В состав включена утилита nping, предназначенная для генерации произвольных пакетов для различных сетевых протоколов, анализа приходящих ответов и оценки времени прихода ответа. Nping поддерживает генерацию пакетов для широкого спектра протоколов, позволяя при этом полностью контролировать содержимое заголовков пакетов. Nping также может использоваться как продвинутая замена утилите ping, как инсрумент для трассировки маршрутов, или как средство для стресс-тестирования сети, поддерживающее такие функции как наводнение ARP-запросами. Утилита также позволяет отследить изменения, вносимые в пакет при передаче между источником и хостом назначения, что можно использовать для анализа поведения межсетевых экранов или для выявления повреждения содержимого пакетов; Расширение возможностей GUI-интерфейса Zenmap. Добавлена возможность фильтрации хостов, позволяющая просмотреть только результаты, удовлетворяющие определённому критерию (используемая ОС, тип web-сервера и т.п.). Добавлена поддержка локализации интерфейса, в том числе представлен комплект переводов и для русского языка. Реализован новый интерфейс для выбора и поиска NSE-скриптов, с возможностью их непосредственного запуска; Проведена оптимизация скорости сканирования как единичных систем, так и больших сетей, включающих миллионы хостов. Полностью переписан код подсистемы трассировки маршрутов, которая теперь поддерживает распараллеливание операций при выполнении скриптов и определении версий. Кроме того, проведён тщательный аудит потребления памяти, который позволил снизить расход памяти в пиковые моменты c 34 до 6 Мб при сканировании UDP и с 67 до 3 Мб при определении типа ОС. Переработаны некоторые структуры данных и алгоритмы, используемые в интерфейсе Zenmap, что позволило значительно ускорить сканирование больших сетей. Например, время сканирования более миллиона IP компании Microsoft сокращено с нескольких часов до двух минут.