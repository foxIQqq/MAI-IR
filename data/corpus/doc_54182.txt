Уязвимости в IPv6-стеке FreeBSD

В IPv6-стеке FreeBSD выявлено несколько удалённо эксплуатируемых уязвимостей (проблемы устранены в обновлениях 12.2-RELEASE-p1, 12.1-RELEASE-p11 и 11.4-RELEASE-p5): CVE-2020-7469 - обращение к освобождённому блоку памяти (use-after-free) при обработке ICMP6-пакета с сообщением об ошибке. Уязвимость может быть использована для инициирования удалённого краха ядра через отправку специально оформленного IPv6-пакета. CVE-2020-25577 - две уязвимости в фоновом процессе rtsold, применяемом для обеспечения работы механизма автонастройки адресов IPv6 (SLAAC). Проблемы вызваны некорректной проверкой границ буфера и размера поля при обработке пакетов с параметрами RDNSS (Recursive DNS Servers) и DNSSL (DNS Search List). Размер имени домена в поле DNSSL указывается перед данными и rtsold слепо доверял данной информации не проверяя фактический размер, что могло использоваться для записи произвольной информации за пределы буфера. Уязвимости позволяют организовать удалённое выполнение кода с правами root при отправке специально оформленного пакета. Опасность проблемы смягчает то, что rtsold обрабатывает только сообщения, полученных от хостов, подключённых через тот же физический линк. Во FreeBSD 12.2 вред от проблемы дополнительно минимизируется изоляцией rtsold при помощи механизма Capsicum.