Уязвимость в реализации автодополнения ввода в Bash

В командном интерпретаторе Bash выявлена уязвимость (CVE-2017-5932), которая может быть использована для выполнения своего кода при выполнении операций автодополнения ввода клавишей табуляция. Проблема затрагивает ветку Bash 4.4. Исправление пока доступно только в виде патча. Проблема вызвана ошибкой в коде экранирования и связана с неверной обработкой двойных кавычек (в функцию expand_word_internal передаётся строка без экранирования блока запуска, что приводит к обработке подстановки для блоков "``" или "$()"). Для эксплуатации достаточно создать файл со специально оформленным именем. При попытке выполнения операции автодополнения для данного файла будут выполнены определённые злоумышленником инструкции командного интерпретатора. Например, для эксплуатации достаточно создать файл и добиться его обработки в строке ввода при нажатии табуляции: $ touch '"`touch HereBeDragons`' $ ls -lt -rw-rw-r-- 1 test test 40831 февр. 8 11:46 '"`touch HereBeDragons`' $ rm \"\`touch\ HereBeDragons\` (прерываем ввод по ^C) $ ls HereBeDragons '"`touch HereBeDragons`'