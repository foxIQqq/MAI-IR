Ещё одна уязвимость в подсистеме ядра Linux Netfilter

В подсистеме ядра Netfilter выявлена уязвимость (CVE-2022-1972), похожая на проблему раскрытую в конце мая. Новая уязвимость также позволяет локальному пользователю получить права root в системе через манипуляции с правилами в nftables и требует для проведения атаки доступа к nftables, который можно получить в отдельном пространстве имён (network namespace или user namespace) при наличии прав CLONE_NEWUSER, CLONE_NEWNS или CLONE_NEWNET (например, при возможности запуска изолированного контейнера). Проблема вызвана ошибкой в коде для обработки set-списков с полями, включающими несколько диапазонов, и приводит к записи за пределы выделенной области памяти при обработке специально оформленных параметров списка. Исследователям удалось подготовить рабочий эксплоит для получения прав root в Ubuntu 21.10 c ядром 5.13.0-39-generic. Уязвимость проявляется начиная с ядра 5.6. Исправление предложено в виде патча. Для блокирования эксплуатации уязвимости в обычных системах следует убедиться в отключении возможности создания пространств имён непривилегированными пользователями ("sudo sysctl -w kernel.unprivileged_userns_clone=0"). Кроме того, опубликованы сведения о трёх уязвимостях в ядре, связанных с подсистемой NFC. Уязвимости позволяют вызвать аварийное завершение работы через выполнение действий непривилегированным пользователем (более опасные векторы атаки пока не продемонстрированы): CVE-2022-1734 - обращение к уже освобождённой памяти (use-after-free) в драйвере nfcmrvl (drivers/nfc/nfcmrvl), проявляющееся при симуляции устройства NFC в пространстве пользователя. CVE-2022-1974 - обращение к уже освобождённой памяти в netlink-функциях для устройств NFC (/net/nfc/core.c), проявляющееся при регистрации нового устройства. Как и прошлая уязвимость проблема может быть эксплуатирована через симуляцию устройства NFC в пространстве пользователя. CVE-2022-1975 - ошибка в коде загрузки прошивок для устройств NFC, которую можно использовать для вызова состояния "panic".