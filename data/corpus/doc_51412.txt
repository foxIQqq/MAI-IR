Обновление Samba 4.10.8 и 4.9.13 с устранением уязвимости

Подготовлены корректирующие выпуски пакета Samba 4.10.8 и 4.9.13, в которых устранена уязвимость (CVE-2019-10197), позволяющая пользователю получить доступ к корневому каталогу, в котором размещён сетевой раздел Samba. Проблема проявляется при указании в настройках опции 'wide links = yes' в сочетании с 'unix extensions = no' или 'allow insecure wide links = yes'. Доступ к файлам вне текущего совместного раздела ограничен правами доступа пользователя, т.е. атакующий может прочитать и записать файлы в соответствии со своим uid/gid. Проблема вызвана тем, что после первого запроса корня совместного раздела клиенту возвращается ошибка доступа, но smbd кэширует обращение к каталогу и не очищает кэш в случае проблемы с доступом. Соответственно, после отправки повторного SMB-запроса, он успешно обрабатывается на основе записи в кэше без повторных проверок полномочий.