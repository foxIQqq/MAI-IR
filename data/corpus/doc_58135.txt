Уязвимость в Samba и MIT/Heimdal Kerberos, приводящая к переполнению буфера

Опубликованы корректирующие выпуски пакета Samba 4.17.3, 4.16.7 и 4.15.12 с устранением уязвимости (CVE-2022-42898) в библиотеках Kerberos, приводящей к целочисленному переполнению и записи данных за пределы выделенного буфера при обработке параметров PAC (Privileged Attribute Certificate), отправленных аутентифицированным пользователем. Публикацию обновлений пакетов в дистрибутивах можно проследить на страницах: Debian, Ubuntu, Gentoo, RHEL, SUSE, Arch, FreeBSD. Кроме Samba проблема также проявляется в пакетах с MIT Kerberos и Heimdal Kerberos. В отчёте об уязвимости от проекта Samba угроза не детализируется, но в отчёте MIT Kerberos указано, что уязвимость может привести к удалённому выполнению кода. Эксплуатация уязвимости возможна только на 32-разрядных системах. Проблема затрагивает конфигурации с KDC (Key Distribution Center) или kadmind. В конфигурациях без Active Directory уязвимость также проявляется на файловых серверах Samba, использующих Kerberos. Проблема вызвана ошибкой в функции krb5_parse_pac(), из-за которой неверно рассчитывался размер буфера, используемого при разборе полей PAC. На 32-разрядных системах при обработке специально оформленных PAC ошибка могла привести к размещению переданного атакующим 16-байтового блока за пределами выделенного буфера.