Уязвимость в ftpd из FreeBSD, позволявшая получить root-доступ при использовании ftpchroot

В поставляемом в составе FreeBSD сервере ftpd выявлена критическая уязвимость (CVE-2020-7468), дающая возможность пользователям, ограниченным своим домашним каталогом при помощи опции ftpchroot, получить полный root-доступ к системе. Проблема вызвана сочетанием ошибки в реализации механизма изоляции пользователя при помощи вызова chroot (при сбоях в процессе смены uid или выполнения chroot и chdir выдавалась нефатальная ошибка, не обрывающая сеанс) и предоставлением аутентифицированному пользователю FTP прав, достаточных для обхода ограничения корневого пути в файловой системе. Уязвимость не проявляется при доступе к FTP-серверу в анонимном режиме или при полноценном входе пользователя без ftpchroot. Проблема устранена в обновлениях 12.1-RELEASE-p10, 11.4-RELEASE-p4 и 11.3-RELEASE-p14. Дополнительно можно отметить устранение в 12.1-RELEASE-p10, 11.4-RELEASE-p4 и 11.3-RELEASE-p14 ещё трёх уязвимостей: CVE-2020-7467 - уязвимость в гипервизоре Bhyve, позволяющая из гостевого окружения записать информацию в области памяти хост-окружения и получить полный доступ к хост-системе. Проблема вызвана отсутствием ограничения доступа к процессорным инструкциям, работающим с физическими адресами хоста, и проявляется только на системах с CPU AMD. CVE-2020-24718 - уязвимость в гипервизоре Bhyve, позволяющая атакующему с правами root внутри изолированных при помощи Bhyve окружений выполнить код на уровне ядра. Проблема вызвана отсутствием должного ограничения доступа к структурам VMCS (Virtual Machine Control Structure) на системах с CPU Intel и VMCB (Virtual Machine Control Block) на системах с CPU AMD. CVE-2020-7464 - уязвимость в драйвере ure (USB Ethernet Realtek RTL8152 и RTL8153), позволяющая через отправку больших кадров (больше 2048) выполнить спуфинг пакетов с других хостов или осуществить подстановку пакетов в другие VLAN.