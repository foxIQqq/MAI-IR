Атака на OpenSSH sftp, осуществляемая при некорректной настройке chroot

В реализации sftp из состава OpenSSH выявлена недоработка, которая при редком стечении настроек может привести к выполнению кода в режиме chroot. Суть проблемы в том, что при использовании internal-sftp и chroot, OpenSSH всё равно предпринимает попытку запуска скрипта /etc/ssh/sshrc. Проявление проблемы маловероятно в реальных условиях, так как для этого необходимо достаточно специфичное сочетание некорректных настроек. Например, так как OpenSSH блокирует работу в случае доступности корня chroot-окружения на запись, для успешной атаки требуется наличие доступных на запись каталогов bin, etc, lib. Атакующий может скопировать необходимые файлы и библиотеки в эти каталоги и запустить код внутри chroot (будет ограничен доступ к ФС, но можно использовать код для эксплуатации неисправленных уязвимостей в ядре, рассылки спама, участия в DDoS, создания прокси и т.п.).