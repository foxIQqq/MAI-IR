Уязвимости в процессорах AMD и Intel

Компания AMD сообщила об устранении 22 уязвимостей в первом, втором и третьем поколениях серверных процессоров AMD серии EPYC, позволяющих скомпрометировать работу технологий PSP (Platform Security Processor), SMU (System Management Unit) и SEV (Secure Encrypted Virtualization). 6 проблем были выявлены в 2020 году, а 16 в 2021 году. 11 уязвимостей в ходе проведения внутренних исследований безопасности выявили сотрудники компании Google, 6 - компании Oracle и 5 - компании Microsoft. Для OEM-производителей оборудования выпущены обновлённые наборы прошивок AGESA (AMD Generic Encapsulated Software Architecture), обходным путём блокирующие проявление проблем. Обновления BIOS и UEFI-прошивок для своих серверных систем уже выпустили такие компании, как Hewlett Packard Enterprise, Dell, Supermicro и Lenovo. 4 уязвимости отнесены к категории опасных (детали пока не раскрываются): CVE-2020-12954 - возможность обхода механизмов защиты SPI ROM через манипуляции с определёнными внутренними настройками чипсета. Уязвимость позволяет атакующему внести изменения в SPI Flash для внедрения невидимого для системы вредоносного кода или руткитов. СVE-2020-12961 - уязвимость в процессоре PSP (AMD Security Processor), применяемом для выполнения недоступного из основной ОС защищённого изолированного окружения, позволяет атакующему обнулить любой привилегированный регистр процессора в SMN (System Management Network) и обойти защиту SPI ROM. CVE-2021-26331 - ошибка в интегрированной в процессор подсистеме SMU (System Management Unit), применяемой для управления энергопотреблением, напряжением и температурой, позволяет непривилегированному пользователю добиться выполнения своего кода с повышенными привилегиями. CVE-2021-26335 - некорректная проверка входных данных в загрузчике кода для PSP-процессора даёт возможность применить контролируемые атакующим значения на стадии до проверки цифровой подписи и добиться выполнения своего кода в PSP. Отдельно отмечается устранение уязвимости (CVE-2021-26334) в инструментарии AMD μProf, поставляемом в том числе для Linux и FreeBSD, и используемом для анализа производительности и энергопотребления. Проблема присутствует в драйвере AMDPowerProfiler и позволяет непривилегированному пользователю добиться доступа к регистрам MSR (Model-Specific Register) для организации выполнения своего кода на уровне нулевого кольца защиты (ring-0). Уязвимость устранена в обновлении amduprof-3.4-502 для Linux и AMDuProf-3.4.494 для Windows. Тем временем компания Intel опубликовала ежеквартальные отчёты об уязвимостях в своих продуктах, из которых выделяются следующие проблемы: CVE-2021-0146 - уязвимость в процессорах Intel Pentium, Celeron и Atom на базе микроархитектур Apollo Lake, Gemini Lake и Gemini Lake, поставляемых для мобильных и десктоп-систем. Проблема позволяет пользователю с физическим доступом к оборудованию добиться повышения привилегий через активацию отладочных режимов, применяемых при разработке прошивок. С практической стороны уязвимость может быть применена для внесения изменений в прошивку, установки скрытых бэкдоров, работающих на уровне прошивки IME (Intel Management Engine), обхода механизмов защиты операционной системы или извлечения ключей шифрования из анклавов TPM (например, упоминается возможность извлечения ключей Bitlocker для доступа к данным на зашифрованном диске или извлечение корневых ключей Intel PTT (Platform Trust Technology) и Intel EPID (Enhanced Privacy ID), применяемых в системах защиты от несанкционированного копирования контента). CVE-2021-0157, CVE-2021-0158 - уязвимости в эталонном коде BIOS, поставляемом для инициализации процессоров Intel Xeon (E/W/Scalable), Core (7/10/11gen), Celeron (N) и Pentium Silver. Проблемы вызваны некорректной проверкой ввода или неверным управлением потоком в прошивке BIOS и позволяют повысить привилегии при наличии локального доступа.