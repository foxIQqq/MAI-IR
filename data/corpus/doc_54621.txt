В Brave выявлена утечка через DNS сведений об открываемых в Tor-режиме onion-сайтах

В web-браузере Brave выявлена утечка через DNS данных об onion-сайтах, отрываемых в режиме приватного просмотра, в котором трафик перенаправляется через сеть Tor. Решающие проблему исправления уже приняты в кодовую базу Brave и в ближайшее время войдут в состав очередного стабильного обновления. Причиной утечки стал блокировщик рекламы, который предложено отключить при работе через Tor. Последнее время рекламными сетями для обхода блокировщиков рекламы применяется загрузка рекламных блоков с использованием родного для сайта поддомена, для чего на обслуживающем сайт DNS-сервере создаётся CNAME-запись, указывающая на хост рекламной сети. Таким образом, рекламный код формально загружается с того же первичного домена, что и сайт, и поэтому не подвергается блокировке. Для выявления подобных манипуляций и определения связанного через CNAME хоста блокировщики рекламы выполняют дополнительный резолвинг имени в DNS. В Brave обычные DNS-запросы при открытии сайта в приватном режиме проходили через сеть Tor, но блокировщик рекламы выполнял резолвинг CNAME через основной DNS-сервер, что приводило к утечке информации об открываемых onion-сайтах на DNS-сервер провайдера. Примечательно, что в Brave режим приватного просмотра на базе Tor не позиционируется как гарантирующий анонимность и пользователей в документации предупреждают, что он не заменяет Tor Browser, а лишь использует Tor как прокси. Дополнение: Опубликовано обновление Brave 1.20.108 с устранением проблемы.