При портировании во FreeBSD утилиты doas, аналога sudo от OpenBSD, возникла опасная уязвимость

В дерево портов FreeBSD добавлена утилита doas, представляющая собой упрощённый аналог программы sudo, позволяющий выполнять команды от имени другого пользователя. Утилита развивается в недрах проекта OpenBSD в ответ на усложнение современных выпусков sudo, которые не отвечают требованиям OpenBSD по безопасности и зависимостям. Портирование не обошлось без казуса - спустя несколько часов после публикации, в варианте утилиты doas для FreeBSD была обнаружена критическая уязвимость, позволяющая выполнить привилегированные операции, даже если был указан неверный пароль пользователя. Т.е. любой пользователь, указанный в секции "permit" в файле doas.conf может выполнить любые допустимые команды, указав любые символы в ответ на запрос пароля. Проблема была внесена разработчиком порта при добавлении поддержки PAM и вызвана ошибкой в коде обработки отрицательного результата проверки пароля через PAM (при ошибке программа не завершала свою работу).