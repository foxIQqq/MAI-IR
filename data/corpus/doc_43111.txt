Релиз systemd 227

Леннарт Поттеринг (Lennart Poettering) представил выпуск системного менеджера systemd 227. Основные изменения: В число зависимостей добавлен пакет util-linux 2.27, реализация libmount в котором используется для отслеживания точек монтирования вместо аналогичной ранее используемой встроенной функциональности systemd; В связи с переходом на libmount /etc/mtab теперь является симлинком на /proc/self/mounts и недоступен для изменения; Добавлен новый cgroup-контроллер ресурсов "pids", позволяющий применить ограничения к группе процессов. Настройка осуществляется при помощи глобальной директивы "DefaultTasksAccounting=" и специфичных для unit-файлов директив "TasksAccounting=" и "TasksMax="; Добавлен новый cgroup-контроллер "net_cls", позволяющий привязать к каждой задаче идентификатор сетевого класса, используемый в правилах пакетного фильтра или для урезания трафика. Привязка осуществляется через директиву "NetClass=" в unit-файлах; Директория /sys теперь монтируется в контейнерах как раздел tmpfs, в который примонтированы отдельные части реальной sysfs, что ограничивает доступность служебных данных с целью повышения безопасности; Добавлен метод активации USB FunctionFS, позволяющий создавать связанные с USB-устройствами сервисы, активируемые в момент обращения по аналогии с активацией по сокету; Во всех сервисных файлах таймаут watchdog-проверки увеличен до 3 минут, что поможет обойти проблемы при значительных задержках дискового ввода/вывода; Вместо отдельной утилиты 'machine-id-commit' теперь следует использовать команду 'machine-id-setup --commit'; В директиве "WorkingDirectory=" теперь можно указывать символ '~', что приведёт к использованию пути к домашней директории пользователя, указанного в директиве "User="; При выполнении "machinectl shell" командный интерпретатор теперь открывается в домашней директории текущего пользователя; Во временных юнитах (transient) теперь допустимо использование свойств "PrivateTmp=", "PrivateDevices=", "PrivateNetwork=", "NoNewPrivileges=", "TTYPath=", "WorkingDirectory=" и "RootDirectory="; В systemd-cgtop добавлена опция -M/--machine= для показа элементов cgroup, выставленных для указанного контейнера; В systemd-networkd представлены новые опции "IPv6AcceptRouterAdvertisements=" (анонс IPv6 маршрутизатора) и "PreferredSource=" (выбор статичного маршрута) для файлов .network, а также "HelloTimeSec=", "MaxAgeSec=" и "ForwardDelaySec=" для сетевых мостов, определённых в файлах .netdev; В фреймворк "ask-password", используемый для запроса пароля для расшифровки LUKS-диска и SSL, добавлена поддержка кэширования пароля в хранилище паролей на стороне ядра (kernel keyring). При загрузке tar-архивов или raw-образов при помощи команд "machinectl pull-tar" или "machinectl pull-raw", вместе с образами теперь загружаются ".nspawn" файлы с тем же именем; В systemd-journal добавлена поддержка упаковки старых файлов с журналами при накоплении значительного числа лог-файлов. По умолчанию упаковка запускается при накоплении 100 файлов. Изменить настройки можно через директивы "SystemMaxFiles=" и "RuntimeMaxFiles=" в journald.conf. Для выборочной упаковки можно использовать опцию "--vacuum-files" в утилите "journalctl".